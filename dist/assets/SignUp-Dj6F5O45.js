import{r as e,u as a,j as r,U as s,aY as t,aZ as l,m as i,l as n,a_ as o,aS as d,aP as c,i as m,T as u}from"./vendor-CNKhjeNv.js";import{c as x,a as h,d as b,e as g,b as f,f as p,V as j}from"./formValidation-DPNGFdr7.js";import{u as w,l as y}from"./index-nCNqRPE8.js";const v=({formData:e,errors:a,touched:i,loading:n,onFieldChange:o,onFieldBlur:d,onSubmit:c})=>r.jsxs("form",{onSubmit:c,className:"space-y-6",children:[r.jsx(j,{name:"fullName",type:"text",placeholder:"Full Name",value:e.fullName,onChange:o,onBlur:d,error:a.fullName,touched:i.fullName,icon:s,disabled:n,autoComplete:"name",required:!0}),r.jsx(j,{name:"email",type:"email",placeholder:"Email Address",value:e.email,onChange:o,onBlur:d,error:a.email,touched:i.email,icon:t,disabled:n,autoComplete:"email",required:!0}),r.jsx(j,{name:"password",type:"password",placeholder:"Password",value:e.password,onChange:o,onBlur:d,error:a.password,touched:i.password,icon:l,disabled:n,autoComplete:"new-password",required:!0}),r.jsx(j,{name:"confirmPassword",type:"password",placeholder:"Confirm Password",value:e.confirmPassword,onChange:o,onBlur:d,error:a.confirmPassword,touched:i.confirmPassword,icon:l,disabled:n,autoComplete:"new-password",required:!0}),r.jsx("button",{type:"submit",disabled:n,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-semibold py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2",children:n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),r.jsx("span",{children:"Creating Account..."})]}):r.jsx("span",{children:"Create Account"})})]}),N=({email:e,onContinue:a})=>r.jsxs(i.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"text-center space-y-6",children:[r.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center",children:r.jsx(n,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Account Created Successfully!"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Welcome to USMLE Trivia! Your account has been created."})]}),r.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(t,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0"}),r.jsxs("div",{className:"text-left",children:[r.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:"Check your email"}),r.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:["We've sent a confirmation email to ",r.jsx("strong",{children:e})]})]})]})}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("button",{onClick:a,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2",children:[r.jsx("span",{children:"Continue to Dashboard"}),r.jsx(o,{className:"w-4 h-4"})]}),r.jsx(d,{to:"/login",className:"block w-full text-center text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium py-2 transition-colors duration-200",children:"Sign in instead"})]}),r.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 space-y-1",children:[r.jsx("p",{children:"Didn't receive the email? Check your spam folder."}),r.jsx("p",{children:"You can still access your account without email confirmation."})]})]}),k=()=>{const{formData:s,errors:t,touched:l,loading:n,submitError:o,success:j,handleChange:k,handleBlur:C,handleSubmit:P,handleContinue:S}=(()=>{const[r,s]=e.useState({fullName:"",email:"",password:"",confirmPassword:""}),[t,l]=e.useState({}),[i,n]=e.useState({}),[o,d]=e.useState(!1),[c,m]=e.useState(""),[u,j]=e.useState(!1),{isConfigured:v}=w(),N=a(),k=x({fullName:e=>p(e),email:e=>f(e),password:e=>g(e),confirmPassword:e=>b(r.password,e)});return{formData:r,errors:t,touched:i,loading:o,submitError:c,success:u,handleChange:(e,a)=>{if(s(r=>({...r,[e]:a})),m(""),i[e]||a){const s=k.validateField(e,a,{...r,[e]:a});l(a=>({...a,[e]:s.error}))}},handleBlur:e=>{n(a=>({...a,[e]:!0}));const a=k.validateField(e,r[e],r);l(r=>({...r,[e]:a.error}))},handleSubmit:async e=>{e.preventDefault(),d(!0),m("");try{const e=k.validateForm(r);if(!e.isValid)throw l(e.errors),n({fullName:!0,email:!0,password:!0,confirmPassword:!0}),new Error("Please fix the errors above");if(!v)throw new Error("Authentication service is not configured. Please check your environment variables.");y.info("Attempting user registration",{email:r.email});const{user:a,error:s}=await h.signUp({email:r.email,password:r.password,fullName:r.fullName});if(s)throw s;if(!a)throw new Error("Registration failed - no user returned");y.info("User registration successful",{userId:a.id,email:a.email}),j(!0)}catch(a){y.error("Registration failed",a),a.message?.includes("already registered")?m("An account with this email already exists. Please sign in instead."):a.message?.includes("Invalid email")?m("Please enter a valid email address."):a.message?.includes("Password")?m("Password does not meet requirements."):a.message?.includes("network")||a.message?.includes("fetch")?m("Network error. Please check your connection and try again."):m(a.message||"Registration failed. Please try again.")}finally{d(!1)}},handleContinue:()=>{N("/")},isFormValid:k.validateForm(r).isValid}})();return j?r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-100 dark:from-gray-900 dark:via-blue-900/20 dark:to-indigo-900/20 flex items-center justify-center p-4",children:r.jsx("div",{className:"w-full max-w-md bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8",children:r.jsx(N,{email:s.email,onContinue:S})})}):r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-100 dark:from-gray-900 dark:via-blue-900/20 dark:to-indigo-900/20 flex items-center justify-center p-4",children:r.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsxs(d,{to:"/login",className:"inline-flex items-center text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 mb-4 transition-colors duration-200",children:[r.jsx(c,{className:"w-4 h-4 mr-2"}),"Back to Sign In"]}),r.jsx("div",{className:"flex items-center justify-center mb-4",children:r.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/20 p-3 rounded-full",children:r.jsx(m,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})})}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Create Your Account"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Join thousands of medical students preparing for the USMLE"})]}),o&&r.jsxs(i.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg flex items-start space-x-3",children:[r.jsx(u,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Registration Failed"}),r.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:o})]})]}),r.jsx(v,{formData:s,errors:t,touched:l,loading:n,onFieldChange:k,onFieldBlur:C,onSubmit:P}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Already have an account?"," ",r.jsx(d,{to:"/login",className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium transition-colors duration-200",children:"Sign in here"})]})}),r.jsx("div",{className:"mt-4 text-center",children:r.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["By creating an account, you agree to our"," ",r.jsx(d,{to:"/terms",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Terms of Service"})," ","and"," ",r.jsx(d,{to:"/privacy",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Privacy Policy"})]})})]})})};export{k as default};
