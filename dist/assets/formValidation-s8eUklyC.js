import{s as e}from"./index-D5Tt7n0c.js";import{r,j as s,b0 as a,a1 as t,A as i,m as o,C as n,o as l}from"./vendor-0A5iGyAR.js";class d extends Error{constructor(e){super(e),this.name="AuthError"}}const c={signUp:async r=>{const{email:s,password:a,fullName:t}="object"==typeof r?r:{email:arguments[0],password:arguments[1],fullName:arguments[2]},{data:i,error:o}=await e.auth.signUp({email:s,password:a,options:{data:{full_name:t,display_name:t,name:t}}});if(o)throw new d(o.message);if(i.user&&i.user.identities&&0===i.user.identities.length)throw new d("This email is already in use. Please try another email.");return i},signIn:async(r,s)=>{const{data:a,error:t}=await e.auth.signInWithPassword({email:r,password:s});if(t)throw new d(t.message);return a},signOut:async()=>{const{error:r}=await e.auth.signOut();if(r)throw new d(r.message)},resetPassword:async r=>{const{error:s}=await e.auth.resetPasswordForEmail(r,{redirectTo:`${window.location.origin}/reset-password`});if(s)throw new d(s.message)},updateProfile:async r=>{const{data:{user:s}}=await e.auth.getUser();if(!s)throw new d("User not authenticated");const{data:a,error:t}=await e.from("profiles").update(r).eq("id",s.id).select().single();if(t)throw new d(t.message);return a}},u=({type:e="text",name:d,value:c,onChange:u,onBlur:h,placeholder:m,label:g,icon:x,error:p,isValid:w,required:b=!1,disabled:f=!1,className:y="",showPasswordToggle:j=!1,autoComplete:v,...N})=>{const[V,k]=r.useState(!1),[P,$]=r.useState(!1),C=c&&c.toString().trim().length>0,q=C||p,A="password"===e&&P?"text":e;return s.jsxs("div",{className:"space-y-2",children:[g&&s.jsxs("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[g,b&&s.jsx("span",{className:"text-red-500 ml-1","aria-label":"required",children:"*"})]}),s.jsxs("div",{className:"relative",children:[x&&s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(x,{className:"w-5 h-5 text-gray-400"})}),s.jsx("input",{type:A,name:d,id:d,value:c,onChange:e=>u(d,e.target.value),onBlur:()=>{k(!1),h&&h(d)},onFocus:()=>k(!0),placeholder:m,disabled:f,autoComplete:v,className:(()=>{let e=`\n      w-full px-4 py-3 rounded-xl border transition-all duration-200\n      focus:outline-none focus:ring-2 focus:ring-offset-2\n      dark:bg-gray-800 dark:border-gray-600\n      ${x?"pl-12":""}\n      ${j||q?"pr-12":""}\n      ${y}\n    `;return e+=p?" border-red-300 focus:border-red-500 focus:ring-red-500 bg-red-50 dark:bg-red-900/20":w&&C?" border-green-300 focus:border-green-500 focus:ring-green-500 bg-green-50 dark:bg-green-900/20":V?" border-blue-300 focus:border-blue-500 focus:ring-blue-500 bg-blue-50 dark:bg-blue-900/20":" border-gray-300 focus:border-blue-500 focus:ring-blue-500 bg-white",f&&(e+=" opacity-50 cursor-not-allowed"),e})(),"aria-invalid":p?"true":"false","aria-describedby":p?`${d}-error`:void 0,"aria-required":b,...N}),s.jsxs("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center space-x-2",children:["password"===e&&j&&s.jsx("button",{type:"button",onClick:()=>$(!P),className:"text-gray-400 hover:text-gray-600 focus:outline-none",tabIndex:-1,children:P?s.jsx(a,{className:"w-5 h-5"}):s.jsx(t,{className:"w-5 h-5"})}),q?p?s.jsx(n,{className:"w-5 h-5 text-red-500"}):w&&C?s.jsx(l,{className:"w-5 h-5 text-green-500"}):null:null]})]}),s.jsx(i,{children:p&&s.jsxs(o.div,{id:`${d}-error`,role:"alert","aria-live":"polite",initial:{opacity:0,y:-10,height:0},animate:{opacity:1,y:0,height:"auto"},exit:{opacity:0,y:-10,height:0},transition:{duration:.2},className:"text-sm text-red-600 dark:text-red-400 flex items-center space-x-1",children:[s.jsx(n,{className:"w-4 h-4 flex-shrink-0","aria-hidden":"true"}),s.jsx("span",{children:p})]})}),s.jsx(i,{children:w&&C&&!p&&s.jsxs(o.div,{initial:{opacity:0,y:-10,height:0},animate:{opacity:1,y:0,height:"auto"},exit:{opacity:0,y:-10,height:0},transition:{duration:.2},className:"text-sm text-green-600 dark:text-green-400 flex items-center space-x-1",children:[s.jsx(l,{className:"w-4 h-4 flex-shrink-0"}),s.jsx("span",{children:"Looks good!"})]})})]})},h=e=>e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?{isValid:!0,error:""}:{isValid:!1,error:"Please enter a valid email address"}:{isValid:!1,error:""},m=e=>{if(!e)return{isValid:!1,error:""};if(e.length<6)return{isValid:!1,error:"Password must be at least 6 characters"};const r=/[a-zA-Z]/.test(e),s=/\d/.test(e);return r&&s?{isValid:!0,error:"",level:"strong"}:{isValid:!1,error:"Password should contain both letters and numbers",level:"weak"}},g=(e,r)=>r?e!==r?{isValid:!1,error:"Passwords do not match"}:{isValid:!0,error:""}:{isValid:!1,error:""},x=e=>{if(!e)return{isValid:!1,error:""};const r=e.trim();return r.length<2?{isValid:!1,error:"Name must be at least 2 characters"}:/^[a-zA-Z\s'-]+$/.test(r)?{isValid:!0,error:""}:{isValid:!1,error:"Name can only contain letters, spaces, hyphens, and apostrophes"}},p=(e,r)=>e&&e.toString().trim()?{isValid:!0,error:""}:{isValid:!1,error:`${r} is required`},w=e=>({validateField:(r,s,a={})=>e[r]?e[r](s,a):{isValid:!0,error:""},validateAll:r=>{const s={};let a=!0;return Object.keys(e).forEach(t=>{const i=e[t](r[t],r);i.isValid||(s[t]=i.error,a=!1)}),{isValid:a,errors:s}}});export{u as V,c as a,h as b,w as c,g as d,m as e,x as f,p as v};
