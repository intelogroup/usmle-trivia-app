import{aq as e,ar as t,aE as s,j as r,o as a,q as n,al as i,m as o,aL as l,aQ as c,r as d,aK as x,aR as u,d as g,aN as m,aJ as h,aS as p,u as y,aG as b,aT as f,am as j,H as N}from"./vendor-ChsRwzkX.js";import{s as w,q as v}from"./index-CwYISt8q.js";import{Q as k}from"./questionService-DCaLMc6P.js";class _{static async fetchQuestions(e,t=10,s=null){try{let r=w.from("questions");r="mixed"!==e?r.select("\n            id,\n            question_text,\n            options,\n            correct_option_id,\n            explanation,\n            difficulty,\n            created_at,\n            question_tags!inner(\n              tag_id,\n              tags(name)\n            )\n          ").eq("question_tags.tag_id",e):r.select("\n            id,\n            question_text,\n            options,\n            correct_option_id,\n            explanation,\n            difficulty,\n            created_at,\n            question_tags(\n              tag_id,\n              tags(name)\n            )\n          "),s&&(r=r.eq("difficulty",s));const{data:a,error:n}=await r.limit(2*t);if(n)throw console.error("Supabase error fetching questions:",n),n;if(!a||0===a.length)throw new Error("No questions found for this category");return a.sort(()=>Math.random()-.5).slice(0,t)}catch(r){throw console.error("Error fetching questions:",r),r}}static async recordQuizResponsesBatch(e){try{const{error:t}=await w.from("quiz_responses").insert(e);if(t)throw console.error("Error recording quiz responses batch:",t),t}catch(t){throw console.error("Error recording quiz responses batch:",t),t}}static async updateUserQuestionHistoryBatch(e){try{const{error:t}=await w.from("user_question_history").upsert(e,{onConflict:"user_id,question_id"});if(t)throw console.error("Error updating user question history batch:",t),t}catch(t){throw console.error("Error updating user question history batch:",t),t}}static async fetchCategories(){try{const{data:e,error:t}=await w.from("tag_question_counts").select("\n          id,\n          name,\n          icon_name,\n          color_code,\n          question_count\n        ").eq("is_active",!0).order("order_index",{ascending:!0}).limit(50);if(t)throw console.error("Error fetching categories:",t),t;return e||[]}catch(e){throw console.error("Error fetching categories:",e),e}}static async prefetchCategoriesQuestions(e,t=15){try{const s=e.map(e=>this.fetchQuestions(e,t));return(await Promise.allSettled(s)).reduce((t,s,r)=>("fulfilled"===s.status&&(t[e[r]]=s.value),t),{})}catch(s){return console.error("Error prefetching category questions:",s),{}}}static async getUserStats(e){try{const{data:t,error:s}=await w.rpc("get_user_quiz_stats",{user_id:e});if(s)throw console.error("Error fetching user stats:",s),s;return t?.[0]||{total_questions:0,correct_answers:0,accuracy:0,quizzes_completed:0}}catch(t){throw console.error("Error fetching user stats:",t),t}}static async getLeaderboard(e=10){try{const{data:t,error:s}=await w.rpc("get_leaderboard",{result_limit:e});if(s)throw console.error("Error fetching leaderboard:",s),s;return t||[]}catch(t){throw console.error("Error fetching leaderboard:",t),t}}static async healthCheck(){try{const{data:e,error:t}=await w.from("questions").select("id").limit(1);return!t}catch(e){return console.error("Health check failed:",e),!1}}}const q="usmle_quiz_cache_",S=(e,t)=>{try{const s={data:t,timestamp:Date.now(),expiry:Date.now()+864e5};localStorage.setItem(q+e,JSON.stringify(s))}catch(s){console.warn("Failed to cache data locally:",s)}},Q=e=>{try{const t=localStorage.getItem(q+e);if(!t)return null;const s=JSON.parse(t);return Date.now()>s.expiry?(localStorage.removeItem(q+e),null):s.data}catch(t){return console.warn("Failed to retrieve cached data:",t),null}},$=e=>{try{Object.keys(localStorage).forEach(t=>{t.startsWith(q+(e||""))&&localStorage.removeItem(t)})}catch(t){console.warn("Failed to clear cache:",t)}};function C(e,s=10,r=null,a={}){const n=`questions_${e}_${s}_${r}`;return t({queryKey:v.questionsByCategory(e,s,r),queryFn:async()=>{const t=await _.fetchQuestions(e,s,r);return S(n,t),t},initialData:()=>{const e=Q(n);if(e)return console.info("Using initialData from cache for",n),e},initialDataUpdatedAt:()=>Q(n)?.timestamp,staleTime:3e5,gcTime:18e5,refetchOnWindowFocus:!1,...a})}function z(){const t=e();return s({mutationFn:({userId:e,categoryId:t,questionCount:s})=>k.createQuizSession(e,t,s),onSuccess:(e,s)=>{t.setQueryData(v.quizSessions(s.userId),t=>[...t||[],e])}})}function I(){const t=e();return s({mutationFn:({sessionId:e,userId:t,finalScore:s})=>k.completeQuizSession(e,t,s),onSuccess:(e,s)=>{t.invalidateQueries({queryKey:v.userStats(s.userId)}),t.invalidateQueries({queryKey:v.userProgress(s.userId)})}})}function E(){return s({mutationFn:e=>_.recordQuizResponsesBatch(e)})}function M(){return s({mutationFn:e=>_.updateUserQuestionHistoryBatch(e)})}function T(){const t=e();return{clearCache:e=>{$(e),e?t.removeQueries({queryKey:[e]}):t.clear()},getCacheSize:()=>{try{let e=0;for(let t in localStorage)t.startsWith(q)&&(e+=localStorage[t].length);return e}catch{return 0}},getOfflineData:(e,t)=>Q(`questions_${e}_${t}`)}}const H=({current:e,total:t,progress:s,score:d=0,accuracy:x=0,averageTime:u=0,showDetailed:g=!0,size:m="normal"})=>{const h=Math.max(0,Math.min(100,e/t*100)),p=Math.max(0,Math.min(100,x)),y=t-e,b=()=>p>=80?"text-green-600 dark:text-green-400":p>=60?"text-blue-600 dark:text-blue-400":p>=40?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400",f=(()=>{switch(m){case"compact":return{container:"py-2",progressHeight:"h-2",text:"text-sm",icons:"w-4 h-4",spacing:"space-y-1"};case"detailed":return{container:"py-6",progressHeight:"h-4",text:"text-base",icons:"w-5 h-5",spacing:"space-y-4"};default:return{container:"py-4",progressHeight:"h-3",text:"text-sm",icons:"w-4 h-4",spacing:"space-y-2"}}})();return r.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 ${f.container}`,children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("h3",{className:`font-semibold text-gray-900 dark:text-white ${f.text}`,children:"Progress"}),r.jsxs("span",{className:`font-bold ${f.text} text-blue-600 dark:text-blue-400`,children:[e," / ",t]})]}),g&&r.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(a,{className:"w-4 h-4 text-purple-500"}),r.jsxs("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:["Score: ",r.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:d})]})]}),x>0&&r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(n,{className:"w-4 h-4 text-green-500"}),r.jsxs("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:["Accuracy: ",r.jsxs("span",{className:b(),children:[Math.round(p),"%"]})]})]}),u>0&&r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(i,{className:"w-4 h-4 text-orange-500"}),r.jsxs("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:["Avg: ",r.jsxs("span",{className:"text-orange-600 dark:text-orange-400",children:[Math.round(u),"s"]})]})]})]})]}),r.jsxs("div",{className:`relative bg-gray-200 dark:bg-gray-700 rounded-full ${f.progressHeight} overflow-hidden mb-4`,children:[r.jsxs(o.div,{className:`${f.progressHeight} bg-gradient-to-r ${p>=80?"from-green-500 to-emerald-600":p>=60?"from-blue-500 to-blue-600":p>=40?"from-yellow-500 to-orange-500":"from-orange-500 to-red-500"} rounded-full relative`,initial:{width:0},animate:{width:`${h}%`},transition:{duration:.8,ease:"easeOut"},children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-pulse"}),h>15&&r.jsx("div",{className:"absolute inset-0 flex items-center justify-end pr-2",children:r.jsxs("span",{className:"text-xs font-bold text-white drop-shadow-sm",children:[Math.round(h),"%"]})})]}),r.jsx(o.div,{className:"absolute top-0 h-full w-1 bg-white shadow-lg",initial:{left:0},animate:{left:`${h}%`},transition:{duration:.8,ease:"easeOut"},style:{transform:"translateX(-50%)"}})]}),t<=20&&"compact"!==m&&r.jsx("div",{className:"mb-4",children:r.jsx("div",{className:"flex items-center justify-center space-x-2 flex-wrap gap-1 pb-6",children:Array.from({length:t},(t,s)=>{const a=s+1,n=a<e,i=a===e;return r.jsxs(o.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.05*s,duration:.3},className:"relative",children:[n?r.jsx(o.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.1},className:"flex items-center justify-center",children:r.jsx(l,{className:`${f.icons} text-green-500`})}):i?r.jsx(o.div,{animate:{scale:[1,1.2,1],rotate:[0,180,360]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"flex items-center justify-center",children:r.jsx(c,{className:`${f.icons} text-blue-500 fill-current`})}):r.jsx(c,{className:`${f.icons} text-gray-300 dark:text-gray-600`}),r.jsx("div",{className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2 text-xs text-gray-500 dark:text-gray-400",children:a})]},s)})})}),g&&"detailed"===m&&r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[r.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[r.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:y}),r.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Remaining"})]}),r.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3",children:[r.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:d}),r.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Correct"})]}),r.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-3",children:[r.jsxs("div",{className:`text-lg font-bold ${b()}`,children:[Math.round(p),"%"]}),r.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Accuracy"})]}),r.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-3",children:[r.jsx("div",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:u>0?`${Math.round(u)}s`:"--"}),r.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Avg Time"})]})]}),g&&"compact"!==m&&r.jsx("div",{className:"mt-4 text-center",children:r.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"text-sm text-gray-600 dark:text-gray-400",children:h>=75?r.jsx("span",{className:"text-green-600 dark:text-green-400 font-medium",children:"🎉 Almost there! You're doing great!"}):h>=50?r.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:"🚀 Halfway done! Keep up the momentum!"}):h>=25?r.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-medium",children:"💪 Good progress! Stay focused!"}):r.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"🌟 Just getting started! You've got this!"})})})]})},O=({currentQuestion:e,selectedOption:t,isAnswered:s,handleOptionSelect:a,showExplanations:n=!0,questionNumber:c=1,totalQuestions:y=1,timeSpent:b=0,difficulty:f="medium"})=>{const[j,N]=d.useState(!1),[w,v]=d.useState(!1),k=e=>{if(!e)return"";return e.replace(/```([\s\S]*?)```/g,'<pre class="bg-gray-100 dark:bg-gray-800 p-3 rounded-lg my-2 overflow-x-auto"><code>$1</code></pre>').replace(/`([^`]+)`/g,'<code class="bg-gray-100 dark:bg-gray-800 px-1 py-0.5 rounded text-sm">$1</code>').replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>")},_=e.image_url||e.imageUrl,q=e.image_url||e.imageUrl,S=e.options?.find(t=>t.id===e.correct_option_id);e.options?.find(e=>e.id===t);const Q=t===e.correct_option_id;return r.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden",children:[r.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 p-4 border-b border-gray-200 dark:border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsxs("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:["Question ",c," of ",y]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(e=>{switch(e?.toLowerCase()){case"easy":case"beginner":return"text-green-600 bg-green-100";case"medium":case"intermediate":return"text-yellow-600 bg-yellow-100";case"hard":case"advanced":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}})(f)}`,children:f||"Medium"})]}),b>0&&r.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[r.jsx(i,{className:"w-4 h-4"}),r.jsxs("span",{children:[Math.round(b),"s"]})]})]}),r.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[_&&r.jsxs("div",{className:"flex items-center space-x-1 text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded-full",children:[r.jsx(x,{className:"w-3 h-3"}),r.jsx("span",{children:"Image Question"})]}),e.question_text?.includes("```")&&r.jsxs("div",{className:"flex items-center space-x-1 text-xs text-purple-600 bg-purple-100 px-2 py-1 rounded-full",children:[r.jsx(u,{className:"w-3 h-3"}),r.jsx("span",{children:"Code"})]}),e.question_tags?.length>0&&r.jsxs("div",{className:"flex items-center space-x-1 text-xs text-green-600 bg-green-100 px-2 py-1 rounded-full",children:[r.jsx(g,{className:"w-3 h-3"}),r.jsxs("span",{children:[e.question_tags.length," topics"]})]})]}),e.question_tags&&e.question_tags.length>0&&r.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.question_tags.slice(0,3).map((e,t)=>{const s=e.tags?.name||e.name||`Tag ${t+1}`,a=e.tag_id||e.id||t;return r.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2 py-0.5 rounded-full dark:bg-blue-900 dark:text-blue-300",children:s},a)}),e.question_tags.length>3&&r.jsxs("span",{className:"text-xs text-gray-500",children:["+",e.question_tags.length-3," more"]})]})]}),r.jsxs("div",{className:"p-6",children:[r.jsx("div",{className:"mb-6",children:r.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white leading-relaxed",dangerouslySetInnerHTML:{__html:k(e.question_text)}})}),_&&r.jsx("div",{className:"mb-6",children:r.jsxs("div",{className:"relative bg-gray-100 dark:bg-gray-700 rounded-lg overflow-hidden",children:[!j&&!w&&r.jsx("div",{className:"flex items-center justify-center h-48 bg-gray-100 dark:bg-gray-700",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),w&&r.jsx("div",{className:"flex items-center justify-center h-48 bg-gray-100 dark:bg-gray-700 text-gray-500",children:r.jsxs("div",{className:"text-center",children:[r.jsx(x,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),r.jsx("p",{className:"text-sm",children:"Image could not be loaded"})]})}),r.jsx("img",{src:q,alt:"Question illustration",className:"w-full h-auto max-h-96 object-contain transition-opacity duration-300 "+(j?"opacity-100":"opacity-0"),onLoad:()=>N(!0),onError:()=>v(!0),style:{display:w?"none":"block"}})]})}),r.jsx("div",{className:"space-y-3",children:e.options&&e.options.map((n,i)=>{const c=t===n.id,d=n.id===e.correct_option_id,x=String.fromCharCode(65+i);let u="w-full text-left p-4 rounded-lg border-2 transition-all duration-300 group";return s?(u+=" cursor-not-allowed",u+=d?" border-green-500 bg-green-50 dark:bg-green-900/20":c&&!d?" border-red-500 bg-red-50 dark:bg-red-900/20":" border-gray-300 dark:border-gray-600 opacity-60"):(u+=" hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:border-blue-300 cursor-pointer",u+=c?" border-blue-500 bg-blue-50 dark:bg-blue-900/20":" border-gray-300 dark:border-gray-600"),r.jsx(o.button,{onClick:()=>!s&&a(n.id),disabled:s,className:u,whileHover:s?{}:{scale:1.01},whileTap:s?{}:{scale:.99},children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[r.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold\n                      "+(s?d?"bg-green-600 text-white":c&&!d?"bg-red-600 text-white":"bg-gray-200 text-gray-400":c?"bg-blue-600 text-white":"bg-gray-200 text-gray-600 group-hover:bg-blue-100"),children:x}),r.jsx("span",{className:"text-gray-900 dark:text-white flex-1 text-left",children:n.text})]}),s&&r.jsx("div",{className:"ml-2",children:d?r.jsx(l,{className:"w-5 h-5 text-green-600"}):c&&!d?r.jsx(m,{className:"w-5 h-5 text-red-600"}):null})]})},n.id)})}),r.jsx(h,{children:s&&n&&r.jsx(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3,delay:.2},className:"mt-6 overflow-hidden",children:r.jsx("div",{className:"p-4 rounded-lg border-l-4 "+(Q?"bg-green-50 dark:bg-green-900/20 border-green-500":"bg-red-50 dark:bg-red-900/20 border-red-500"),children:r.jsxs("div",{className:"flex items-start space-x-2",children:[r.jsx("div",{className:"flex-shrink-0",children:Q?r.jsx(l,{className:"w-5 h-5 text-green-600 mt-0.5"}):r.jsx(m,{className:"w-5 h-5 text-red-600 mt-0.5"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-medium text-gray-900 dark:text-white mb-1",children:Q?"Correct!":"Incorrect"}),r.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:Q?"Well done! You selected the correct answer.":`The correct answer is: ${S?.text||"Not available"}`}),e.explanation&&r.jsxs("div",{className:"mt-3 p-3 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:[r.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[r.jsx(p,{className:"w-4 h-4 text-yellow-600"}),r.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Explanation"})]}),r.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",dangerouslySetInnerHTML:{__html:k(e.explanation)}})]})]})]})})})})]})]},e.id)},D=({error:e,onRetry:t,categoryId:s,questionCount:a,getOfflineData:n,showOfflineOption:i=!0})=>{const o=y(),l=i?n?.(s,a):null;return r.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 shadow-lg border border-gray-200 dark:border-gray-700 max-w-md w-full text-center",children:[r.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:r.jsx(b,{className:"w-8 h-8 text-red-600"})}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Unable to Load Quiz"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:e?.message||"There was a problem loading the quiz questions. This might be due to a network issue."}),r.jsxs("div",{className:"space-y-3",children:[t&&r.jsxs("button",{onClick:t,className:"w-full bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors duration-200 flex items-center justify-center space-x-2",children:[r.jsx(f,{className:"w-4 h-4"}),r.jsx("span",{children:"Try Again"})]}),l&&l.length>0&&r.jsxs("button",{onClick:()=>window.location.reload(),className:"w-full bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors duration-200 flex items-center justify-center space-x-2",children:[r.jsx(j,{className:"w-4 h-4"}),r.jsxs("span",{children:["Use Offline Questions (",l.length,")"]})]}),r.jsxs("button",{onClick:()=>{o("/quick-quiz",{state:{categoryId:"mixed",categoryName:"Mixed Categories",questionCount:10,quizType:"quick"}})},className:"w-full bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-purple-700 transition-colors duration-200 flex items-center justify-center space-x-2",children:[r.jsx(j,{className:"w-4 h-4"}),r.jsx("span",{children:"Try Mixed Quiz"})]}),r.jsx("button",{onClick:()=>o("/quiz"),className:"w-full bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-700 transition-colors duration-200",children:"Back to Categories"}),r.jsxs("button",{onClick:()=>o("/"),className:"w-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-6 py-3 rounded-lg font-semibold hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-200 flex items-center justify-center space-x-2",children:[r.jsx(N,{className:"w-4 h-4"}),r.jsx("span",{children:"Go Home"})]})]}),!1]})})};export{D as Q,H as a,O as b,z as c,E as d,M as e,I as f,C as g,T as u};
