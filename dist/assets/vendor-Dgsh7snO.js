import{r as t,j as e}from"./vendor-react-BvmdJesC.js";var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function i(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var s=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};s.prototype=e.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(t).forEach(function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(s,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})}),s}var r={exports:{}},o={};
/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
!function(t){function e(t,e){var s=t.length;t.push(e);t:for(;0<s;){var n=s-1>>>1,r=t[n];if(!(0<i(r,e)))break t;t[n]=e,t[s]=r,s=n}}function s(t){return 0===t.length?null:t[0]}function n(t){if(0===t.length)return null;var e=t[0],s=t.pop();if(s!==e){t[0]=s;t:for(var n=0,r=t.length,o=r>>>1;n<o;){var a=2*(n+1)-1,l=t[a],c=a+1,h=t[c];if(0>i(l,s))c<r&&0>i(h,l)?(t[n]=h,t[c]=s,n=c):(t[n]=l,t[a]=s,n=a);else{if(!(c<r&&0>i(h,s)))break t;t[n]=h,t[c]=s,n=c}}}return e}function i(t,e){var s=t.sortIndex-e.sortIndex;return 0!==s?s:t.id-e.id}if("object"==typeof performance&&"function"==typeof performance.now){var r=performance;t.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,p=!1,f=!1,m=!1,g="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,y="undefined"!=typeof setImmediate?setImmediate:null;function w(t){for(var i=s(c);null!==i;){if(null===i.callback)n(c);else{if(!(i.startTime<=t))break;n(c),i.sortIndex=i.expirationTime,e(l,i)}i=s(c)}}function b(t){if(m=!1,w(t),!f)if(null!==s(l))f=!0,O(_);else{var e=s(c);null!==e&&I(b,e.startTime-t)}}function _(e,i){f=!1,m&&(m=!1,v(S),S=-1),p=!0;var r=d;try{for(w(i),u=s(l);null!==u&&(!(u.expirationTime>i)||e&&!A());){var o=u.callback;if("function"==typeof o){u.callback=null,d=u.priorityLevel;var a=o(u.expirationTime<=i);i=t.unstable_now(),"function"==typeof a?u.callback=a:u===s(l)&&n(l),w(i)}else n(l);u=s(l)}if(null!==u)var h=!0;else{var g=s(c);null!==g&&I(b,g.startTime-i),h=!1}return h}finally{u=null,d=r,p=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,x=!1,T=null,S=-1,P=5,E=-1;function A(){return!(t.unstable_now()-E<P)}function j(){if(null!==T){var e=t.unstable_now();E=e;var s=!0;try{s=T(!0,e)}finally{s?k():(x=!1,T=null)}}else x=!1}if("function"==typeof y)k=function(){y(j)};else if("undefined"!=typeof MessageChannel){var C=new MessageChannel,R=C.port2;C.port1.onmessage=j,k=function(){R.postMessage(null)}}else k=function(){g(j,0)};function O(t){T=t,x||(x=!0,k())}function I(e,s){S=g(function(){e(t.unstable_now())},s)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(t){t.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,O(_))},t.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<t?Math.floor(1e3/t):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return s(l)},t.unstable_next=function(t){switch(d){case 1:case 2:case 3:var e=3;break;default:e=d}var s=d;d=e;try{return t()}finally{d=s}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var s=d;d=t;try{return e()}finally{d=s}},t.unstable_scheduleCallback=function(n,i,r){var o=t.unstable_now();switch("object"==typeof r&&null!==r?r="number"==typeof(r=r.delay)&&0<r?o+r:o:r=o,n){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return n={id:h++,callback:i,priorityLevel:n,startTime:r,expirationTime:a=r+a,sortIndex:-1},r>o?(n.sortIndex=r,e(c,n),null===s(l)&&n===s(c)&&(m?(v(S),S=-1):m=!0,I(b,r-o))):(n.sortIndex=a,e(l,n),f||p||(f=!0,O(_))),n},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(t){var e=d;return function(){var s=d;d=e;try{return t.apply(this,arguments)}finally{d=s}}}}(o),r.exports=o;var a=r.exports;const l={},c=function(t,e,s){let n=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const t=document.querySelector("meta[property=csp-nonce]"),s=(null==t?void 0:t.nonce)||(null==t?void 0:t.getAttribute("nonce"));n=Promise.allSettled(e.map(t=>{if((t=function(t){return"/"+t}(t))in l)return;l[t]=!0;const e=t.endsWith(".css"),n=e?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${n}`))return;const i=document.createElement("link");return i.rel=e?"stylesheet":"modulepreload",e||(i.as="script"),i.crossOrigin="",i.href=t,s&&i.setAttribute("nonce",s),document.head.appendChild(i),e?new Promise((e,s)=>{i.addEventListener("load",e),i.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${t}`)))}):void 0}))}function i(t){const e=new Event("vite:preloadError",{cancelable:!0});if(e.payload=t,window.dispatchEvent(e),!e.defaultPrevented)throw t}return n.then(e=>{for(const t of e||[])"rejected"===t.status&&i(t.reason);return t().catch(i)})};
/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */
function h(){return h=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},h.apply(this,arguments)}var u,d;(d=u||(u={})).Pop="POP",d.Push="PUSH",d.Replace="REPLACE";const p="popstate";function f(t){return void 0===t&&(t={}),function(t,e,s,n){void 0===n&&(n={});let{window:i=document.defaultView,v5Compat:r=!1}=n,o=i.history,a=u.Pop,l=null,c=d();null==c&&(c=0,o.replaceState(h({},o.state,{idx:c}),""));function d(){return(o.state||{idx:null}).idx}function f(){a=u.Pop;let t=d(),e=null==t?null:t-c;c=t,l&&l({action:a,location:k.location,delta:e})}function g(t,e){a=u.Push;let s=y(k.location,t,e);c=d()+1;let n=v(s,c),h=k.createHref(s);try{o.pushState(n,"",h)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;i.location.assign(h)}r&&l&&l({action:a,location:k.location,delta:1})}function b(t,e){a=u.Replace;let s=y(k.location,t,e);c=d();let n=v(s,c),i=k.createHref(s);o.replaceState(n,"",i),r&&l&&l({action:a,location:k.location,delta:0})}function _(t){let e="null"!==i.location.origin?i.location.origin:i.location.href,s="string"==typeof t?t:w(t);return s=s.replace(/ $/,"%20"),m(e,"No window.location.(origin|href) available to create URL for href: "+s),new URL(s,e)}let k={get action(){return a},get location(){return t(i,o)},listen(t){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(p,f),l=t,()=>{i.removeEventListener(p,f),l=null}},createHref:t=>e(i,t),createURL:_,encodeLocation(t){let e=_(t);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:g,replace:b,go:t=>o.go(t)};return k}(function(t,e){let{pathname:s,search:n,hash:i}=t.location;return y("",{pathname:s,search:n,hash:i},e.state&&e.state.usr||null,e.state&&e.state.key||"default")},function(t,e){return"string"==typeof e?e:w(e)},0,t)}function m(t,e){if(!1===t||null==t)throw new Error(e)}function g(t,e){if(!t){"undefined"!=typeof console&&console.warn(e);try{throw new Error(e)}catch(s){}}}function v(t,e){return{usr:t.state,key:t.key,idx:e}}function y(t,e,s,n){return void 0===s&&(s=null),h({pathname:"string"==typeof t?t:t.pathname,search:"",hash:""},"string"==typeof e?b(e):e,{state:s,key:e&&e.key||n||Math.random().toString(36).substr(2,8)})}function w(t){let{pathname:e="/",search:s="",hash:n=""}=t;return s&&"?"!==s&&(e+="?"===s.charAt(0)?s:"?"+s),n&&"#"!==n&&(e+="#"===n.charAt(0)?n:"#"+n),e}function b(t){let e={};if(t){let s=t.indexOf("#");s>=0&&(e.hash=t.substr(s),t=t.substr(0,s));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}var _,k;function x(t,e,s){return void 0===s&&(s="/"),function(t,e,s){let n="string"==typeof e?b(e):e,i=M(n.pathname||"/",s);if(null==i)return null;let r=T(t);!function(t){t.sort((t,e)=>t.score!==e.score?e.score-t.score:function(t,e){let s=t.length===e.length&&t.slice(0,-1).every((t,s)=>t===e[s]);return s?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map(t=>t.childrenIndex),e.routesMeta.map(t=>t.childrenIndex)))}(r);let o=null;for(let a=0;null==o&&a<r.length;++a){let t=L(i);o=$(r[a],t)}return o}(t,e,s)}function T(t,e,s,n){void 0===e&&(e=[]),void 0===s&&(s=[]),void 0===n&&(n="");let i=(t,i,r)=>{let o={relativePath:void 0===r?t.path||"":r,caseSensitive:!0===t.caseSensitive,childrenIndex:i,route:t};o.relativePath.startsWith("/")&&(m(o.relativePath.startsWith(n),'Absolute route path "'+o.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(n.length));let a=F([n,o.relativePath]),l=s.concat(o);t.children&&t.children.length>0&&(m(!0!==t.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),T(t.children,e,l,a)),(null!=t.path||t.index)&&e.push({path:a,score:I(a,t.index),routesMeta:l})};return t.forEach((t,e)=>{var s;if(""!==t.path&&null!=(s=t.path)&&s.includes("?"))for(let n of S(t.path))i(t,e,n);else i(t,e)}),e}function S(t){let e=t.split("/");if(0===e.length)return[];let[s,...n]=e,i=s.endsWith("?"),r=s.replace(/\?$/,"");if(0===n.length)return i?[r,""]:[r];let o=S(n.join("/")),a=[];return a.push(...o.map(t=>""===t?r:[r,t].join("/"))),i&&a.push(...o),a.map(e=>t.startsWith("/")&&""===e?"/":e)}(k=_||(_={})).data="data",k.deferred="deferred",k.redirect="redirect",k.error="error";const P=/^:[\w-]+$/,E=3,A=2,j=1,C=10,R=-2,O=t=>"*"===t;function I(t,e){let s=t.split("/"),n=s.length;return s.some(O)&&(n+=R),e&&(n+=A),s.filter(t=>!O(t)).reduce((t,e)=>t+(P.test(e)?E:""===e?j:C),n)}function $(t,e,s){let{routesMeta:n}=t,i={},r="/",o=[];for(let a=0;a<n.length;++a){let t=n[a],s=a===n.length-1,l="/"===r?e:e.slice(r.length)||"/",c=D({path:t.relativePath,caseSensitive:t.caseSensitive,end:s},l),h=t.route;if(!c)return null;Object.assign(i,c.params),o.push({params:i,pathname:F([r,c.pathname]),pathnameBase:N(F([r,c.pathnameBase])),route:h}),"/"!==c.pathnameBase&&(r=F([r,c.pathnameBase]))}return o}function D(t,e){"string"==typeof t&&(t={path:t,caseSensitive:!1,end:!0});let[s,n]=function(t,e,s){void 0===e&&(e=!1);void 0===s&&(s=!0);g("*"===t||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were "'+t.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+t.replace(/\*$/,"/*")+'".');let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(t,e,s)=>(n.push({paramName:e,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)"));t.endsWith("*")?(n.push({paramName:"*"}),i+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?i+="\\/*$":""!==t&&"/"!==t&&(i+="(?:(?=\\/|$))");let r=new RegExp(i,e?void 0:"i");return[r,n]}(t.path,t.caseSensitive,t.end),i=e.match(s);if(!i)return null;let r=i[0],o=r.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((t,e,s)=>{let{paramName:n,isOptional:i}=e;if("*"===n){let t=a[s]||"";o=r.slice(0,r.length-t.length).replace(/(.)\/+$/,"$1")}const l=a[s];return t[n]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),t},{}),pathname:r,pathnameBase:o,pattern:t}}function L(t){try{return t.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(e){return g(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+e+")."),t}}function M(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let s=e.endsWith("/")?e.length-1:e.length,n=t.charAt(s);return n&&"/"!==n?null:t.slice(s)||"/"}function V(t,e,s,n){return"Cannot include a '"+t+"' character in a manually specified `to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+s+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function U(t,e){let s=function(t){return t.filter((t,e)=>0===e||t.route.path&&t.route.path.length>0)}(t);return e?s.map((t,e)=>e===s.length-1?t.pathname:t.pathnameBase):s.map(t=>t.pathnameBase)}function B(t,e,s,n){let i;void 0===n&&(n=!1),"string"==typeof t?i=b(t):(i=h({},t),m(!i.pathname||!i.pathname.includes("?"),V("?","pathname","search",i)),m(!i.pathname||!i.pathname.includes("#"),V("#","pathname","hash",i)),m(!i.search||!i.search.includes("#"),V("#","search","hash",i)));let r,o=""===t||""===i.pathname,a=o?"/":i.pathname;if(null==a)r=s;else{let t=e.length-1;if(!n&&a.startsWith("..")){let e=a.split("/");for(;".."===e[0];)e.shift(),t-=1;i.pathname=e.join("/")}r=t>=0?e[t]:"/"}let l=function(t,e){void 0===e&&(e="/");let{pathname:s,search:n="",hash:i=""}="string"==typeof t?b(t):t,r=s?s.startsWith("/")?s:function(t,e){let s=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(t=>{".."===t?s.length>1&&s.pop():"."!==t&&s.push(t)}),s.length>1?s.join("/"):"/"}(s,e):e;return{pathname:r,search:W(n),hash:q(i)}}(i,r),c=a&&"/"!==a&&a.endsWith("/"),u=(o||"."===a)&&s.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}const F=t=>t.join("/").replace(/\/\/+/g,"/"),N=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),W=t=>t&&"?"!==t?t.startsWith("?")?t:"?"+t:"",q=t=>t&&"#"!==t?t.startsWith("#")?t:"#"+t:"";function z(t){return null!=t&&"number"==typeof t.status&&"string"==typeof t.statusText&&"boolean"==typeof t.internal&&"data"in t}const K=["post","put","patch","delete"];new Set(K);const H=["get",...K];new Set(H);class G extends Error{constructor(t,e="FunctionsError",s){super(t),this.name=e,this.context=s}}class J extends G{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Y extends G{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class X extends G{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Z,Q;(Q=Z||(Z={})).Any="any",Q.ApNortheast1="ap-northeast-1",Q.ApNortheast2="ap-northeast-2",Q.ApSouth1="ap-south-1",Q.ApSoutheast1="ap-southeast-1",Q.ApSoutheast2="ap-southeast-2",Q.CaCentral1="ca-central-1",Q.EuCentral1="eu-central-1",Q.EuWest1="eu-west-1",Q.EuWest2="eu-west-2",Q.EuWest3="eu-west-3",Q.SaEast1="sa-east-1",Q.UsEast1="us-east-1",Q.UsWest1="us-west-1",Q.UsWest2="us-west-2";var tt=function(t,e,s,n){return new(s||(s=Promise))(function(i,r){function o(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n.throw(t))}catch(e){r(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class et{constructor(t,{headers:e={},customFetch:s,region:n=Z.Any}={}){this.url=t,this.headers=e,this.region=n,this.fetch=(t=>{let e;return e=t||("undefined"==typeof fetch?(...t)=>c(async()=>{const{default:t}=await Promise.resolve().then(()=>ft);return{default:t}},void 0).then(({default:e})=>e(...t)):fetch),(...t)=>e(...t)})(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,e={}){var s;return tt(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:r}=e;let o,a={},{region:l}=e;l||(l=this.region),l&&"any"!==l&&(a["x-region"]=l),r&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!=typeof Blob&&r instanceof Blob||r instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",o=r):"string"==typeof r?(a["Content-Type"]="text/plain",o=r):"undefined"!=typeof FormData&&r instanceof FormData?o=r:(a["Content-Type"]="application/json",o=JSON.stringify(r)));const c=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:o}).catch(t=>{throw new J(t)}),h=c.headers.get("x-relay-error");if(h&&"true"===h)throw new Y(c);if(!c.ok)throw new X(c);let u,d=(null!==(s=c.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return u="application/json"===d?yield c.json():"application/octet-stream"===d?yield c.blob():"text/event-stream"===d?c:"multipart/form-data"===d?yield c.formData():yield c.text(),{data:u,error:null}}catch(n){return{data:null,error:n}}})}}var st={},nt={},it={},rt={},ot={},at={},lt=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const ct=lt.fetch,ht=lt.fetch.bind(lt),ut=lt.Headers,dt=lt.Request,pt=lt.Response,ft=Object.freeze(Object.defineProperty({__proto__:null,Headers:ut,Request:dt,Response:pt,default:ht,fetch:ct},Symbol.toStringTag,{value:"Module"})),mt=i(ft);var gt={};Object.defineProperty(gt,"__esModule",{value:!0});let vt=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};gt.default=vt;var yt=s&&s.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(at,"__esModule",{value:!0});const wt=yt(mt),bt=yt(gt);at.default=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:"undefined"==typeof fetch?this.fetch=wt.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=Object.assign({},this.headers),this.headers[t]=e,this}then(t,e){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async t=>{var e,s,n;let i=null,r=null,o=null,a=t.status,l=t.statusText;if(t.ok){if("HEAD"!==this.method){const e=await t.text();""===e||(r="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?e:JSON.parse(e))}const n=null===(e=this.headers.Prefer)||void 0===e?void 0:e.match(/count=(exact|planned|estimated)/),c=null===(s=t.headers.get("content-range"))||void 0===s?void 0:s.split("/");n&&c&&c.length>1&&(o=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(r)&&(r.length>1?(i={code:"PGRST116",details:`Results contain ${r.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},r=null,o=null,a=406,l="Not Acceptable"):r=1===r.length?r[0]:null)}else{const e=await t.text();try{i=JSON.parse(e),Array.isArray(i)&&404===t.status&&(r=[],i=null,a=200,l="OK")}catch(c){404===t.status&&""===e?(a=204,l="No Content"):i={message:e}}if(i&&this.isMaybeSingle&&(null===(n=null==i?void 0:i.details)||void 0===n?void 0:n.includes("0 rows"))&&(i=null,a=200,l="OK"),i&&this.shouldThrowOnError)throw new bt.default(i)}return{error:i,data:r,count:o,status:a,statusText:l}});return this.shouldThrowOnError||(s=s.catch(t=>{var e,s,n;return{error:{message:`${null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"FetchError"}: ${null==t?void 0:t.message}`,details:`${null!==(s=null==t?void 0:t.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(n=null==t?void 0:t.code)&&void 0!==n?n:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,e)}returns(){return this}overrideTypes(){return this}};var _t=s&&s.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ot,"__esModule",{value:!0});const kt=_t(at);let xt=class extends kt.default{select(t){let e=!1;const s=(null!=t?t:"*").split("").map(t=>/\s/.test(t)&&!e?"":('"'===t&&(e=!e),t)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:e=!0,nullsFirst:s,foreignTable:n,referencedTable:i=n}={}){const r=i?`${i}.order`:"order",o=this.url.searchParams.get(r);return this.url.searchParams.set(r,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:s=e}={}){const n=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,e,{foreignTable:s,referencedTable:n=s}={}){const i=void 0===n?"offset":`${n}.offset`,r=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(r,""+(e-t+1)),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:e=!1,settings:s=!1,buffers:n=!1,wal:i=!1,format:r="text"}={}){var o;const a=[t?"analyze":null,e?"verbose":null,s?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=null!==(o=this.headers.Accept)&&void 0!==o?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${r}; for="${l}"; options=${a};`,this}rollback(){var t;return(null!==(t=this.headers.Prefer)&&void 0!==t?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};ot.default=xt;var Tt=s&&s.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(rt,"__esModule",{value:!0});const St=Tt(ot);let Pt=class extends St.default{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){const s=Array.from(new Set(e)).map(t=>"string"==typeof t&&new RegExp("[,()]").test(t)?`"${t}"`:`${t}`).join(",");return this.url.searchParams.append(t,`in.(${s})`),this}contains(t,e){return"string"==typeof e?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return"string"==typeof e?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return"string"==typeof e?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:s,type:n}={}){let i="";"plain"===n?i="pl":"phrase"===n?i="ph":"websearch"===n&&(i="w");const r=void 0===s?"":`(${s})`;return this.url.searchParams.append(t,`${i}fts${r}.${e}`),this}match(t){return Object.entries(t).forEach(([t,e])=>{this.url.searchParams.append(t,`eq.${e}`)}),this}not(t,e,s){return this.url.searchParams.append(t,`not.${e}.${s}`),this}or(t,{foreignTable:e,referencedTable:s=e}={}){const n=s?`${s}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,e,s){return this.url.searchParams.append(t,`${e}.${s}`),this}};rt.default=Pt;var Et=s&&s.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(it,"__esModule",{value:!0});const At=Et(rt);it.default=class{constructor(t,{headers:e={},schema:s,fetch:n}){this.url=t,this.headers=e,this.schema=s,this.fetch=n}select(t,{head:e=!1,count:s}={}){const n=e?"HEAD":"GET";let i=!1;const r=(null!=t?t:"*").split("").map(t=>/\s/.test(t)&&!i?"":('"'===t&&(i=!i),t)).join("");return this.url.searchParams.set("select",r),s&&(this.headers.Prefer=`count=${s}`),new At.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:e,defaultToNull:s=!0}={}){const n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),e&&n.push(`count=${e}`),s||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(t)){const e=t.reduce((t,e)=>t.concat(Object.keys(e)),[]);if(e.length>0){const t=[...new Set(e)].map(t=>`"${t}"`);this.url.searchParams.set("columns",t.join(","))}}return new At.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:e,ignoreDuplicates:s=!1,count:n,defaultToNull:i=!0}={}){const r=[`resolution=${s?"ignore":"merge"}-duplicates`];if(void 0!==e&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&r.push(this.headers.Prefer),n&&r.push(`count=${n}`),i||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(t)){const e=t.reduce((t,e)=>t.concat(Object.keys(e)),[]);if(e.length>0){const t=[...new Set(e)].map(t=>`"${t}"`);this.url.searchParams.set("columns",t.join(","))}}return new At.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:e}={}){const s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),e&&s.push(`count=${e}`),this.headers.Prefer=s.join(","),new At.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const e=[];return t&&e.push(`count=${t}`),this.headers.Prefer&&e.unshift(this.headers.Prefer),this.headers.Prefer=e.join(","),new At.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var jt={},Ct={};Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.version=void 0,Ct.version="0.0.0-automated",Object.defineProperty(jt,"__esModule",{value:!0}),jt.DEFAULT_HEADERS=void 0;const Rt=Ct;jt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Rt.version}`};var Ot=s&&s.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(nt,"__esModule",{value:!0});const It=Ot(it),$t=Ot(rt),Dt=jt;nt.default=class t{constructor(t,{headers:e={},schema:s,fetch:n}={}){this.url=t,this.headers=Object.assign(Object.assign({},Dt.DEFAULT_HEADERS),e),this.schemaName=s,this.fetch=n}from(t){const e=new URL(`${this.url}/${t}`);return new It.default(e,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new t(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(t,e={},{head:s=!1,get:n=!1,count:i}={}){let r;const o=new URL(`${this.url}/rpc/${t}`);let a;s||n?(r=s?"HEAD":"GET",Object.entries(e).filter(([t,e])=>void 0!==e).map(([t,e])=>[t,Array.isArray(e)?`{${e.join(",")}}`:`${e}`]).forEach(([t,e])=>{o.searchParams.append(t,e)})):(r="POST",a=e);const l=Object.assign({},this.headers);return i&&(l.Prefer=`count=${i}`),new $t.default({method:r,url:o,headers:l,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}};var Lt=s&&s.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(st,"__esModule",{value:!0}),st.PostgrestError=st.PostgrestBuilder=st.PostgrestTransformBuilder=st.PostgrestFilterBuilder=st.PostgrestQueryBuilder=st.PostgrestClient=void 0;const Mt=Lt(nt);st.PostgrestClient=Mt.default;const Vt=Lt(it);st.PostgrestQueryBuilder=Vt.default;const Ut=Lt(rt);st.PostgrestFilterBuilder=Ut.default;const Bt=Lt(ot);st.PostgrestTransformBuilder=Bt.default;const Ft=Lt(at);st.PostgrestBuilder=Ft.default;const Nt=Lt(gt);st.PostgrestError=Nt.default;var Wt=st.default={PostgrestClient:Mt.default,PostgrestQueryBuilder:Vt.default,PostgrestFilterBuilder:Ut.default,PostgrestTransformBuilder:Bt.default,PostgrestBuilder:Ft.default,PostgrestError:Nt.default};const{PostgrestClient:qt,PostgrestQueryBuilder:zt,PostgrestFilterBuilder:Kt,PostgrestTransformBuilder:Ht,PostgrestBuilder:Gt,PostgrestError:Jt}=Wt;const Yt=function(){if("undefined"!=typeof WebSocket)return WebSocket;if(void 0!==global.WebSocket)return global.WebSocket;if(void 0!==window.WebSocket)return window.WebSocket;if(void 0!==self.WebSocket)return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}(),Xt={"X-Client-Info":"realtime-js/2.11.13"};var Zt,Qt,te,ee,se,ne,ie,re,oe,ae,le;(Qt=Zt||(Zt={}))[Qt.connecting=0]="connecting",Qt[Qt.open=1]="open",Qt[Qt.closing=2]="closing",Qt[Qt.closed=3]="closed",(ee=te||(te={})).closed="closed",ee.errored="errored",ee.joined="joined",ee.joining="joining",ee.leaving="leaving",(ne=se||(se={})).close="phx_close",ne.error="phx_error",ne.join="phx_join",ne.reply="phx_reply",ne.leave="phx_leave",ne.access_token="access_token",(ie||(ie={})).websocket="websocket",(oe=re||(re={})).Connecting="connecting",oe.Open="open",oe.Closing="closing",oe.Closed="closed";class ce{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e("string"==typeof t?JSON.parse(t):{})}_binaryDecode(t){const e=new DataView(t),s=new TextDecoder;return this._decodeBroadcast(t,e,s)}_decodeBroadcast(t,e,s){const n=e.getUint8(1),i=e.getUint8(2);let r=this.HEADER_LENGTH+2;const o=s.decode(t.slice(r,r+n));r+=n;const a=s.decode(t.slice(r,r+i));r+=i;return{ref:null,topic:o,event:a,payload:JSON.parse(s.decode(t.slice(r,t.byteLength)))}}}class he{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(le=ae||(ae={})).abstime="abstime",le.bool="bool",le.date="date",le.daterange="daterange",le.float4="float4",le.float8="float8",le.int2="int2",le.int4="int4",le.int4range="int4range",le.int8="int8",le.int8range="int8range",le.json="json",le.jsonb="jsonb",le.money="money",le.numeric="numeric",le.oid="oid",le.reltime="reltime",le.text="text",le.time="time",le.timestamp="timestamp",le.timestamptz="timestamptz",le.timetz="timetz",le.tsrange="tsrange",le.tstzrange="tstzrange";const ue=(t,e,s={})=>{var n;const i=null!==(n=s.skipTypes)&&void 0!==n?n:[];return Object.keys(e).reduce((s,n)=>(s[n]=de(n,t,e,i),s),{})},de=(t,e,s,n)=>{const i=e.find(e=>e.name===t),r=null==i?void 0:i.type,o=s[t];return r&&!n.includes(r)?pe(r,o):fe(o)},pe=(t,e)=>{if("_"===t.charAt(0)){const s=t.slice(1,t.length);return ye(e,s)}switch(t){case ae.bool:return me(e);case ae.float4:case ae.float8:case ae.int2:case ae.int4:case ae.int8:case ae.numeric:case ae.oid:return ge(e);case ae.json:case ae.jsonb:return ve(e);case ae.timestamp:return we(e);case ae.abstime:case ae.date:case ae.daterange:case ae.int4range:case ae.int8range:case ae.money:case ae.reltime:case ae.text:case ae.time:case ae.timestamptz:case ae.timetz:case ae.tsrange:case ae.tstzrange:default:return fe(e)}},fe=t=>t,me=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},ge=t=>{if("string"==typeof t){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},ve=t=>{if("string"==typeof t)try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},ye=(t,e)=>{if("string"!=typeof t)return t;const s=t.length-1,n=t[s];if("{"===t[0]&&"}"===n){let n;const r=t.slice(1,s);try{n=JSON.parse("["+r+"]")}catch(i){n=r?r.split(","):[]}return n.map(t=>pe(e,t))}return t},we=t=>"string"==typeof t?t.replace(" ","T"):t,be=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class _e{constructor(t,e,s={},n=1e4){this.channel=t,this.event=e,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var s;return this._hasReceived(t)&&e(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(e=>e.status===t).forEach(t=>t.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var ke,xe,Te,Se,Pe,Ee,Ae,je;(xe=ke||(ke={})).SYNC="sync",xe.JOIN="join",xe.LEAVE="leave";class Ce{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null==e?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},t=>{const{onJoin:e,onLeave:s,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ce.syncState(this.state,t,e,s),this.pendingDiffs.forEach(t=>{this.state=Ce.syncDiff(this.state,t,e,s)}),this.pendingDiffs=[],n()}),this.channel._on(s.diff,{},t=>{const{onJoin:e,onLeave:s,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(t):(this.state=Ce.syncDiff(this.state,t,e,s),n())}),this.onJoin((t,e,s)=>{this.channel._trigger("presence",{event:"join",key:t,currentPresences:e,newPresences:s})}),this.onLeave((t,e,s)=>{this.channel._trigger("presence",{event:"leave",key:t,currentPresences:e,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,s,n){const i=this.cloneDeep(t),r=this.transformState(e),o={},a={};return this.map(i,(t,e)=>{r[t]||(a[t]=e)}),this.map(r,(t,e)=>{const s=i[t];if(s){const n=e.map(t=>t.presence_ref),i=s.map(t=>t.presence_ref),r=e.filter(t=>i.indexOf(t.presence_ref)<0),l=s.filter(t=>n.indexOf(t.presence_ref)<0);r.length>0&&(o[t]=r),l.length>0&&(a[t]=l)}else o[t]=e}),this.syncDiff(i,{joins:o,leaves:a},s,n)}static syncDiff(t,e,s,n){const{joins:i,leaves:r}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(e,n)=>{var i;const r=null!==(i=t[e])&&void 0!==i?i:[];if(t[e]=this.cloneDeep(n),r.length>0){const s=t[e].map(t=>t.presence_ref),n=r.filter(t=>s.indexOf(t.presence_ref)<0);t[e].unshift(...n)}s(e,r,n)}),this.map(r,(e,s)=>{let i=t[e];if(!i)return;const r=s.map(t=>t.presence_ref);i=i.filter(t=>r.indexOf(t.presence_ref)<0),t[e]=i,n(e,i,s),0===i.length&&delete t[e]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(s=>e(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,s)=>{const n=t[s];return e[s]="metas"in n?n.metas.map(t=>(t.presence_ref=t.phx_ref,delete t.phx_ref,delete t.phx_ref_prev,t)):n,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(Se=Te||(Te={})).ALL="*",Se.INSERT="INSERT",Se.UPDATE="UPDATE",Se.DELETE="DELETE",(Ee=Pe||(Pe={})).BROADCAST="broadcast",Ee.PRESENCE="presence",Ee.POSTGRES_CHANGES="postgres_changes",Ee.SYSTEM="system",(je=Ae||(Ae={})).SUBSCRIBED="SUBSCRIBED",je.TIMED_OUT="TIMED_OUT",je.CLOSED="CLOSED",je.CHANNEL_ERROR="CHANNEL_ERROR";class Re{constructor(t,e={config:{}},s){this.topic=t,this.params=e,this.socket=s,this.bindings={},this.state=te.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new _e(this,se.join,this.params,this.timeout),this.rejoinTimer=new he(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=te.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(t=>t.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=te.closed,this.socket._remove(this)}),this._onError(t=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,t),this.state=te.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=te.errored,this.rejoinTimer.scheduleTimeout())}),this._on(se.reply,{},(t,e)=>{this._trigger(this._replyEventName(e),t)}),this.presence=new Ce(this),this.broadcastEndpointURL=be(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,e=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==te.closed){const{config:{broadcast:i,presence:r,private:o}}=this.params;this._onError(e=>null==t?void 0:t(Ae.CHANNEL_ERROR,e)),this._onClose(()=>null==t?void 0:t(Ae.CLOSED));const a={},l={broadcast:i,presence:r,postgres_changes:null!==(n=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map(t=>t.filter))&&void 0!==n?n:[],private:o};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},a)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:e})=>{var s;if(this.socket.setAuth(),void 0!==e){const n=this.bindings.postgres_changes,i=null!==(s=null==n?void 0:n.length)&&void 0!==s?s:0,r=[];for(let s=0;s<i;s++){const i=n[s],{filter:{event:o,schema:a,table:l,filter:c}}=i,h=e&&e[s];if(!h||h.event!==o||h.schema!==a||h.table!==l||h.filter!==c)return this.unsubscribe(),this.state=te.errored,void(null==t||t(Ae.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));r.push(Object.assign(Object.assign({},i),{id:h.id}))}return this.bindings.postgres_changes=r,void(t&&t(Ae.SUBSCRIBED))}null==t||t(Ae.SUBSCRIBED)}).receive("error",e=>{this.state=te.errored,null==t||t(Ae.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(e).join(", ")||"error")))}).receive("timeout",()=>{null==t||t(Ae.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,e={}){return await this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,e,s){return this._on(t,e,s)}async send(t,e={}){var s,n;if(this._canPush()||"broadcast"!==t.type)return new Promise(s=>{var n,i,r;const o=this._push(t.type,t,e.timeout||this.timeout);"broadcast"!==t.type||(null===(r=null===(i=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===i?void 0:i.broadcast)||void 0===r?void 0:r.ack)||s("ok"),o.receive("ok",()=>s("ok")),o.receive("error",()=>s("error")),o.receive("timeout",()=>s("timed out"))});{const{event:r,payload:o}=t,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:o,private:this.private}]})};try{const t=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!==(s=e.timeout)&&void 0!==s?s:this.timeout);return await(null===(n=t.body)||void 0===n?void 0:n.cancel()),t.ok?"ok":"error"}catch(i){return"AbortError"===i.name?"timed out":"error"}}}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=te.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(se.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new _e(this,se.leave,{},t),s.receive("ok",()=>{e(),n("ok")}).receive("timeout",()=>{e(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{null==s||s.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,e,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),r=await this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:n.signal}));return clearTimeout(i),r}_push(t,e,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new _e(this,t,e,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(t,e,s){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,s){var n,i;const r=t.toLocaleLowerCase(),{close:o,error:a,leave:l,join:c}=se;if(s&&[o,a,l,c].indexOf(r)>=0&&s!==this._joinRef())return;let h=this._onMessage(r,e,s);if(e&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(r)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter(t=>{var e,s,n;return"*"===(null===(e=t.filter)||void 0===e?void 0:e.event)||(null===(n=null===(s=t.filter)||void 0===s?void 0:s.event)||void 0===n?void 0:n.toLocaleLowerCase())===r}).map(t=>t.callback(h,s)):null===(i=this.bindings[r])||void 0===i||i.filter(t=>{var s,n,i,o,a,l;if(["broadcast","presence","postgres_changes"].includes(r)){if("id"in t){const r=t.id,o=null===(s=t.filter)||void 0===s?void 0:s.event;return r&&(null===(n=e.ids)||void 0===n?void 0:n.includes(r))&&("*"===o||(null==o?void 0:o.toLocaleLowerCase())===(null===(i=e.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{const s=null===(a=null===(o=null==t?void 0:t.filter)||void 0===o?void 0:o.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===s||s===(null===(l=null==e?void 0:e.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return t.type.toLocaleLowerCase()===r}).map(t=>{if("object"==typeof h&&"ids"in h){const t=h.data,{schema:e,table:s,commit_timestamp:n,type:i,errors:r}=t,o={schema:e,table:s,commit_timestamp:n,eventType:i,new:{},old:{},errors:r};h=Object.assign(Object.assign({},o),this._getPayloadRecords(t))}t.callback(h,s)})}_isClosed(){return this.state===te.closed}_isJoined(){return this.state===te.joined}_isJoining(){return this.state===te.joining}_isLeaving(){return this.state===te.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,s){const n=t.toLocaleLowerCase(),i={type:n,filter:e,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(t,e){const s=t.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(t=>{var n;return!((null===(n=t.type)||void 0===n?void 0:n.toLocaleLowerCase())===s&&Re.isEqual(t.filter,e))}),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const s in t)if(t[s]!==e[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(se.close,{},t)}_onError(t){this._on(se.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=te.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return"INSERT"!==t.type&&"UPDATE"!==t.type||(e.new=ue(t.columns,t.record)),"UPDATE"!==t.type&&"DELETE"!==t.type||(e.old=ue(t.columns,t.old_record)),e}}const Oe=()=>{};class Ie{constructor(t,e){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=Xt,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Oe,this.ref=0,this.logger=Oe,this.conn=null,this.sendBuffer=[],this.serializer=new ce,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=t=>{let e;return e=t||("undefined"==typeof fetch?(...t)=>c(async()=>{const{default:t}=await Promise.resolve().then(()=>ft);return{default:t}},void 0).then(({default:e})=>e(...t)):fetch),(...t)=>e(...t)},this.endPoint=`${t}/${ie.websocket}`,this.httpEndpoint=be(t),(null==e?void 0:e.transport)?this.transport=e.transport:this.transport=null,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),(null==e?void 0:e.timeout)&&(this.timeout=e.timeout),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),(null==e?void 0:e.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);const n=null===(s=null==e?void 0:e.params)||void 0===s?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=(null==e?void 0:e.reconnectAfterMs)?e.reconnectAfterMs:t=>[1e3,2e3,5e3,1e4][t-1]||1e4,this.encode=(null==e?void 0:e.encode)?e.encode:(t,e)=>e(JSON.stringify(t)),this.decode=(null==e?void 0:e.decode)?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new he(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null==e?void 0:e.fetch),null==e?void 0:e.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==e?void 0:e.worker)||!1,this.workerUrl=null==e?void 0:e.workerUrl}this.accessToken=(null==e?void 0:e.accessToken)||null}connect(){this.conn||(this.transport||(this.transport=Yt),this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection())}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(t,e){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,null!=e?e:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(t=>t.teardown()))}getChannels(){return this.channels}async removeChannel(t){const e=await t.unsubscribe();return 0===this.channels.length&&this.disconnect(),e}async removeAllChannels(){const t=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,e,s){this.logger(t,e,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Zt.connecting:return re.Connecting;case Zt.open:return re.Open;case Zt.closing:return re.Closing;default:return re.Closed}}isConnected(){return this.connectionState()===re.Open}channel(t,e={config:{}}){const s=`realtime:${t}`,n=this.getChannels().find(t=>t.topic===s);if(n)return n;{const s=new Re(`realtime:${t}`,e,this);return this.channels.push(s),s}}push(t){const{topic:e,event:s,payload:n,ref:i}=t,r=()=>{this.encode(t,t=>{var e;null===(e=this.conn)||void 0===e||e.send(t)})};this.log("push",`${e} ${s} (${i})`,n),this.isConnected()?r():this.sendBuffer.push(r)}async setAuth(t=null){let e=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e,version:this.headers&&this.headers["X-Client-Info"]}),t.joinedOnce&&t._isJoined()&&t._push(se.access_token,{access_token:e})}))}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),void(null===(t=this.conn)||void 0===t||t.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}else this.heartbeatCallback("disconnected")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(e=>e.topic===t&&(e._isJoined()||e._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,t=>{let{topic:e,event:s,payload:n,ref:i}=t;"phoenix"===e&&"phx_reply"===s&&this.heartbeatCallback("ok"==t.payload.status?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${e} ${s} ${i&&"("+i+")"||""}`,n),Array.from(this.channels).filter(t=>t._isMember(e)).forEach(t=>t._trigger(s,n,i)),this.stateChangeCallbacks.message.forEach(e=>e(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{"keepAlive"===t.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(se.error))}_appendParams(t,e){if(0===Object.keys(e).length)return t;const s=t.match(/\?/)?"&":"?";return`${t}${s}${new URLSearchParams(e)}`}_workerObjectUrl(t){let e;if(t)e=t;else{const t=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});e=URL.createObjectURL(t)}return e}}class $e extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function De(t){return"object"==typeof t&&null!==t&&"__isStorageError"in t}class Le extends $e{constructor(t,e){super(t),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Me extends $e{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}var Ve=function(t,e,s,n){return new(s||(s=Promise))(function(i,r){function o(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n.throw(t))}catch(e){r(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};const Ue=t=>{let e;return e=t||("undefined"==typeof fetch?(...t)=>c(async()=>{const{default:t}=await Promise.resolve().then(()=>ft);return{default:t}},void 0).then(({default:e})=>e(...t)):fetch),(...t)=>e(...t)},Be=t=>{if(Array.isArray(t))return t.map(t=>Be(t));if("function"==typeof t||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,t=>t.toUpperCase().replace(/[-_]/g,""));e[n]=Be(s)}),e};var Fe=function(t,e,s,n){return new(s||(s=Promise))(function(i,r){function o(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n.throw(t))}catch(e){r(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};const Ne=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),We=(t,e,s)=>Fe(void 0,void 0,void 0,function*(){const n=yield Ve(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield c(()=>Promise.resolve().then(()=>ft),void 0)).Response:Response});t instanceof n&&!(null==s?void 0:s.noResolveJson)?t.json().then(s=>{e(new Le(Ne(s),t.status||500))}).catch(t=>{e(new Me(Ne(t),t))}):e(new Me(Ne(t),t))});function qe(t,e,s,n,i,r){return Fe(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(s,((t,e,s,n)=>{const i={method:t,headers:(null==e?void 0:e.headers)||{}};return"GET"===t?i:(i.headers=Object.assign({"Content-Type":"application/json"},null==e?void 0:e.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),s))})(e,n,i,r)).then(t=>{if(!t.ok)throw t;return(null==n?void 0:n.noResolveJson)?t:t.json()}).then(t=>o(t)).catch(t=>We(t,a,n))})})}function ze(t,e,s,n){return Fe(this,void 0,void 0,function*(){return qe(t,"GET",e,s,n)})}function Ke(t,e,s,n,i){return Fe(this,void 0,void 0,function*(){return qe(t,"POST",e,n,i,s)})}function He(t,e,s,n,i){return Fe(this,void 0,void 0,function*(){return qe(t,"DELETE",e,n,i,s)})}var Ge=function(t,e,s,n){return new(s||(s=Promise))(function(i,r){function o(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n.throw(t))}catch(e){r(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};const Je={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ye={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Xe{constructor(t,e={},s,n){this.url=t,this.headers=e,this.bucketId=s,this.fetch=Ue(n)}uploadOrUpdate(t,e,s,n){return Ge(this,void 0,void 0,function*(){try{let i;const r=Object.assign(Object.assign({},Ye),n);let o=Object.assign(Object.assign({},this.headers),"POST"===t&&{"x-upsert":String(r.upsert)});const a=r.metadata;"undefined"!=typeof Blob&&s instanceof Blob?(i=new FormData,i.append("cacheControl",r.cacheControl),a&&i.append("metadata",this.encodeMetadata(a)),i.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(i=s,i.append("cacheControl",r.cacheControl),a&&i.append("metadata",this.encodeMetadata(a))):(i=s,o["cache-control"]=`max-age=${r.cacheControl}`,o["content-type"]=r.contentType,a&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),(null==n?void 0:n.headers)&&(o=Object.assign(Object.assign({},o),n.headers));const l=this._removeEmptyFolders(e),c=this._getFinalPath(l),h=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:t,body:i,headers:o},(null==r?void 0:r.duplex)?{duplex:r.duplex}:{})),u=yield h.json();if(h.ok)return{data:{path:l,id:u.Id,fullPath:u.Key},error:null};return{data:null,error:u}}catch(i){if(De(i))return{data:null,error:i};throw i}})}upload(t,e,s){return Ge(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,s)})}uploadToSignedUrl(t,e,s,n){return Ge(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),r=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${r}`);o.searchParams.set("token",e);try{let t;const e=Object.assign({upsert:Ye.upsert},n),r=Object.assign(Object.assign({},this.headers),{"x-upsert":String(e.upsert)});"undefined"!=typeof Blob&&s instanceof Blob?(t=new FormData,t.append("cacheControl",e.cacheControl),t.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(t=s,t.append("cacheControl",e.cacheControl)):(t=s,r["cache-control"]=`max-age=${e.cacheControl}`,r["content-type"]=e.contentType);const a=yield this.fetch(o.toString(),{method:"PUT",body:t,headers:r}),l=yield a.json();if(a.ok)return{data:{path:i,fullPath:l.Key},error:null};return{data:null,error:l}}catch(a){if(De(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(t,e){return Ge(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t);const n=Object.assign({},this.headers);(null==e?void 0:e.upsert)&&(n["x-upsert"]="true");const i=yield Ke(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),r=new URL(this.url+i.url),o=r.searchParams.get("token");if(!o)throw new $e("No token returned by API");return{data:{signedUrl:r.toString(),path:t,token:o},error:null}}catch(s){if(De(s))return{data:null,error:s};throw s}})}update(t,e,s){return Ge(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,s)})}move(t,e,s){return Ge(this,void 0,void 0,function*(){try{return{data:yield Ke(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(De(n))return{data:null,error:n};throw n}})}copy(t,e,s){return Ge(this,void 0,void 0,function*(){try{return{data:{path:(yield Ke(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(De(n))return{data:null,error:n};throw n}})}createSignedUrl(t,e,s){return Ge(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),i=yield Ke(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:e},(null==s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const r=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${r}`)},{data:i,error:null}}catch(n){if(De(n))return{data:null,error:n};throw n}})}createSignedUrls(t,e,s){return Ge(this,void 0,void 0,function*(){try{const n=yield Ke(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),i=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:n.map(t=>Object.assign(Object.assign({},t),{signedUrl:t.signedURL?encodeURI(`${this.url}${t.signedURL}${i}`):null})),error:null}}catch(n){if(De(n))return{data:null,error:n};throw n}})}download(t,e){return Ge(this,void 0,void 0,function*(){const s=void 0!==(null==e?void 0:e.transform)?"render/image/authenticated":"object",n=this.transformOptsToQueryString((null==e?void 0:e.transform)||{}),i=n?`?${n}`:"";try{const e=this._getFinalPath(t),n=yield ze(this.fetch,`${this.url}/${s}/${e}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield n.blob(),error:null}}catch(r){if(De(r))return{data:null,error:r};throw r}})}info(t){return Ge(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{const t=yield ze(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:Be(t),error:null}}catch(s){if(De(s))return{data:null,error:s};throw s}})}exists(t){return Ge(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{return yield function(t,e,s,n){return Fe(this,void 0,void 0,function*(){return qe(t,"HEAD",e,Object.assign(Object.assign({},s),{noResolveJson:!0}),n)})}(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(De(s)&&s instanceof Me){const t=s.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:s}}throw s}})}getPublicUrl(t,e){const s=this._getFinalPath(t),n=[],i=(null==e?void 0:e.download)?`download=${!0===e.download?"":e.download}`:"";""!==i&&n.push(i);const r=void 0!==(null==e?void 0:e.transform)?"render/image":"object",o=this.transformOptsToQueryString((null==e?void 0:e.transform)||{});""!==o&&n.push(o);let a=n.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${r}/public/${s}${a}`)}}}remove(t){return Ge(this,void 0,void 0,function*(){try{return{data:yield He(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(De(e))return{data:null,error:e};throw e}})}list(t,e,s){return Ge(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Je),e),{prefix:t||""});return{data:yield Ke(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(De(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return"undefined"!=typeof Buffer?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const Ze={"X-Client-Info":"storage-js/2.7.1"};var Qe=function(t,e,s,n){return new(s||(s=Promise))(function(i,r){function o(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n.throw(t))}catch(e){r(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class ts{constructor(t,e={},s){this.url=t,this.headers=Object.assign(Object.assign({},Ze),e),this.fetch=Ue(s)}listBuckets(){return Qe(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(De(t))return{data:null,error:t};throw t}})}getBucket(t){return Qe(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(De(e))return{data:null,error:e};throw e}})}createBucket(t,e={public:!1}){return Qe(this,void 0,void 0,function*(){try{return{data:yield Ke(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(De(s))return{data:null,error:s};throw s}})}updateBucket(t,e){return Qe(this,void 0,void 0,function*(){try{const s=yield function(t,e,s,n,i){return Fe(this,void 0,void 0,function*(){return qe(t,"PUT",e,n,i,s)})}(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers});return{data:s,error:null}}catch(s){if(De(s))return{data:null,error:s};throw s}})}emptyBucket(t){return Qe(this,void 0,void 0,function*(){try{return{data:yield Ke(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(De(e))return{data:null,error:e};throw e}})}deleteBucket(t){return Qe(this,void 0,void 0,function*(){try{return{data:yield He(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(De(e))return{data:null,error:e};throw e}})}}class es extends ts{constructor(t,e={},s){super(t,e,s)}from(t){return new Xe(this.url,this.headers,t,this.fetch)}}let ss="";ss="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const ns={headers:{"X-Client-Info":`supabase-js-${ss}/2.50.1`}},is={schema:"public"},rs={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},os={};var as=function(t,e,s,n){return new(s||(s=Promise))(function(i,r){function o(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n.throw(t))}catch(e){r(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};const ls=(t,e,s)=>{const n=(t=>{let e;return e=t||("undefined"==typeof fetch?ht:fetch),(...t)=>e(...t)})(s),i="undefined"==typeof Headers?ut:Headers;return(s,r)=>as(void 0,void 0,void 0,function*(){var o;const a=null!==(o=yield e())&&void 0!==o?o:t;let l=new i(null==r?void 0:r.headers);return l.has("apikey")||l.set("apikey",t),l.has("Authorization")||l.set("Authorization",`Bearer ${a}`),n(s,Object.assign(Object.assign({},r),{headers:l}))})};var cs=function(t,e,s,n){return new(s||(s=Promise))(function(i,r){function o(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n.throw(t))}catch(e){r(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};const hs="2.70.0",us=3e4,ds=9e4,ps={"X-Client-Info":`gotrue-js/${hs}`},fs="X-Supabase-Api-Version",ms={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},gs=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class vs extends Error{constructor(t,e,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=s}}function ys(t){return"object"==typeof t&&null!==t&&"__isAuthError"in t}class ws extends vs{constructor(t,e,s){super(t,e,s),this.name="AuthApiError",this.status=e,this.code=s}}class bs extends vs{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class _s extends vs{constructor(t,e,s,n){super(t,s,n),this.name=e,this.status=s}}class ks extends _s{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class xs extends _s{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ts extends _s{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Ss extends _s{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ps extends _s{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Es extends _s{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}}function As(t){return ys(t)&&"AuthRetryableFetchError"===t.name}class js extends _s{constructor(t,e,s){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=s}}class Cs extends _s{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Rs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Os=" \t\n\r=".split(""),Is=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Os.length;e+=1)t[Os[e].charCodeAt(0)]=-2;for(let e=0;e<Rs.length;e+=1)t[Rs[e].charCodeAt(0)]=e;return t})();function $s(t,e,s){if(null!==t)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const t=e.queue>>e.queuedBits-6&63;s(Rs[t]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const t=e.queue>>e.queuedBits-6&63;s(Rs[t]),e.queuedBits-=6}}function Ds(t,e,s){const n=Is[t];if(!(n>-1)){if(-2===n)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)s(e.queue>>e.queuedBits-8&255),e.queuedBits-=8}function Ls(t){const e=[],s=t=>{e.push(String.fromCodePoint(t))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},r=t=>{!function(t,e,s){if(0===e.utf8seq){if(t<=127)return void s(t);for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(2===e.utf8seq)e.codepoint=31&t;else if(3===e.utf8seq)e.codepoint=15&t;else{if(4!==e.utf8seq)throw new Error("Invalid UTF-8 sequence");e.codepoint=7&t}e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|63&t,e.utf8seq-=1,0===e.utf8seq&&s(e.codepoint)}}(t,n,s)};for(let o=0;o<t.length;o+=1)Ds(t.charCodeAt(o),i,r);return e.join("")}function Ms(t,e){if(!(t<=127)){if(t<=2047)return e(192|t>>6),void e(128|63&t);if(t<=65535)return e(224|t>>12),e(128|t>>6&63),void e(128|63&t);if(t<=1114111)return e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),void e(128|63&t);throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}e(t)}function Vs(t){const e=[],s={queue:0,queuedBits:0},n=t=>{e.push(t)};for(let i=0;i<t.length;i+=1)Ds(t.charCodeAt(i),s,n);return new Uint8Array(e)}function Us(t){const e=[];return function(t,e){for(let s=0;s<t.length;s+=1){let n=t.charCodeAt(s);if(n>55295&&n<=56319){const e=1024*(n-55296)&65535;n=65536+(t.charCodeAt(s+1)-56320&65535|e),s+=1}Ms(n,e)}}(t,t=>e.push(t)),new Uint8Array(e)}function Bs(t){const e=[],s={queue:0,queuedBits:0},n=t=>{e.push(t)};return t.forEach(t=>$s(t,s,n)),$s(null,s,n),e.join("")}const Fs=()=>"undefined"!=typeof window&&"undefined"!=typeof document,Ns={tested:!1,writable:!1},Ws=()=>{if(!Fs())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(Ns.tested)return Ns.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ns.tested=!0,Ns.writable=!0}catch(e){Ns.tested=!0,Ns.writable=!1}return Ns.writable};const qs=t=>{let e;return e=t||("undefined"==typeof fetch?(...t)=>c(async()=>{const{default:t}=await Promise.resolve().then(()=>ft);return{default:t}},void 0).then(({default:e})=>e(...t)):fetch),(...t)=>e(...t)},zs=async(t,e,s)=>{await t.setItem(e,JSON.stringify(s))},Ks=async(t,e)=>{const s=await t.getItem(e);if(!s)return null;try{return JSON.parse(s)}catch(n){return s}},Hs=async(t,e)=>{await t.removeItem(e)};class Gs{constructor(){this.promise=new Gs.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}function Js(t){const e=t.split(".");if(3!==e.length)throw new Cs("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!gs.test(e[s]))throw new Cs("JWT not in base64url format");return{header:JSON.parse(Ls(e[0])),payload:JSON.parse(Ls(e[1])),signature:Vs(e[2]),raw:{header:e[0],payload:e[1]}}}function Ys(t){return("0"+t.toString(16)).substr(-2)}async function Xs(t){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const e=await async function(t){const e=(new TextEncoder).encode(t),s=await crypto.subtle.digest("SHA-256",e),n=new Uint8Array(s);return Array.from(n).map(t=>String.fromCharCode(t)).join("")}(t);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Zs(t,e,s=!1){const n=function(){const t=new Uint32Array(56);if("undefined"==typeof crypto){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",e=t.length;let s="";for(let n=0;n<56;n++)s+=t.charAt(Math.floor(Math.random()*e));return s}return crypto.getRandomValues(t),Array.from(t,Ys).join("")}();let i=n;s&&(i+="/PASSWORD_RECOVERY"),await zs(t,`${e}-code-verifier`,i);const r=await Xs(n);return[r,n===r?"plain":"s256"]}Gs.promiseConstructor=Promise;const Qs=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const tn=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function en(t){if(!tn.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}const sn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),nn=[502,503,504];async function rn(t){var e,s;if(!("object"==typeof(s=t)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"==typeof s.json))throw new Es(sn(t),0);if(nn.includes(t.status))throw new Es(sn(t),t.status);let n,i;try{n=await t.json()}catch(o){throw new bs(sn(o),o)}const r=function(t){const e=t.headers.get(fs);if(!e)return null;if(!e.match(Qs))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch(o){return null}}(t);if(r&&r.getTime()>=ms.timestamp&&"object"==typeof n&&n&&"string"==typeof n.code?i=n.code:"object"==typeof n&&n&&"string"==typeof n.error_code&&(i=n.error_code),i){if("weak_password"===i)throw new js(sn(n),t.status,(null===(e=n.weak_password)||void 0===e?void 0:e.reasons)||[]);if("session_not_found"===i)throw new ks}else if("object"==typeof n&&n&&"object"==typeof n.weak_password&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((t,e)=>t&&"string"==typeof e,!0))throw new js(sn(n),t.status,n.weak_password.reasons);throw new ws(sn(n),t.status||500,i)}async function on(t,e,s,n){var i;const r=Object.assign({},null==n?void 0:n.headers);r[fs]||(r[fs]=ms.name),(null==n?void 0:n.jwt)&&(r.Authorization=`Bearer ${n.jwt}`);const o=null!==(i=null==n?void 0:n.query)&&void 0!==i?i:{};(null==n?void 0:n.redirectTo)&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await async function(t,e,s,n,i,r){const o=((t,e,s,n)=>{const i={method:t,headers:(null==e?void 0:e.headers)||{}};return"GET"===t?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==e?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),s))})(e,n,i,r);let a;try{a=await t(s,Object.assign({},o))}catch(l){throw console.error(l),new Es(sn(l),0)}a.ok||await rn(a);if(null==n?void 0:n.noResolveJson)return a;try{return await a.json()}catch(l){await rn(l)}}(t,e,s+a,{headers:r,noResolveJson:null==n?void 0:n.noResolveJson},{},null==n?void 0:n.body);return(null==n?void 0:n.xform)?null==n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}function an(t){var e;let s=null;var n;(function(t){return t.access_token&&t.refresh_token&&t.expires_in})(t)&&(s=Object.assign({},t),t.expires_at||(s.expires_at=(n=t.expires_in,Math.round(Date.now()/1e3)+n)));return{data:{session:s,user:null!==(e=t.user)&&void 0!==e?e:t},error:null}}function ln(t){const e=an(t);return!e.error&&t.weak_password&&"object"==typeof t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&"string"==typeof t.weak_password.message&&t.weak_password.reasons.reduce((t,e)=>t&&"string"==typeof e,!0)&&(e.data.weak_password=t.weak_password),e}function cn(t){var e;return{data:{user:null!==(e=t.user)&&void 0!==e?e:t},error:null}}function hn(t){return{data:t,error:null}}function un(t){const{action_link:e,email_otp:s,hashed_token:n,redirect_to:i,verification_type:r}=t,o=function(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(s[n[i]]=t[n[i]])}return s}(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:e,email_otp:s,hashed_token:n,redirect_to:i,verification_type:r},user:Object.assign({},o)},error:null}}function dn(t){return t}const pn=["global","local","others"];class fn{constructor({url:t="",headers:e={},fetch:s}){this.url=t,this.headers=e,this.fetch=qs(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,e=pn[0]){if(pn.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${pn.join(", ")}`);try{return await on(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ys(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,e={}){try{return await on(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:cn})}catch(s){if(ys(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:e}=t,s=function(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(s[n[i]]=t[n[i]])}return s}(t,["options"]),n=Object.assign(Object.assign({},s),e);return"newEmail"in s&&(n.new_email=null==s?void 0:s.newEmail,delete n.newEmail),await on(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:un,redirectTo:null==e?void 0:e.redirectTo})}catch(e){if(ys(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(t){try{return await on(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:cn})}catch(e){if(ys(e))return{data:{user:null},error:e};throw e}}async listUsers(t){var e,s,n,i,r,o,a;try{const l={nextPage:null,lastPage:0,total:0},c=await on(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(e=null==t?void 0:t.page)||void 0===e?void 0:e.toString())&&void 0!==s?s:"",per_page:null!==(i=null===(n=null==t?void 0:t.perPage)||void 0===n?void 0:n.toString())&&void 0!==i?i:""},xform:dn});if(c.error)throw c.error;const h=await c.json(),u=null!==(r=c.headers.get("x-total-count"))&&void 0!==r?r:0,d=null!==(a=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return d.length>0&&(d.forEach(t=>{const e=parseInt(t.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(t.split(";")[1].split("=")[1]);l[`${s}Page`]=e}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},h),l),error:null}}catch(l){if(ys(l))return{data:{users:[]},error:l};throw l}}async getUserById(t){en(t);try{return await on(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:cn})}catch(e){if(ys(e))return{data:{user:null},error:e};throw e}}async updateUserById(t,e){en(t);try{return await on(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:cn})}catch(s){if(ys(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,e=!1){en(t);try{return await on(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:cn})}catch(s){if(ys(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){en(t.userId);try{const{data:e,error:s}=await on(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:t=>({data:{factors:t},error:null})});return{data:e,error:s}}catch(e){if(ys(e))return{data:null,error:e};throw e}}async _deleteFactor(t){en(t.userId),en(t.id);try{return{data:await on(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(ys(e))return{data:null,error:e};throw e}}}const mn={getItem:t=>Ws()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Ws()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Ws()&&globalThis.localStorage.removeItem(t)}};function gn(t={}){return{getItem:e=>t[e]||null,setItem:(e,s)=>{t[e]=s},removeItem:e=>{delete t[e]}}}const vn=!!(globalThis&&Ws()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class yn extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class wn extends yn{}async function bn(t,e,s){vn&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),vn&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,0===e?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async n=>{if(!n){if(0===e)throw vn&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new wn(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(vn)try{const t=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(t,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}vn&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await s()}finally{vn&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(t){"undefined"!=typeof self&&(self.globalThis=self)}}();const _n={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ps,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function kn(t,e,s){return await s()}class xn{constructor(t){var e,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=xn.nextInstanceID,xn.nextInstanceID+=1,this.instanceID>0&&Fs()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},_n),t);if(this.logDebugMessages=!!n.debug,"function"==typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new fn({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=qs(n.fetch),this.lock=n.lock||kn,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Fs()&&(null===(e=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===e?void 0:e.locks)?this.lock=bn:this.lock=kn,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Ws()?this.storage=mn:(this.memoryStorage={},this.storage=gn(this.memoryStorage)):(this.memoryStorage={},this.storage=gn(this.memoryStorage)),Fs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",async t=>{this._debug("received broadcast notification from other tab or client",t),await this._notifyAllSubscribers(t.data.event,t.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${hs}) ${(new Date).toISOString()}`,...t),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var t;try{const e=function(t){const e={},s=new URL(t);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach((t,s)=>{e[s]=t})}catch(n){}return s.searchParams.forEach((t,s)=>{e[s]=t}),e}(window.location.href);let s="none";if(this._isImplicitGrantCallback(e)?s="implicit":await this._isPKCECallback(e)&&(s="pkce"),Fs()&&this.detectSessionInUrl&&"none"!==s){const{data:n,error:i}=await this._getSessionFromURL(e,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),function(t){return ys(t)&&"AuthImplicitGrantRedirectError"===t.name}(i)){const e=null===(t=i.details)||void 0===t?void 0:t.code;if("identity_already_exists"===e||"identity_not_found"===e||"single_identity_not_deletable"===e)return{error:i}}return await this._removeSession(),{error:i}}const{session:r,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",r,"redirect type",o),await this._saveSession(r),setTimeout(async()=>{"recovery"===o?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return ys(e)?{error:e}:{error:new bs("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var e,s,n;try{const i=await on(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(e=null==t?void 0:t.options)||void 0===e?void 0:e.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(n=null==t?void 0:t.options)||void 0===n?void 0:n.captchaToken}},xform:an}),{data:r,error:o}=i;if(o||!r)return{data:{user:null,session:null},error:o};const a=r.session,l=r.user;return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(i){if(ys(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var e,s,n;try{let i;if("email"in t){const{email:s,password:n,options:r}=t;let o=null,a=null;"pkce"===this.flowType&&([o,a]=await Zs(this.storage,this.storageKey)),i=await on(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==r?void 0:r.emailRedirectTo,body:{email:s,password:n,data:null!==(e=null==r?void 0:r.data)&&void 0!==e?e:{},gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},code_challenge:o,code_challenge_method:a},xform:an})}else{if(!("phone"in t))throw new Ts("You must provide either an email or phone number and a password");{const{phone:e,password:r,options:o}=t;i=await on(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:e,password:r,data:null!==(s=null==o?void 0:o.data)&&void 0!==s?s:{},channel:null!==(n=null==o?void 0:o.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:an})}}const{data:r,error:o}=i;if(o||!r)return{data:{user:null,session:null},error:o};const a=r.session,l=r.user;return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(i){if(ys(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let e;if("email"in t){const{email:s,password:n,options:i}=t;e=await on(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:ln})}else{if(!("phone"in t))throw new Ts("You must provide either an email or phone number and a password");{const{phone:s,password:n,options:i}=t;e=await on(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:ln})}}const{data:s,error:n}=e;return n?{data:{user:null,session:null},error:n}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n}):{data:{user:null,session:null},error:new xs}}catch(e){if(ys(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(t){var e,s,n,i;return await this._handleProviderSignIn(t.provider,{redirectTo:null===(e=t.options)||void 0===e?void 0:e.redirectTo,scopes:null===(s=t.options)||void 0===s?void 0:s.scopes,queryParams:null===(n=t.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(i=t.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:e}=t;if("solana"===e)return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${e}"`)}async signInWithSolana(t){var e,s,n,i,r,o,a,l,c,h,u,d;let p,f;if("message"in t)p=t.message,f=t.signature;else{const{chain:u,wallet:d,statement:m,options:g}=t;let v;if(Fs())if("object"==typeof d)v=d;else{const t=window;if(!("solana"in t)||"object"!=typeof t.solana||!("signIn"in t.solana&&"function"==typeof t.solana.signIn||"signMessage"in t.solana&&"function"==typeof t.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");v=t.solana}else{if("object"!=typeof d||!(null==g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=d}const y=new URL(null!==(e=null==g?void 0:g.url)&&void 0!==e?e:window.location.href);if("signIn"in v&&v.signIn){const t=await v.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==g?void 0:g.signInWithSolana),{version:"1",domain:y.host,uri:y.href}),m?{statement:m}:null));let e;if(Array.isArray(t)&&t[0]&&"object"==typeof t[0])e=t[0];else{if(!(t&&"object"==typeof t&&"signedMessage"in t&&"signature"in t))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");e=t}if(!("signedMessage"in e&&"signature"in e&&("string"==typeof e.signedMessage||e.signedMessage instanceof Uint8Array)&&e.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");p="string"==typeof e.signedMessage?e.signedMessage:(new TextDecoder).decode(e.signedMessage),f=e.signature}else{if(!("signMessage"in v&&"function"==typeof v.signMessage&&"publicKey"in v&&"object"==typeof v&&v.publicKey&&"toBase58"in v.publicKey&&"function"==typeof v.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${y.host} wants you to sign in with your Solana account:`,v.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${y.href}`,`Issued At: ${null!==(n=null===(s=null==g?void 0:g.signInWithSolana)||void 0===s?void 0:s.issuedAt)&&void 0!==n?n:(new Date).toISOString()}`,...(null===(i=null==g?void 0:g.signInWithSolana)||void 0===i?void 0:i.notBefore)?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...(null===(r=null==g?void 0:g.signInWithSolana)||void 0===r?void 0:r.expirationTime)?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...(null===(o=null==g?void 0:g.signInWithSolana)||void 0===o?void 0:o.chainId)?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...(null===(a=null==g?void 0:g.signInWithSolana)||void 0===a?void 0:a.nonce)?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...(null===(l=null==g?void 0:g.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...(null===(h=null===(c=null==g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===h?void 0:h.length)?["Resources",...g.signInWithSolana.resources.map(t=>`- ${t}`)]:[]].join("\n");const t=await v.signMessage((new TextEncoder).encode(p),"utf8");if(!(t&&t instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");f=t}}try{const{data:e,error:s}=await on(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:Bs(f)},(null===(u=t.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=t.options)||void 0===d?void 0:d.captchaToken}}:null),xform:an});if(s)throw s;return e&&e.session&&e.user?(e.session&&(await this._saveSession(e.session),await this._notifyAllSubscribers("SIGNED_IN",e.session)),{data:Object.assign({},e),error:s}):{data:{user:null,session:null},error:new xs}}catch(m){if(ys(m))return{data:{user:null,session:null},error:m};throw m}}async _exchangeCodeForSession(t){const e=await Ks(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(null!=e?e:"").split("/");try{const{data:e,error:i}=await on(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:an});if(await Hs(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return e&&e.session&&e.user?(e.session&&(await this._saveSession(e.session),await this._notifyAllSubscribers("SIGNED_IN",e.session)),{data:Object.assign(Object.assign({},e),{redirectType:null!=n?n:null}),error:i}):{data:{user:null,session:null,redirectType:null},error:new xs}}catch(i){if(ys(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:e,provider:s,token:n,access_token:i,nonce:r}=t,o=await on(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:r,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},xform:an}),{data:a,error:l}=o;return l?{data:{user:null,session:null},error:l}:a&&a.session&&a.user?(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:l}):{data:{user:null,session:null},error:new xs}}catch(e){if(ys(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(t){var e,s,n,i,r;try{if("email"in t){const{email:n,options:i}=t;let r=null,o=null;"pkce"===this.flowType&&([r,o]=await Zs(this.storage,this.storageKey));const{error:a}=await on(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!==(e=null==i?void 0:i.data)&&void 0!==e?e:{},create_user:null===(s=null==i?void 0:i.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:r,code_challenge_method:o},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in t){const{phone:e,options:s}=t,{data:o,error:a}=await on(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:e,data:null!==(n=null==s?void 0:s.data)&&void 0!==n?n:{},create_user:null===(i=null==s?void 0:s.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},channel:null!==(r=null==s?void 0:s.channel)&&void 0!==r?r:"sms"}});return{data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:a}}throw new Ts("You must provide either an email or phone number.")}catch(o){if(ys(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var e,s;try{let n,i;"options"in t&&(n=null===(e=t.options)||void 0===e?void 0:e.redirectTo,i=null===(s=t.options)||void 0===s?void 0:s.captchaToken);const{data:r,error:o}=await on(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:an});if(o)throw o;if(!r)throw new Error("An error occurred on token verification.");const a=r.session,l=r.user;return(null==a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==t.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(n){if(ys(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(t){var e,s,n;try{let i=null,r=null;return"pkce"===this.flowType&&([i,r]=await Zs(this.storage,this.storageKey)),await on(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:null!==(s=null===(e=t.options)||void 0===e?void 0:e.redirectTo)&&void 0!==s?s:void 0}),(null===(n=null==t?void 0:t.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:r}),headers:this.headers,xform:hn})}catch(i){if(ys(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:e},error:s}=t;if(s)throw s;if(!e)throw new ks;const{error:n}=await on(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return{data:{user:null,session:null},error:n}})}catch(t){if(ys(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const e=`${this.url}/resend`;if("email"in t){const{email:s,type:n,options:i}=t,{error:r}=await on(this.fetch,"POST",e,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:r}}if("phone"in t){const{phone:s,type:n,options:i}=t,{data:r,error:o}=await on(this.fetch,"POST",e,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null==r?void 0:r.message_id},error:o}}throw new Ts("You must provide either an email or phone number and a type")}catch(e){if(ys(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(t,e){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const t=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await t,await e()))();return this.pendingInLock.push((async()=>{try{await s}catch(t){}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const t=e();for(this.pendingInLock.push((async()=>{try{await t}catch(e){}})()),await t;this.pendingInLock.length;){const t=[...this.pendingInLock];await Promise.all(t),this.pendingInLock.splice(0,t.length)}return await t}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await t(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let t=null;const e=await Ks(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),null!==e&&(this._isValidSession(e)?t=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=!!t.expires_at&&1e3*t.expires_at-Date.now()<ds;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.storage.isServer){let e=this.suppressGetSessionWarning;t=new Proxy(t,{get:(t,s,n)=>(e||"user"!==s||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e=!0,this.suppressGetSessionWarning=!0),Reflect.get(t,s,n))})}return{data:{session:t},error:null}}const{session:n,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(t){try{return t?await on(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:cn}):await this._useSession(async t=>{var e,s,n;const{data:i,error:r}=t;if(r)throw r;return(null===(e=i.session)||void 0===e?void 0:e.access_token)||this.hasCustomAuthorizationHeader?await on(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(n=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==n?n:void 0,xform:cn}):{data:{user:null},error:new ks}})}catch(e){if(ys(e))return function(t){return ys(t)&&"AuthSessionMissingError"===t.name}(e)&&(await this._removeSession(),await Hs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(t,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,e))}async _updateUser(t,e={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new ks;const r=n.session;let o=null,a=null;"pkce"===this.flowType&&null!=t.email&&([o,a]=await Zs(this.storage,this.storageKey));const{data:l,error:c}=await on(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==e?void 0:e.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:a}),jwt:r.access_token,xform:cn});if(c)throw c;return r.user=l.user,await this._saveSession(r),await this._notifyAllSubscribers("USER_UPDATED",r),{data:{user:r.user},error:null}})}catch(s){if(ys(s))return{data:{user:null},error:s};throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ks;const e=Date.now()/1e3;let s=e,n=!0,i=null;const{payload:r}=Js(t.access_token);if(r.exp&&(s=r.exp,n=s<=e),n){const{session:e,error:s}=await this._callRefreshToken(t.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!e)return{data:{user:null,session:null},error:null};i=e}else{const{data:n,error:r}=await this._getUser(t.access_token);if(r)throw r;i={access_token:t.access_token,refresh_token:t.refresh_token,user:n.user,token_type:"bearer",expires_in:s-e,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(e){if(ys(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async e=>{var s;if(!t){const{data:n,error:i}=e;if(i)throw i;t=null!==(s=n.session)&&void 0!==s?s:void 0}if(!(null==t?void 0:t.refresh_token))throw new ks;const{session:n,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(ys(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(t,e){try{if(!Fs())throw new Ss("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Ss(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(e){case"implicit":if("pkce"===this.flowType)throw new Ps("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Ss("Not a valid implicit grant flow url.")}if("pkce"===e){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Ps("No code detected.");const{data:e,error:s}=await this._exchangeCodeForSession(t.code);if(s)throw s;const n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:e.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:r,expires_in:o,expires_at:a,token_type:l}=t;if(!(i&&o&&r&&l))throw new Ss("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(o);let u=c+h;a&&(u=parseInt(a));const d=u-c;1e3*d<=us&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${h}s`);const p=u-h;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,u,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,u,c);const{data:f,error:m}=await this._getUser(i);if(m)throw m;const g={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:u,refresh_token:r,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:t.type},error:null}}catch(s){if(ys(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(t){return Boolean(t.access_token||t.error_description)}async _isPKCECallback(t){const e=await Ks(this.storage,`${this.storageKey}-code-verifier`);return!(!t.code||!e)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async e=>{var s;const{data:n,error:i}=e;if(i)return{error:i};const r=null===(s=n.session)||void 0===s?void 0:s.access_token;if(r){const{error:e}=await this.admin.signOut(r,t);if(e&&(!function(t){return ys(t)&&"AuthApiError"===t.name}(e)||404!==e.status&&401!==e.status&&403!==e.status))return{error:e}}return"others"!==t&&(await this._removeSession(),await Hs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}),s={id:e,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})})(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async e=>{var s,n;try{const{data:{session:n},error:i}=e;if(i)throw i;await(null===(s=this.stateChangeEmitters.get(t))||void 0===s?void 0:s.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",t,"session",n)}catch(i){await(null===(n=this.stateChangeEmitters.get(t))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,e={}){let s=null,n=null;"pkce"===this.flowType&&([s,n]=await Zs(this.storage,this.storageKey,!0));try{return await on(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(i){if(ys(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:e,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(t=e.user.identities)&&void 0!==t?t:[]},error:null}}catch(e){if(ys(e))return{data:null,error:e};throw e}}async linkIdentity(t){var e;try{const{data:s,error:n}=await this._useSession(async e=>{var s,n,i,r,o;const{data:a,error:l}=e;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:null===(s=t.options)||void 0===s?void 0:s.redirectTo,scopes:null===(n=t.options)||void 0===n?void 0:n.scopes,queryParams:null===(i=t.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});return await on(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(o=null===(r=a.session)||void 0===r?void 0:r.access_token)&&void 0!==o?o:void 0})});if(n)throw n;return Fs()&&!(null===(e=t.options)||void 0===e?void 0:e.skipBrowserRedirect)&&window.location.assign(null==s?void 0:s.url),{data:{provider:t.provider,url:null==s?void 0:s.url},error:null}}catch(s){if(ys(s))return{data:{provider:t.provider,url:null},error:s};throw s}}async unlinkIdentity(t){try{return await this._useSession(async e=>{var s,n;const{data:i,error:r}=e;if(r)throw r;return await on(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:null!==(n=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==n?n:void 0})})}catch(e){if(ys(e))return{data:null,error:e};throw e}}async _refreshAccessToken(t){const e=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(e,"begin");try{const i=Date.now();return await(s=async s=>(s>0&&await async function(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}(200*Math.pow(2,s-1)),this._debug(e,"refreshing attempt",s),await on(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:an})),n=(t,e)=>{const s=200*Math.pow(2,t);return e&&As(e)&&Date.now()+s-i<us},new Promise((t,e)=>{(async()=>{for(let r=0;r<1/0;r++)try{const e=await s(r);if(!n(r,null,e))return void t(e)}catch(i){if(!n(r,i))return void e(i)}})()}))}catch(i){if(this._debug(e,"error",i),ys(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(e,"end")}var s,n}_isValidSession(t){return"object"==typeof t&&null!==t&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,e){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",e,"url",s),Fs()&&!e.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t;const e="#_recoverAndRefresh()";this._debug(e,"begin");try{const s=await Ks(this.storage,this.storageKey);if(this._debug(e,"session from storage",s),!this._isValidSession(s))return this._debug(e,"session is not valid"),void(null!==s&&await this._removeSession());const n=1e3*(null!==(t=s.expires_at)&&void 0!==t?t:1/0)-Date.now()<ds;if(this._debug(e,`session has${n?"":" not"} expired with margin of 90000s`),n){if(this.autoRefreshToken&&s.refresh_token){const{error:t}=await this._callRefreshToken(s.refresh_token);t&&(console.error(t),As(t)||(this._debug(e,"refresh failed with a non-retryable error, removing the session",t),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){return this._debug(e,"error",s),void console.error(s)}finally{this._debug(e,"end")}}async _callRefreshToken(t){var e,s;if(!t)throw new ks;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Gs;const{data:e,error:s}=await this._refreshAccessToken(t);if(s)throw s;if(!e.session)throw new ks;await this._saveSession(e.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",e.session);const n={session:e.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(i){if(this._debug(n,"error",i),ys(i)){const t={session:null,error:i};return As(i)||await this._removeSession(),null===(e=this.refreshingDeferred)||void 0===e||e.resolve(t),t}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,e,s=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",e,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:e});const n=[],i=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(t,e)}catch(i){n.push(i)}});if(await Promise.all(i),n.length>0){for(let t=0;t<n.length;t+=1)console.error(n[t]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await zs(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await Hs(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Fs()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),us);this.autoRefreshTicker=t,t&&"object"==typeof t&&"function"==typeof t.unref?t.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const n=Math.floor((1e3*s.expires_at-e)/us);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(!(t.isAcquireTimeout||t instanceof yn))throw t;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Fs()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const e=`#_onVisibilityChanged(${t})`;this._debug(e,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,e,s){const n=[`provider=${encodeURIComponent(e)}`];if((null==s?void 0:s.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null==s?void 0:s.scopes)&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){const[t,e]=await Zs(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(t)}`,code_challenge_method:`${encodeURIComponent(e)}`});n.push(s.toString())}if(null==s?void 0:s.queryParams){const t=new URLSearchParams(s.queryParams);n.push(t.toString())}return(null==s?void 0:s.skipBrowserRedirect)&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async e=>{var s;const{data:n,error:i}=e;return i?{data:null,error:i}:await on(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:null===(s=null==n?void 0:n.session)||void 0===s?void 0:s.access_token})})}catch(e){if(ys(e))return{data:null,error:e};throw e}}async _enroll(t){try{return await this._useSession(async e=>{var s,n;const{data:i,error:r}=e;if(r)return{data:null,error:r};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},"phone"===t.factorType?{phone:t.phone}:{issuer:t.issuer}),{data:a,error:l}=await on(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:null===(s=null==i?void 0:i.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:("totp"===t.factorType&&(null===(n=null==a?void 0:a.totp)||void 0===n?void 0:n.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(e){if(ys(e))return{data:null,error:e};throw e}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var s;const{data:n,error:i}=e;if(i)return{data:null,error:i};const{data:r,error:o}=await on(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:null===(s=null==n?void 0:n.session)||void 0===s?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+r.expires_in},r)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",r),{data:r,error:o})})}catch(e){if(ys(e))return{data:null,error:e};throw e}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var s;const{data:n,error:i}=e;return i?{data:null,error:i}:await on(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:null===(s=null==n?void 0:n.session)||void 0===s?void 0:s.access_token})})}catch(e){if(ys(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(t){const{data:e,error:s}=await this._challenge({factorId:t.factorId});return s?{data:null,error:s}:await this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})}async _listFactors(){const{data:{user:t},error:e}=await this.getUser();if(e)return{data:null,error:e};const s=(null==t?void 0:t.factors)||[],n=s.filter(t=>"totp"===t.factor_type&&"verified"===t.status),i=s.filter(t=>"phone"===t.factor_type&&"verified"===t.status);return{data:{all:s,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var e,s;const{data:{session:n},error:i}=t;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:r}=Js(n.access_token);let o=null;r.aal&&(o=r.aal);let a=o;(null!==(s=null===(e=n.user.factors)||void 0===e?void 0:e.filter(t=>"verified"===t.status))&&void 0!==s?s:[]).length>0&&(a="aal2");return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:r.amr||[]},error:null}}))}async fetchJwk(t,e={keys:[]}){let s=e.keys.find(e=>e.kid===t);if(s)return s;if(s=this.jwks.keys.find(e=>e.kid===t),s&&this.jwks_cached_at+6e5>Date.now())return s;const{data:n,error:i}=await on(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!n.keys||0===n.keys.length)throw new Cs("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),s=n.keys.find(e=>e.kid===t),!s)throw new Cs("No matching signing key found in JWKS");return s}async getClaims(t,e={keys:[]}){try{let s=t;if(!s){const{data:t,error:e}=await this.getSession();if(e||!t.session)return{data:null,error:e};s=t.session.access_token}const{header:n,payload:i,signature:r,raw:{header:o,payload:a}}=Js(s);if(function(t){if(!t)throw new Error("Missing exp claim");if(t<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(i.exp),!n.kid||"HS256"===n.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:t}=await this.getUser(s);if(t)throw t;return{data:{claims:i,header:n,signature:r},error:null}}const l=function(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(n.alg),c=await this.fetchJwk(n.kid,e),h=await crypto.subtle.importKey("jwk",c,l,!0,["verify"]);if(!(await crypto.subtle.verify(l,h,r,Us(`${o}.${a}`))))throw new Cs("Invalid JWT signature");return{data:{claims:i,header:n,signature:r},error:null}}catch(s){if(ys(s))return{data:null,error:s};throw s}}}xn.nextInstanceID=0;const Tn=xn;class Sn extends Tn{constructor(t){super(t)}}var Pn=function(t,e,s,n){return new(s||(s=Promise))(function(i,r){function o(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n.throw(t))}catch(e){r(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class En{constructor(t,e,s){var n,i,r;if(this.supabaseUrl=t,this.supabaseKey=e,!t)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const o=(a=t).endsWith("/")?a:a+"/";var a;const l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,h=function(t,e){var s,n;const{db:i,auth:r,realtime:o,global:a}=t,{db:l,auth:c,realtime:h,global:u}=e,d={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},c),r),realtime:Object.assign(Object.assign({},h),o),global:Object.assign(Object.assign(Object.assign({},u),a),{headers:Object.assign(Object.assign({},null!==(s=null==u?void 0:u.headers)&&void 0!==s?s:{}),null!==(n=null==a?void 0:a.headers)&&void 0!==n?n:{})}),accessToken:()=>cs(this,void 0,void 0,function*(){return""})};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}(null!=s?s:{},{db:is,realtime:os,auth:Object.assign(Object.assign({},rs),{storageKey:c}),global:ns});this.storageKey=null!==(n=h.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(i=h.global.headers)&&void 0!==i?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(t,e)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(e)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(r=h.auth)&&void 0!==r?r:{},this.headers,h.global.fetch),this.fetch=ls(e,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new qt(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new et(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new es(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},s={}){return this.rest.rpc(t,e,s)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,e;return Pn(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(e=null===(t=s.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:s,storage:n,storageKey:i,flowType:r,lock:o,debug:a},l,c){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Sn({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),l),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:s,storage:n,flowType:r,lock:o,debug:a,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Ie(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},null==t?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",null==e?void 0:e.access_token)})}_handleTokenChanged(t,e,s){"TOKEN_REFRESHED"!==t&&"SIGNED_IN"!==t||this.changedAccessToken===s?"SIGNED_OUT"===t&&(this.realtime.setAuth(),"STORAGE"==e&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=s}}const An=(t,e,s)=>new En(t,e,s),jn=t.createContext({});function Cn(e){const s=t.useRef(null);return null===s.current&&(s.current=e()),s.current}const Rn=t.createContext(null),On=t.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class In extends t.Component{getSnapshotBeforeUpdate(t){const e=this.props.childRef.current;if(e&&t.isPresent&&!this.props.isPresent){const t=this.props.sizeRef.current;t.height=e.offsetHeight||0,t.width=e.offsetWidth||0,t.top=e.offsetTop,t.left=e.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function $n({children:s,isPresent:n}){const i=t.useId(),r=t.useRef(null),o=t.useRef({width:0,height:0,top:0,left:0}),{nonce:a}=t.useContext(On);return t.useInsertionEffect(()=>{const{width:t,height:e,top:s,left:l}=o.current;if(n||!r.current||!t||!e)return;r.current.dataset.motionPopId=i;const c=document.createElement("style");return a&&(c.nonce=a),document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`\n          [data-motion-pop-id="${i}"] {\n            position: absolute !important;\n            width: ${t}px !important;\n            height: ${e}px !important;\n            top: ${s}px !important;\n            left: ${l}px !important;\n          }\n        `),()=>{document.head.removeChild(c)}},[n]),e.jsx(In,{isPresent:n,childRef:r,sizeRef:o,children:t.cloneElement(s,{ref:r})})}const Dn=({children:s,initial:n,isPresent:i,onExitComplete:r,custom:o,presenceAffectsLayout:a,mode:l})=>{const c=Cn(Ln),h=t.useId(),u=t.useCallback(t=>{c.set(t,!0);for(const e of c.values())if(!e)return;r&&r()},[c,r]),d=t.useMemo(()=>({id:h,initial:n,isPresent:i,custom:o,onExitComplete:u,register:t=>(c.set(t,!1),()=>c.delete(t))}),a?[Math.random(),u]:[i,u]);return t.useMemo(()=>{c.forEach((t,e)=>c.set(e,!1))},[i]),t.useEffect(()=>{!i&&!c.size&&r&&r()},[i]),"popLayout"===l&&(s=e.jsx($n,{isPresent:i,children:s})),e.jsx(Rn.Provider,{value:d,children:s})};function Ln(){return new Map}function Mn(e=!0){const s=t.useContext(Rn);if(null===s)return[!0,null];const{isPresent:n,onExitComplete:i,register:r}=s,o=t.useId();t.useEffect(()=>{e&&r(o)},[e]);const a=t.useCallback(()=>e&&i&&i(o),[o,i,e]);return!n&&i?[!1,a]:[!0]}const Vn=t=>t.key||"";function Un(e){const s=[];return t.Children.forEach(e,e=>{t.isValidElement(e)&&s.push(e)}),s}const Bn="undefined"!=typeof window,Fn=Bn?t.useLayoutEffect:t.useEffect,Nn=({children:s,custom:n,initial:i=!0,onExitComplete:r,presenceAffectsLayout:o=!0,mode:a="sync",propagate:l=!1})=>{const[c,h]=Mn(l),u=t.useMemo(()=>Un(s),[s]),d=l&&!c?[]:u.map(Vn),p=t.useRef(!0),f=t.useRef(u),m=Cn(()=>new Map),[g,v]=t.useState(u),[y,w]=t.useState(u);Fn(()=>{p.current=!1,f.current=u;for(let t=0;t<y.length;t++){const e=Vn(y[t]);d.includes(e)?m.delete(e):!0!==m.get(e)&&m.set(e,!1)}},[y,d.length,d.join("-")]);const b=[];if(u!==g){let t=[...u];for(let e=0;e<y.length;e++){const s=y[e],n=Vn(s);d.includes(n)||(t.splice(e,0,s),b.push(s))}return"wait"===a&&b.length&&(t=b),w(Un(t)),void v(u)}const{forceRender:_}=t.useContext(jn);return e.jsx(e.Fragment,{children:y.map(t=>{const s=Vn(t),g=!(l&&!c)&&(u===y||d.includes(s));return e.jsx(Dn,{isPresent:g,initial:!(p.current&&!i)&&void 0,custom:g?void 0:n,presenceAffectsLayout:o,mode:a,onExitComplete:g?void 0:()=>{if(!m.has(s))return;m.set(s,!0);let t=!0;m.forEach(e=>{e||(t=!1)}),t&&(null==_||_(),w(f.current),l&&(null==h||h()),r&&r())},children:t},s)})})},Wn=t=>t;let qn=Wn;function zn(t){let e;return()=>(void 0===e&&(e=t()),e)}const Kn=(t,e,s)=>{const n=e-t;return 0===n?1:(s-t)/n},Hn=t=>1e3*t,Gn=t=>t/1e3,Jn=!1;const Yn=["read","resolveKeyframes","update","preRender","render","postRender"];function Xn(t,e){let s=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},r=()=>s=!0,o=Yn.reduce((t,e)=>(t[e]=function(t){let e=new Set,s=new Set,n=!1,i=!1;const r=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(e){r.has(e)&&(l.schedule(e),t()),e(o)}const l={schedule:(t,i=!1,o=!1)=>{const a=o&&n?e:s;return i&&r.add(t),a.has(t)||a.add(t),t},cancel:t=>{s.delete(t),r.delete(t)},process:t=>{o=t,n?i=!0:(n=!0,[e,s]=[s,e],e.forEach(a),e.clear(),n=!1,i&&(i=!1,l.process(t)))}};return l}(r),t),{}),{read:a,resolveKeyframes:l,update:c,preRender:h,render:u,postRender:d}=o,p=()=>{const r=performance.now();s=!1,i.delta=n?1e3/60:Math.max(Math.min(r-i.timestamp,40),1),i.timestamp=r,i.isProcessing=!0,a.process(i),l.process(i),c.process(i),h.process(i),u.process(i),d.process(i),i.isProcessing=!1,s&&e&&(n=!1,t(p))};return{schedule:Yn.reduce((e,r)=>{const a=o[r];return e[r]=(e,r=!1,o=!1)=>(s||(s=!0,n=!0,i.isProcessing||t(p)),a.schedule(e,r,o)),e},{}),cancel:t=>{for(let e=0;e<Yn.length;e++)o[Yn[e]].cancel(t)},state:i,steps:o}}const{schedule:Zn,cancel:Qn,state:ti,steps:ei}=Xn("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:Wn,!0),si=t.createContext({strict:!1}),ni={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ii={};for(const ju in ni)ii[ju]={isEnabled:t=>ni[ju].some(e=>!!t[e])};const ri=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function oi(t){return t.startsWith("while")||t.startsWith("drag")&&"draggable"!==t||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||ri.has(t)}let ai=t=>!oi(t);try{(li=require("@emotion/is-prop-valid").default)&&(ai=t=>t.startsWith("on")?!oi(t):li(t))}catch(Au){}var li;function ci(t){if("undefined"==typeof Proxy)return t;const e=new Map;return new Proxy((...e)=>t(...e),{get:(s,n)=>"create"===n?t:(e.has(n)||e.set(n,t(n)),e.get(n))})}const hi=t.createContext({});function ui(t){return"string"==typeof t||Array.isArray(t)}function di(t){return null!==t&&"object"==typeof t&&"function"==typeof t.start}const pi=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],fi=["initial",...pi];function mi(t){return di(t.animate)||fi.some(e=>ui(t[e]))}function gi(t){return Boolean(mi(t)||t.variants)}function vi(e){const{initial:s,animate:n}=function(t,e){if(mi(t)){const{initial:e,animate:s}=t;return{initial:!1===e||ui(e)?e:void 0,animate:ui(s)?s:void 0}}return!1!==t.inherit?e:{}}(e,t.useContext(hi));return t.useMemo(()=>({initial:s,animate:n}),[yi(s),yi(n)])}function yi(t){return Array.isArray(t)?t.join(" "):t}const wi=Symbol.for("motionComponentSymbol");function bi(t){return t&&"object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"current")}function _i(e,s,n){return t.useCallback(t=>{t&&e.onMount&&e.onMount(t),s&&(t?s.mount(t):s.unmount()),n&&("function"==typeof n?n(t):bi(n)&&(n.current=t))},[s])}const ki=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),xi="data-"+ki("framerAppearId"),{schedule:Ti}=Xn(queueMicrotask,!1),Si=t.createContext({});function Pi(e,s,n,i,r){var o,a;const{visualElement:l}=t.useContext(hi),c=t.useContext(si),h=t.useContext(Rn),u=t.useContext(On).reducedMotion,d=t.useRef(null);i=i||c.renderer,!d.current&&i&&(d.current=i(e,{visualState:s,parent:l,props:n,presenceContext:h,blockInitialAnimation:!!h&&!1===h.initial,reducedMotionConfig:u}));const p=d.current,f=t.useContext(Si);!p||p.projection||!r||"html"!==p.type&&"svg"!==p.type||function(t,e,s,n){const{layoutId:i,layout:r,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=e;t.projection=new s(t.latestValues,e["data-framer-portal-id"]?void 0:Ei(t.parent)),t.projection.setOptions({layoutId:i,layout:r,alwaysMeasureLayout:Boolean(o)||a&&bi(a),visualElement:t,animationType:"string"==typeof r?r:"both",initialPromotionConfig:n,layoutScroll:l,layoutRoot:c})}(d.current,n,r,f);const m=t.useRef(!1);t.useInsertionEffect(()=>{p&&m.current&&p.update(n,h)});const g=n[xi],v=t.useRef(Boolean(g)&&!(null===(o=window.MotionHandoffIsComplete)||void 0===o?void 0:o.call(window,g))&&(null===(a=window.MotionHasOptimisedAnimation)||void 0===a?void 0:a.call(window,g)));return Fn(()=>{p&&(m.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),Ti.render(p.render),v.current&&p.animationState&&p.animationState.animateChanges())}),t.useEffect(()=>{p&&(!v.current&&p.animationState&&p.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var t;null===(t=window.MotionHandoffMarkAsComplete)||void 0===t||t.call(window,g)}),v.current=!1))}),p}function Ei(t){if(t)return!1!==t.options.allowProjection?t.projection:Ei(t.parent)}function Ai({preloadedFeatures:s,createVisualElement:n,useRender:i,useVisualState:r,Component:o}){var a,l;function c(s,a){let l;const c={...t.useContext(On),...s,layoutId:ji(s)},{isStatic:h}=c,u=vi(s),d=r(s,h);if(!h&&Bn){t.useContext(si).strict;const e=function(t){const{drag:e,layout:s}=ii;if(!e&&!s)return{};const n={...e,...s};return{MeasureLayout:(null==e?void 0:e.isEnabled(t))||(null==s?void 0:s.isEnabled(t))?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}(c);l=e.MeasureLayout,u.visualElement=Pi(o,d,c,n,e.ProjectionNode)}return e.jsxs(hi.Provider,{value:u,children:[l&&u.visualElement?e.jsx(l,{visualElement:u.visualElement,...c}):null,i(o,s,_i(d,u.visualElement,a),d,h,u.visualElement)]})}s&&function(t){for(const e in t)ii[e]={...ii[e],...t[e]}}(s),c.displayName=`motion.${"string"==typeof o?o:`create(${null!==(l=null!==(a=o.displayName)&&void 0!==a?a:o.name)&&void 0!==l?l:""})`}`;const h=t.forwardRef(c);return h[wi]=o,h}function ji({layoutId:e}){const s=t.useContext(jn).id;return s&&void 0!==e?s+"-"+e:e}const Ci=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Ri(t){return"string"==typeof t&&!t.includes("-")&&!!(Ci.indexOf(t)>-1||/[A-Z]/u.test(t))}function Oi(t){const e=[{},{}];return null==t||t.values.forEach((t,s)=>{e[0][s]=t.get(),e[1][s]=t.getVelocity()}),e}function Ii(t,e,s,n){if("function"==typeof e){const[i,r]=Oi(n);e=e(void 0!==s?s:t.custom,i,r)}if("string"==typeof e&&(e=t.variants&&t.variants[e]),"function"==typeof e){const[i,r]=Oi(n);e=e(void 0!==s?s:t.custom,i,r)}return e}const $i=t=>Array.isArray(t),Di=t=>$i(t)?t[t.length-1]||0:t,Li=t=>Boolean(t&&t.getVelocity);function Mi(t){const e=Li(t)?t.get():t;return s=e,Boolean(s&&"object"==typeof s&&s.mix&&s.toValue)?e.toValue():e;var s}const Vi=e=>(s,n)=>{const i=t.useContext(hi),r=t.useContext(Rn),o=()=>function({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:s},n,i,r){const o={latestValues:Ui(n,i,r,t),renderState:e()};return s&&(o.onMount=t=>s({props:n,current:t,...o}),o.onUpdate=t=>s(t)),o}(e,s,i,r);return n?o():Cn(o)};function Ui(t,e,s,n){const i={},r=n(t,{});for(const d in r)i[d]=Mi(r[d]);let{initial:o,animate:a}=t;const l=mi(t),c=gi(t);e&&c&&!l&&!1!==t.inherit&&(void 0===o&&(o=e.initial),void 0===a&&(a=e.animate));let h=!!s&&!1===s.initial;h=h||!1===o;const u=h?a:o;if(u&&"boolean"!=typeof u&&!di(u)){const e=Array.isArray(u)?u:[u];for(let s=0;s<e.length;s++){const n=Ii(t,e[s]);if(n){const{transitionEnd:t,transition:e,...s}=n;for(const n in s){let t=s[n];if(Array.isArray(t)){t=t[h?t.length-1:0]}null!==t&&(i[n]=t)}for(const n in t)i[n]=t[n]}}}return i}const Bi=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Fi=new Set(Bi),Ni=t=>e=>"string"==typeof e&&e.startsWith(t),Wi=Ni("--"),qi=Ni("var(--"),zi=t=>!!qi(t)&&Ki.test(t.split("/*")[0].trim()),Ki=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Hi=(t,e)=>e&&"number"==typeof t?e.transform(t):t,Gi=(t,e,s)=>s>e?e:s<t?t:s,Ji={test:t=>"number"==typeof t,parse:parseFloat,transform:t=>t},Yi={...Ji,transform:t=>Gi(0,1,t)},Xi={...Ji,default:1},Zi=t=>({test:e=>"string"==typeof e&&e.endsWith(t)&&1===e.split(" ").length,parse:parseFloat,transform:e=>`${e}${t}`}),Qi=Zi("deg"),tr=Zi("%"),er=Zi("px"),sr=Zi("vh"),nr=Zi("vw"),ir={...tr,parse:t=>tr.parse(t)/100,transform:t=>tr.transform(100*t)},rr={borderWidth:er,borderTopWidth:er,borderRightWidth:er,borderBottomWidth:er,borderLeftWidth:er,borderRadius:er,radius:er,borderTopLeftRadius:er,borderTopRightRadius:er,borderBottomRightRadius:er,borderBottomLeftRadius:er,width:er,maxWidth:er,height:er,maxHeight:er,top:er,right:er,bottom:er,left:er,padding:er,paddingTop:er,paddingRight:er,paddingBottom:er,paddingLeft:er,margin:er,marginTop:er,marginRight:er,marginBottom:er,marginLeft:er,backgroundPositionX:er,backgroundPositionY:er},or={rotate:Qi,rotateX:Qi,rotateY:Qi,rotateZ:Qi,scale:Xi,scaleX:Xi,scaleY:Xi,scaleZ:Xi,skew:Qi,skewX:Qi,skewY:Qi,distance:er,translateX:er,translateY:er,translateZ:er,x:er,y:er,z:er,perspective:er,transformPerspective:er,opacity:Yi,originX:ir,originY:ir,originZ:er},ar={...Ji,transform:Math.round},lr={...rr,...or,zIndex:ar,size:er,fillOpacity:Yi,strokeOpacity:Yi,numOctaves:ar},cr={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},hr=Bi.length;function ur(t,e,s){const{style:n,vars:i,transformOrigin:r}=t;let o=!1,a=!1;for(const l in e){const t=e[l];if(Fi.has(l))o=!0;else if(Wi(l))i[l]=t;else{const e=Hi(t,lr[l]);l.startsWith("origin")?(a=!0,r[l]=e):n[l]=e}}if(e.transform||(o||s?n.transform=function(t,e,s){let n="",i=!0;for(let r=0;r<hr;r++){const o=Bi[r],a=t[o];if(void 0===a)continue;let l=!0;if(l="number"==typeof a?a===(o.startsWith("scale")?1:0):0===parseFloat(a),!l||s){const t=Hi(a,lr[o]);l||(i=!1,n+=`${cr[o]||o}(${t}) `),s&&(e[o]=t)}}return n=n.trim(),s?n=s(e,i?"":n):i&&(n="none"),n}(e,t.transform,s):n.transform&&(n.transform="none")),a){const{originX:t="50%",originY:e="50%",originZ:s=0}=r;n.transformOrigin=`${t} ${e} ${s}`}}const dr={offset:"stroke-dashoffset",array:"stroke-dasharray"},pr={offset:"strokeDashoffset",array:"strokeDasharray"};function fr(t,e,s){return"string"==typeof t?t:er.transform(e+s*t)}function mr(t,{attrX:e,attrY:s,attrScale:n,originX:i,originY:r,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},h,u){if(ur(t,c,u),h)return void(t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox));t.attrs=t.style,t.style={};const{attrs:d,style:p,dimensions:f}=t;d.transform&&(f&&(p.transform=d.transform),delete d.transform),f&&(void 0!==i||void 0!==r||p.transform)&&(p.transformOrigin=function(t,e,s){return`${fr(e,t.x,t.width)} ${fr(s,t.y,t.height)}`}(f,void 0!==i?i:.5,void 0!==r?r:.5)),void 0!==e&&(d.x=e),void 0!==s&&(d.y=s),void 0!==n&&(d.scale=n),void 0!==o&&function(t,e,s=1,n=0,i=!0){t.pathLength=1;const r=i?dr:pr;t[r.offset]=er.transform(-n);const o=er.transform(e),a=er.transform(s);t[r.array]=`${o} ${a}`}(d,o,a,l,!1)}const gr=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),vr=()=>({style:{},transform:{},transformOrigin:{},vars:{},attrs:{}}),yr=t=>"string"==typeof t&&"svg"===t.toLowerCase();function wr(t,{style:e,vars:s},n,i){Object.assign(t.style,e,i&&i.getProjectionStyles(n));for(const r in s)t.style.setProperty(r,s[r])}const br=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function _r(t,e,s,n){wr(t,e,void 0,n);for(const i in e.attrs)t.setAttribute(br.has(i)?i:ki(i),e.attrs[i])}const kr={};function xr(t,{layout:e,layoutId:s}){return Fi.has(t)||t.startsWith("origin")||(e||void 0!==s)&&(!!kr[t]||"opacity"===t)}function Tr(t,e,s){var n;const{style:i}=t,r={};for(const o in i)(Li(i[o])||e.style&&Li(e.style[o])||xr(o,t)||void 0!==(null===(n=null==s?void 0:s.getValue(o))||void 0===n?void 0:n.liveStyle))&&(r[o]=i[o]);return r}function Sr(t,e,s){const n=Tr(t,e,s);for(const i in t)if(Li(t[i])||Li(e[i])){n[-1!==Bi.indexOf(i)?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i]=t[i]}return n}const Pr=["x","y","width","height","cx","cy","r"],Er={useVisualState:Vi({scrapeMotionValuesFromProps:Sr,createRenderState:vr,onUpdate:({props:t,prevProps:e,current:s,renderState:n,latestValues:i})=>{if(!s)return;let r=!!t.drag;if(!r)for(const a in i)if(Fi.has(a)){r=!0;break}if(!r)return;let o=!e;if(e)for(let a=0;a<Pr.length;a++){const s=Pr[a];t[s]!==e[s]&&(o=!0)}o&&Zn.read(()=>{!function(t,e){try{e.dimensions="function"==typeof t.getBBox?t.getBBox():t.getBoundingClientRect()}catch(s){e.dimensions={x:0,y:0,width:0,height:0}}}(s,n),Zn.render(()=>{mr(n,i,yr(s.tagName),t.transformTemplate),_r(s,n)})})}})},Ar={useVisualState:Vi({scrapeMotionValuesFromProps:Tr,createRenderState:gr})};function jr(t,e,s){for(const n in e)Li(e[n])||xr(n,s)||(t[n]=e[n])}function Cr(e,s){const n={};return jr(n,e.style||{},e),Object.assign(n,function({transformTemplate:e},s){return t.useMemo(()=>{const t={style:{},transform:{},transformOrigin:{},vars:{}};return ur(t,s,e),Object.assign({},t.vars,t.style)},[s])}(e,s)),n}function Rr(t,e){const s={},n=Cr(t,e);return t.drag&&!1!==t.dragListener&&(s.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=!0===t.drag?"none":"pan-"+("x"===t.drag?"y":"x")),void 0===t.tabIndex&&(t.onTap||t.onTapStart||t.whileTap)&&(s.tabIndex=0),s.style=n,s}function Or(e,s,n,i){const r=t.useMemo(()=>{const t={style:{},transform:{},transformOrigin:{},vars:{},attrs:{}};return mr(t,s,yr(i),e.transformTemplate),{...t.attrs,style:{...t.style}}},[s]);if(e.style){const t={};jr(t,e.style,e),r.style={...t,...r.style}}return r}function Ir(e=!1){return(s,n,i,{latestValues:r},o)=>{const a=(Ri(s)?Or:Rr)(n,r,o,s),l=function(t,e,s){const n={};for(const i in t)"values"===i&&"object"==typeof t.values||(ai(i)||!0===s&&oi(i)||!e&&!oi(i)||t.draggable&&i.startsWith("onDrag"))&&(n[i]=t[i]);return n}(n,"string"==typeof s,e),c=s!==t.Fragment?{...l,...a,ref:i}:{},{children:h}=n,u=t.useMemo(()=>Li(h)?h.get():h,[h]);return t.createElement(s,{...c,children:u})}}function $r(t,e){return function(s,{forwardMotionProps:n}={forwardMotionProps:!1}){return Ai({...Ri(s)?Er:Ar,preloadedFeatures:t,useRender:Ir(n),createVisualElement:e,Component:s})}}function Dr(t,e){if(!Array.isArray(e))return!1;const s=e.length;if(s!==t.length)return!1;for(let n=0;n<s;n++)if(e[n]!==t[n])return!1;return!0}function Lr(t,e,s){const n=t.getProps();return Ii(n,e,void 0!==s?s:n.custom,t)}const Mr=zn(()=>void 0!==window.ScrollTimeline);class Vr{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,e){for(let s=0;s<this.animations.length;s++)this.animations[s][t]=e}attachTimeline(t,e){const s=this.animations.map(s=>Mr()&&s.attachTimeline?s.attachTimeline(t):"function"==typeof e?e(s):void 0);return()=>{s.forEach((t,e)=>{t&&t(),this.animations[e].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let e=0;e<this.animations.length;e++)t=Math.max(t,this.animations[e].duration);return t}runAll(t){this.animations.forEach(e=>e[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Ur extends Vr{then(t,e){return Promise.all(this.animations).then(t).catch(e)}}function Br(t,e){return t?t[e]||t.default||t:void 0}const Fr=2e4;function Nr(t){let e=0;let s=t.next(e);for(;!s.done&&e<Fr;)e+=50,s=t.next(e);return e>=Fr?1/0:e}function Wr(t){return"function"==typeof t}function qr(t,e){t.timeline=e,t.onfinish=null}const zr=t=>Array.isArray(t)&&"number"==typeof t[0],Kr={linearEasing:void 0};function Hr(t,e){const s=zn(t);return()=>{var t;return null!==(t=Kr[e])&&void 0!==t?t:s()}}const Gr=Hr(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(t){return!1}return!0},"linearEasing"),Jr=(t,e,s=10)=>{let n="";const i=Math.max(Math.round(e/s),2);for(let r=0;r<i;r++)n+=t(Kn(0,i-1,r))+", ";return`linear(${n.substring(0,n.length-2)})`};function Yr(t){return Boolean("function"==typeof t&&Gr()||!t||"string"==typeof t&&(t in Zr||Gr())||zr(t)||Array.isArray(t)&&t.every(Yr))}const Xr=([t,e,s,n])=>`cubic-bezier(${t}, ${e}, ${s}, ${n})`,Zr={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Xr([0,.65,.55,1]),circOut:Xr([.55,0,1,.45]),backIn:Xr([.31,.01,.66,-.59]),backOut:Xr([.33,1.53,.69,.99])};function Qr(t,e){return t?"function"==typeof t&&Gr()?Jr(t,e):zr(t)?Xr(t):Array.isArray(t)?t.map(t=>Qr(t,e)||Zr.easeOut):Zr[t]:void 0}const to={x:!1,y:!1};function eo(){return to.x||to.y}function so(t,e){const s=function(t){if(t instanceof Element)return[t];if("string"==typeof t){const e=document.querySelectorAll(t);return e?Array.from(e):[]}return Array.from(t)}(t),n=new AbortController;return[s,{passive:!0,...e,signal:n.signal},()=>n.abort()]}function no(t){return e=>{"touch"===e.pointerType||eo()||t(e)}}const io=(t,e)=>!!e&&(t===e||io(t,e.parentElement)),ro=t=>"mouse"===t.pointerType?"number"!=typeof t.button||t.button<=0:!1!==t.isPrimary,oo=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);const ao=new WeakSet;function lo(t){return e=>{"Enter"===e.key&&t(e)}}function co(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}function ho(t){return ro(t)&&!eo()}function uo(t,e,s={}){const[n,i,r]=so(t,s),o=t=>{const n=t.currentTarget;if(!ho(t)||ao.has(n))return;ao.add(n);const r=e(t),o=(t,e)=>{window.removeEventListener("pointerup",a),window.removeEventListener("pointercancel",l),ho(t)&&ao.has(n)&&(ao.delete(n),"function"==typeof r&&r(t,{success:e}))},a=t=>{o(t,s.useGlobalTarget||io(n,t.target))},l=t=>{o(t,!1)};window.addEventListener("pointerup",a,i),window.addEventListener("pointercancel",l,i)};return n.forEach(t=>{(function(t){return oo.has(t.tagName)||-1!==t.tabIndex})(t)||null!==t.getAttribute("tabindex")||(t.tabIndex=0);(s.useGlobalTarget?window:t).addEventListener("pointerdown",o,i),t.addEventListener("focus",t=>((t,e)=>{const s=t.currentTarget;if(!s)return;const n=lo(()=>{if(ao.has(s))return;co(s,"down");const t=lo(()=>{co(s,"up")});s.addEventListener("keyup",t,e),s.addEventListener("blur",()=>co(s,"cancel"),e)});s.addEventListener("keydown",n,e),s.addEventListener("blur",()=>s.removeEventListener("keydown",n),e)})(t,i),i)}),r}const po=new Set(["width","height","top","left","right","bottom",...Bi]);let fo;function mo(){fo=void 0}const go={now:()=>(void 0===fo&&go.set(ti.isProcessing||Jn?ti.timestamp:performance.now()),fo),set:t=>{fo=t,queueMicrotask(mo)}};function vo(t,e){-1===t.indexOf(e)&&t.push(e)}function yo(t,e){const s=t.indexOf(e);s>-1&&t.splice(s,1)}class wo{constructor(){this.subscriptions=[]}add(t){return vo(this.subscriptions,t),()=>yo(this.subscriptions,t)}notify(t,e,s){const n=this.subscriptions.length;if(n)if(1===n)this.subscriptions[0](t,e,s);else for(let i=0;i<n;i++){const n=this.subscriptions[i];n&&n(t,e,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function bo(t,e){return e?t*(1e3/e):0}class _o{constructor(t,e={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(t,e=!0)=>{const s=go.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(t),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),e&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=e.owner}setCurrent(t){var e;this.current=t,this.updatedAt=go.now(),null===this.canTrackVelocity&&void 0!==t&&(this.canTrackVelocity=(e=this.current,!isNaN(parseFloat(e))))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,e){this.events[t]||(this.events[t]=new wo);const s=this.events[t].add(e);return"change"===t?()=>{s(),Zn.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,e){this.passiveEffect=t,this.stopPassiveEffect=e}set(t,e=!0){e&&this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t,e)}setWithVelocity(t,e,s){this.set(e),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-s}jump(t,e=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,e&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=go.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||t-this.updatedAt>30)return 0;const e=Math.min(this.updatedAt-this.prevUpdatedAt,30);return bo(parseFloat(this.current)-parseFloat(this.prevFrameValue),e)}start(t){return this.stop(),new Promise(e=>{this.hasAnimated=!0,this.animation=t(e),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ko(t,e){return new _o(t,e)}function xo(t,e,s){t.hasValue(e)?t.getValue(e).set(s):t.addValue(e,ko(s))}function To(t,e){const s=t.getValue("willChange");if(n=s,Boolean(Li(n)&&n.add))return s.add(e);var n}function So(t){return t.props[xi]}const Po=(t,e,s)=>(((1-3*s+3*e)*t+(3*s-6*e))*t+3*e)*t;function Eo(t,e,s,n){if(t===e&&s===n)return Wn;const i=e=>function(t,e,s,n,i){let r,o,a=0;do{o=e+(s-e)/2,r=Po(o,n,i)-t,r>0?s=o:e=o}while(Math.abs(r)>1e-7&&++a<12);return o}(e,0,1,t,s);return t=>0===t||1===t?t:Po(i(t),e,n)}const Ao=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,jo=t=>e=>1-t(1-e),Co=Eo(.33,1.53,.69,.99),Ro=jo(Co),Oo=Ao(Ro),Io=t=>(t*=2)<1?.5*Ro(t):.5*(2-Math.pow(2,-10*(t-1))),$o=t=>1-Math.sin(Math.acos(t)),Do=jo($o),Lo=Ao($o),Mo=t=>/^0[^.\s]+$/u.test(t);function Vo(t){return"number"==typeof t?0===t:null===t||("none"===t||"0"===t||Mo(t))}const Uo=t=>Math.round(1e5*t)/1e5,Bo=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;const Fo=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,No=(t,e)=>s=>Boolean("string"==typeof s&&Fo.test(s)&&s.startsWith(t)||e&&!function(t){return null==t}(s)&&Object.prototype.hasOwnProperty.call(s,e)),Wo=(t,e,s)=>n=>{if("string"!=typeof n)return n;const[i,r,o,a]=n.match(Bo);return{[t]:parseFloat(i),[e]:parseFloat(r),[s]:parseFloat(o),alpha:void 0!==a?parseFloat(a):1}},qo={...Ji,transform:t=>Math.round((t=>Gi(0,255,t))(t))},zo={test:No("rgb","red"),parse:Wo("red","green","blue"),transform:({red:t,green:e,blue:s,alpha:n=1})=>"rgba("+qo.transform(t)+", "+qo.transform(e)+", "+qo.transform(s)+", "+Uo(Yi.transform(n))+")"};const Ko={test:No("#"),parse:function(t){let e="",s="",n="",i="";return t.length>5?(e=t.substring(1,3),s=t.substring(3,5),n=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),s=t.substring(2,3),n=t.substring(3,4),i=t.substring(4,5),e+=e,s+=s,n+=n,i+=i),{red:parseInt(e,16),green:parseInt(s,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}},transform:zo.transform},Ho={test:No("hsl","hue"),parse:Wo("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:s,alpha:n=1})=>"hsla("+Math.round(t)+", "+tr.transform(Uo(e))+", "+tr.transform(Uo(s))+", "+Uo(Yi.transform(n))+")"},Go={test:t=>zo.test(t)||Ko.test(t)||Ho.test(t),parse:t=>zo.test(t)?zo.parse(t):Ho.test(t)?Ho.parse(t):Ko.parse(t),transform:t=>"string"==typeof t?t:t.hasOwnProperty("red")?zo.transform(t):Ho.transform(t)},Jo=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;const Yo="number",Xo="color",Zo=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Qo(t){const e=t.toString(),s=[],n={color:[],number:[],var:[]},i=[];let r=0;const o=e.replace(Zo,t=>(Go.test(t)?(n.color.push(r),i.push(Xo),s.push(Go.parse(t))):t.startsWith("var(")?(n.var.push(r),i.push("var"),s.push(t)):(n.number.push(r),i.push(Yo),s.push(parseFloat(t))),++r,"${}")).split("${}");return{values:s,split:o,indexes:n,types:i}}function ta(t){return Qo(t).values}function ea(t){const{split:e,types:s}=Qo(t),n=e.length;return t=>{let i="";for(let r=0;r<n;r++)if(i+=e[r],void 0!==t[r]){const e=s[r];i+=e===Yo?Uo(t[r]):e===Xo?Go.transform(t[r]):t[r]}return i}}const sa=t=>"number"==typeof t?0:t;const na={test:function(t){var e,s;return isNaN(t)&&"string"==typeof t&&((null===(e=t.match(Bo))||void 0===e?void 0:e.length)||0)+((null===(s=t.match(Jo))||void 0===s?void 0:s.length)||0)>0},parse:ta,createTransformer:ea,getAnimatableNone:function(t){const e=ta(t);return ea(t)(e.map(sa))}},ia=new Set(["brightness","contrast","saturate","opacity"]);function ra(t){const[e,s]=t.slice(0,-1).split("(");if("drop-shadow"===e)return t;const[n]=s.match(Bo)||[];if(!n)return t;const i=s.replace(n,"");let r=ia.has(e)?1:0;return n!==s&&(r*=100),e+"("+r+i+")"}const oa=/\b([a-z-]*)\(.*?\)/gu,aa={...na,getAnimatableNone:t=>{const e=t.match(oa);return e?e.map(ra).join(" "):t}},la={...lr,color:Go,backgroundColor:Go,outlineColor:Go,fill:Go,stroke:Go,borderColor:Go,borderTopColor:Go,borderRightColor:Go,borderBottomColor:Go,borderLeftColor:Go,filter:aa,WebkitFilter:aa},ca=t=>la[t];function ha(t,e){let s=ca(t);return s!==aa&&(s=na),s.getAnimatableNone?s.getAnimatableNone(e):void 0}const ua=new Set(["auto","none","0"]);const da=t=>t===Ji||t===er,pa=(t,e)=>parseFloat(t.split(", ")[e]),fa=(t,e)=>(s,{transform:n})=>{if("none"===n||!n)return 0;const i=n.match(/^matrix3d\((.+)\)$/u);if(i)return pa(i[1],e);{const e=n.match(/^matrix\((.+)\)$/u);return e?pa(e[1],t):0}},ma=new Set(["x","y","z"]),ga=Bi.filter(t=>!ma.has(t));const va={width:({x:t},{paddingLeft:e="0",paddingRight:s="0"})=>t.max-t.min-parseFloat(e)-parseFloat(s),height:({y:t},{paddingTop:e="0",paddingBottom:s="0"})=>t.max-t.min-parseFloat(e)-parseFloat(s),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:fa(4,13),y:fa(5,14)};va.translateX=va.x,va.translateY=va.y;const ya=new Set;let wa=!1,ba=!1;function _a(){if(ba){const t=Array.from(ya).filter(t=>t.needsMeasurement),e=new Set(t.map(t=>t.element)),s=new Map;e.forEach(t=>{const e=function(t){const e=[];return ga.forEach(s=>{const n=t.getValue(s);void 0!==n&&(e.push([s,n.get()]),n.set(s.startsWith("scale")?1:0))}),e}(t);e.length&&(s.set(t,e),t.render())}),t.forEach(t=>t.measureInitialState()),e.forEach(t=>{t.render();const e=s.get(t);e&&e.forEach(([e,s])=>{var n;null===(n=t.getValue(e))||void 0===n||n.set(s)})}),t.forEach(t=>t.measureEndState()),t.forEach(t=>{void 0!==t.suspendedScrollY&&window.scrollTo(0,t.suspendedScrollY)})}ba=!1,wa=!1,ya.forEach(t=>t.complete()),ya.clear()}function ka(){ya.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(ba=!0)})}class xa{constructor(t,e,s,n,i,r=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=e,this.name=s,this.motionValue=n,this.element=i,this.isAsync=r}scheduleResolve(){this.isScheduled=!0,this.isAsync?(ya.add(this),wa||(wa=!0,Zn.read(ka),Zn.resolveKeyframes(_a))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:e,element:s,motionValue:n}=this;for(let i=0;i<t.length;i++)if(null===t[i])if(0===i){const i=null==n?void 0:n.get(),r=t[t.length-1];if(void 0!==i)t[0]=i;else if(s&&e){const n=s.readValue(e,r);null!=n&&(t[0]=n)}void 0===t[0]&&(t[0]=r),n&&void 0===i&&n.set(t[0])}else t[i]=t[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),ya.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,ya.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Ta=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),Sa=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Pa(t,e,s=1){const[n,i]=function(t){const e=Sa.exec(t);if(!e)return[,];const[,s,n,i]=e;return[`--${null!=s?s:n}`,i]}(t);if(!n)return;const r=window.getComputedStyle(e).getPropertyValue(n);if(r){const t=r.trim();return Ta(t)?parseFloat(t):t}return zi(i)?Pa(i,e,s+1):i}const Ea=t=>e=>e.test(t),Aa=[Ji,er,tr,Qi,nr,sr,{test:t=>"auto"===t,parse:t=>t}],ja=t=>Aa.find(Ea(t));class Ca extends xa{constructor(t,e,s,n,i){super(t,e,s,n,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:e,name:s}=this;if(!e||!e.current)return;super.readKeyframes();for(let a=0;a<t.length;a++){let s=t[a];if("string"==typeof s&&(s=s.trim(),zi(s))){const n=Pa(s,e.current);void 0!==n&&(t[a]=n),a===t.length-1&&(this.finalKeyframe=s)}}if(this.resolveNoneKeyframes(),!po.has(s)||2!==t.length)return;const[n,i]=t,r=ja(n),o=ja(i);if(r!==o)if(da(r)&&da(o))for(let a=0;a<t.length;a++){const e=t[a];"string"==typeof e&&(t[a]=parseFloat(e))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:e}=this,s=[];for(let n=0;n<t.length;n++)Vo(t[n])&&s.push(n);s.length&&function(t,e,s){let n,i=0;for(;i<t.length&&!n;){const e=t[i];"string"==typeof e&&!ua.has(e)&&Qo(e).values.length&&(n=t[i]),i++}if(n&&s)for(const r of e)t[r]=ha(s,n)}(t,s,e)}measureInitialState(){const{element:t,unresolvedKeyframes:e,name:s}=this;if(!t||!t.current)return;"height"===s&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=va[s](t.measureViewportBox(),window.getComputedStyle(t.current)),e[0]=this.measuredOrigin;const n=e[e.length-1];void 0!==n&&t.getValue(s,n).jump(n,!1)}measureEndState(){var t;const{element:e,name:s,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const i=e.getValue(s);i&&i.jump(this.measuredOrigin,!1);const r=n.length-1,o=n[r];n[r]=va[s](e.measureViewportBox(),window.getComputedStyle(e.current)),null!==o&&void 0===this.finalKeyframe&&(this.finalKeyframe=o),(null===(t=this.removedTransforms)||void 0===t?void 0:t.length)&&this.removedTransforms.forEach(([t,s])=>{e.getValue(t).set(s)}),this.resolveNoneKeyframes()}}const Ra=(t,e)=>"zIndex"!==e&&(!("number"!=typeof t&&!Array.isArray(t))||!("string"!=typeof t||!na.test(t)&&"0"!==t||t.startsWith("url(")));const Oa=t=>null!==t;function Ia(t,{repeat:e,repeatType:s="loop"},n){const i=t.filter(Oa),r=e&&"loop"!==s&&e%2==1?0:i.length-1;return r&&void 0!==n?n:i[r]}class $a{constructor({autoplay:t=!0,delay:e=0,type:s="keyframes",repeat:n=0,repeatDelay:i=0,repeatType:r="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=go.now(),this.options={autoplay:t,delay:e,type:s,repeat:n,repeatDelay:i,repeatType:r,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt}get resolved(){return this._resolved||this.hasAttemptedResolve||(ka(),_a()),this._resolved}onKeyframesResolved(t,e){this.resolvedAt=go.now(),this.hasAttemptedResolve=!0;const{name:s,type:n,velocity:i,delay:r,onComplete:o,onUpdate:a,isGenerator:l}=this.options;if(!l&&!function(t,e,s,n){const i=t[0];if(null===i)return!1;if("display"===e||"visibility"===e)return!0;const r=t[t.length-1],o=Ra(i,e),a=Ra(r,e);return!(!o||!a)&&(function(t){const e=t[0];if(1===t.length)return!0;for(let s=0;s<t.length;s++)if(t[s]!==e)return!0}(t)||("spring"===s||Wr(s))&&n)}(t,s,n,i)){if(!r)return a&&a(Ia(t,this.options,e)),o&&o(),void this.resolveFinishedPromise();this.options.duration=0}const c=this.initPlayback(t,e);!1!==c&&(this._resolved={keyframes:t,finalKeyframe:e,...c},this.onPostResolved())}onPostResolved(){}then(t,e){return this.currentFinishedPromise.then(t,e)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const Da=(t,e,s)=>t+(e-t)*s;function La(t,e,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+6*(e-t)*s:s<.5?e:s<2/3?t+(e-t)*(2/3-s)*6:t}function Ma(t,e){return s=>s>0?e:t}const Va=(t,e,s)=>{const n=t*t,i=s*(e*e-n)+n;return i<0?0:Math.sqrt(i)},Ua=[Ko,zo,Ho];function Ba(t){const e=(s=t,Ua.find(t=>t.test(s)));var s;if(!Boolean(e))return!1;let n=e.parse(t);return e===Ho&&(n=function({hue:t,saturation:e,lightness:s,alpha:n}){t/=360,s/=100;let i=0,r=0,o=0;if(e/=100){const n=s<.5?s*(1+e):s+e-s*e,a=2*s-n;i=La(a,n,t+1/3),r=La(a,n,t),o=La(a,n,t-1/3)}else i=r=o=s;return{red:Math.round(255*i),green:Math.round(255*r),blue:Math.round(255*o),alpha:n}}(n)),n}const Fa=(t,e)=>{const s=Ba(t),n=Ba(e);if(!s||!n)return Ma(t,e);const i={...s};return t=>(i.red=Va(s.red,n.red,t),i.green=Va(s.green,n.green,t),i.blue=Va(s.blue,n.blue,t),i.alpha=Da(s.alpha,n.alpha,t),zo.transform(i))},Na=(t,e)=>s=>e(t(s)),Wa=(...t)=>t.reduce(Na),qa=new Set(["none","hidden"]);function za(t,e){return s=>Da(t,e,s)}function Ka(t){return"number"==typeof t?za:"string"==typeof t?zi(t)?Ma:Go.test(t)?Fa:Ja:Array.isArray(t)?Ha:"object"==typeof t?Go.test(t)?Fa:Ga:Ma}function Ha(t,e){const s=[...t],n=s.length,i=t.map((t,s)=>Ka(t)(t,e[s]));return t=>{for(let e=0;e<n;e++)s[e]=i[e](t);return s}}function Ga(t,e){const s={...t,...e},n={};for(const i in s)void 0!==t[i]&&void 0!==e[i]&&(n[i]=Ka(t[i])(t[i],e[i]));return t=>{for(const e in n)s[e]=n[e](t);return s}}const Ja=(t,e)=>{const s=na.createTransformer(e),n=Qo(t),i=Qo(e);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?qa.has(t)&&!i.values.length||qa.has(e)&&!n.values.length?function(t,e){return qa.has(t)?s=>s<=0?t:e:s=>s>=1?e:t}(t,e):Wa(Ha(function(t,e){var s;const n=[],i={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const o=e.types[r],a=t.indexes[o][i[o]],l=null!==(s=t.values[a])&&void 0!==s?s:0;n[r]=l,i[o]++}return n}(n,i),i.values),s):Ma(t,e)};function Ya(t,e,s){if("number"==typeof t&&"number"==typeof e&&"number"==typeof s)return Da(t,e,s);return Ka(t)(t,e)}function Xa(t,e,s){const n=Math.max(e-5,0);return bo(s-t(n),e-n)}const Za=100,Qa=10,tl=1,el=0,sl=800,nl=.3,il=.3,rl={granular:.01,default:2},ol={granular:.005,default:.5},al=.01,ll=10,cl=.05,hl=1,ul=.001;function dl({duration:t=sl,bounce:e=nl,velocity:s=el,mass:n=tl}){let i,r,o=1-e;o=Gi(cl,hl,o),t=Gi(al,ll,Gn(t)),o<1?(i=e=>{const n=e*o,i=n*t,r=n-s,a=fl(e,o),l=Math.exp(-i);return ul-r/a*l},r=e=>{const n=e*o*t,r=n*s+s,a=Math.pow(o,2)*Math.pow(e,2)*t,l=Math.exp(-n),c=fl(Math.pow(e,2),o);return(-i(e)+ul>0?-1:1)*((r-a)*l)/c}):(i=e=>Math.exp(-e*t)*((e-s)*t+1)-.001,r=e=>Math.exp(-e*t)*(t*t*(s-e)));const a=function(t,e,s){let n=s;for(let i=1;i<pl;i++)n-=t(n)/e(n);return n}(i,r,5/t);if(t=Hn(t),isNaN(a))return{stiffness:Za,damping:Qa,duration:t};{const e=Math.pow(a,2)*n;return{stiffness:e,damping:2*o*Math.sqrt(n*e),duration:t}}}const pl=12;function fl(t,e){return t*Math.sqrt(1-e*e)}const ml=["duration","bounce"],gl=["stiffness","damping","mass"];function vl(t,e){return e.some(e=>void 0!==t[e])}function yl(t=il,e=nl){const s="object"!=typeof t?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:i}=s;const r=s.keyframes[0],o=s.keyframes[s.keyframes.length-1],a={done:!1,value:r},{stiffness:l,damping:c,mass:h,duration:u,velocity:d,isResolvedFromDuration:p}=function(t){let e={velocity:el,stiffness:Za,damping:Qa,mass:tl,isResolvedFromDuration:!1,...t};if(!vl(t,gl)&&vl(t,ml))if(t.visualDuration){const s=t.visualDuration,n=2*Math.PI/(1.2*s),i=n*n,r=2*Gi(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:tl,stiffness:i,damping:r}}else{const s=dl(t);e={...e,...s,mass:tl},e.isResolvedFromDuration=!0}return e}({...s,velocity:-Gn(s.velocity||0)}),f=d||0,m=c/(2*Math.sqrt(l*h)),g=o-r,v=Gn(Math.sqrt(l/h)),y=Math.abs(g)<5;let w;if(n||(n=y?rl.granular:rl.default),i||(i=y?ol.granular:ol.default),m<1){const t=fl(v,m);w=e=>{const s=Math.exp(-m*v*e);return o-s*((f+m*v*g)/t*Math.sin(t*e)+g*Math.cos(t*e))}}else if(1===m)w=t=>o-Math.exp(-v*t)*(g+(f+v*g)*t);else{const t=v*Math.sqrt(m*m-1);w=e=>{const s=Math.exp(-m*v*e),n=Math.min(t*e,300);return o-s*((f+m*v*g)*Math.sinh(n)+t*g*Math.cosh(n))/t}}const b={calculatedDuration:p&&u||null,next:t=>{const e=w(t);if(p)a.done=t>=u;else{let s=0;m<1&&(s=0===t?Hn(f):Xa(w,t,e));const r=Math.abs(s)<=n,l=Math.abs(o-e)<=i;a.done=r&&l}return a.value=a.done?o:e,a},toString:()=>{const t=Math.min(Nr(b),Fr),e=Jr(e=>b.next(t*e).value,t,30);return t+"ms "+e}};return b}function wl({keyframes:t,velocity:e=0,power:s=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:r=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:h}){const u=t[0],d={done:!1,value:u},p=t=>void 0===a?l:void 0===l||Math.abs(a-t)<Math.abs(l-t)?a:l;let f=s*e;const m=u+f,g=void 0===o?m:o(m);g!==m&&(f=g-u);const v=t=>-f*Math.exp(-t/n),y=t=>g+v(t),w=t=>{const e=v(t),s=y(t);d.done=Math.abs(e)<=c,d.value=d.done?g:s};let b,_;const k=t=>{var e;(e=d.value,void 0!==a&&e<a||void 0!==l&&e>l)&&(b=t,_=yl({keyframes:[d.value,p(d.value)],velocity:Xa(y,t,d.value),damping:i,stiffness:r,restDelta:c,restSpeed:h}))};return k(0),{calculatedDuration:null,next:t=>{let e=!1;return _||void 0!==b||(e=!0,w(t),k(t)),void 0!==b&&t>=b?_.next(t-b):(!e&&w(t),d)}}}const bl=Eo(.42,0,1,1),_l=Eo(0,0,.58,1),kl=Eo(.42,0,.58,1),xl={linear:Wn,easeIn:bl,easeInOut:kl,easeOut:_l,circIn:$o,circInOut:Lo,circOut:Do,backIn:Ro,backInOut:Oo,backOut:Co,anticipate:Io},Tl=t=>{if(zr(t)){qn(4===t.length);const[e,s,n,i]=t;return Eo(e,s,n,i)}return"string"==typeof t?xl[t]:t};function Sl(t,e,{clamp:s=!0,ease:n,mixer:i}={}){const r=t.length;if(qn(r===e.length),1===r)return()=>e[0];if(2===r&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[r-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=function(t,e,s){const n=[],i=s||Ya,r=t.length-1;for(let o=0;o<r;o++){let s=i(t[o],t[o+1]);if(e){const t=Array.isArray(e)?e[o]||Wn:e;s=Wa(t,s)}n.push(s)}return n}(e,n,i),l=a.length,c=s=>{if(o&&s<t[0])return e[0];let n=0;if(l>1)for(;n<t.length-2&&!(s<t[n+1]);n++);const i=Kn(t[n],t[n+1],s);return a[n](i)};return s?e=>c(Gi(t[0],t[r-1],e)):c}function Pl(t){const e=[0];return function(t,e){const s=t[t.length-1];for(let n=1;n<=e;n++){const i=Kn(0,e,n);t.push(Da(s,1,i))}}(e,t.length-1),e}function El({duration:t=300,keyframes:e,times:s,ease:n="easeInOut"}){const i=(t=>Array.isArray(t)&&"number"!=typeof t[0])(n)?n.map(Tl):Tl(n),r={done:!1,value:e[0]},o=function(t,e){return t.map(t=>t*e)}(s&&s.length===e.length?s:Pl(e),t),a=Sl(o,e,{ease:Array.isArray(i)?i:(l=e,c=i,l.map(()=>c||kl).splice(0,l.length-1))});var l,c;return{calculatedDuration:t,next:e=>(r.value=a(e),r.done=e>=t,r)}}const Al=t=>{const e=({timestamp:e})=>t(e);return{start:()=>Zn.update(e,!0),stop:()=>Qn(e),now:()=>ti.isProcessing?ti.timestamp:go.now()}},jl={decay:wl,inertia:wl,tween:El,keyframes:El,spring:yl},Cl=t=>t/100;class Rl extends $a{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.teardown();const{onStop:t}=this.options;t&&t()};const{name:e,motionValue:s,element:n,keyframes:i}=this.options,r=(null==n?void 0:n.KeyframeResolver)||xa;this.resolver=new r(i,(t,e)=>this.onKeyframesResolved(t,e),e,s,n),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:e="keyframes",repeat:s=0,repeatDelay:n=0,repeatType:i,velocity:r=0}=this.options,o=Wr(e)?e:jl[e]||El;let a,l;o!==El&&"number"!=typeof t[0]&&(a=Wa(Cl,Ya(t[0],t[1])),t=[0,100]);const c=o({...this.options,keyframes:t});"mirror"===i&&(l=o({...this.options,keyframes:[...t].reverse(),velocity:-r})),null===c.calculatedDuration&&(c.calculatedDuration=Nr(c));const{calculatedDuration:h}=c,u=h+n;return{generator:c,mirroredGenerator:l,mapPercentToKeyframes:a,calculatedDuration:h,resolvedDuration:u,totalDuration:u*(s+1)-n}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),"paused"!==this.pendingPlayState&&t?this.state=this.pendingPlayState:this.pause()}tick(t,e=!1){const{resolved:s}=this;if(!s){const{keyframes:t}=this.options;return{done:!0,value:t[t.length-1]}}const{finalKeyframe:n,generator:i,mirroredGenerator:r,mapPercentToKeyframes:o,keyframes:a,calculatedDuration:l,totalDuration:c,resolvedDuration:h}=s;if(null===this.startTime)return i.next(0);const{delay:u,repeat:d,repeatType:p,repeatDelay:f,onUpdate:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-c/this.speed,this.startTime)),e?this.currentTime=t:null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const g=this.currentTime-u*(this.speed>=0?1:-1),v=this.speed>=0?g<0:g>c;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=c);let y=this.currentTime,w=i;if(d){const t=Math.min(this.currentTime,c)/h;let e=Math.floor(t),s=t%1;!s&&t>=1&&(s=1),1===s&&e--,e=Math.min(e,d+1);Boolean(e%2)&&("reverse"===p?(s=1-s,f&&(s-=f/h)):"mirror"===p&&(w=r)),y=Gi(0,1,s)*h}const b=v?{done:!1,value:a[0]}:w.next(y);o&&(b.value=o(b.value));let{done:_}=b;v||null===l||(_=this.speed>=0?this.currentTime>=c:this.currentTime<=0);const k=null===this.holdTime&&("finished"===this.state||"running"===this.state&&_);return k&&void 0!==n&&(b.value=Ia(a,this.options,n)),m&&m(b.value),k&&this.finish(),b}get duration(){const{resolved:t}=this;return t?Gn(t.calculatedDuration):0}get time(){return Gn(this.currentTime)}set time(t){t=Hn(t),this.currentTime=t,null!==this.holdTime||0===this.speed?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const e=this.playbackSpeed!==t;this.playbackSpeed=t,e&&(this.time=Gn(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved)return void(this.pendingPlayState="running");if(this.isStopped)return;const{driver:t=Al,onPlay:e,startTime:s}=this.options;this.driver||(this.driver=t(t=>this.tick(t))),e&&e();const n=this.driver.now();null!==this.holdTime?this.startTime=n-this.holdTime:this.startTime?"finished"===this.state&&(this.startTime=n):this.startTime=null!=s?s:this.calcStartTime(),"finished"===this.state&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;this._resolved?(this.state="paused",this.holdTime=null!==(t=this.currentTime)&&void 0!==t?t:0):this.pendingPlayState="paused"}complete(){"running"!==this.state&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){null!==this.cancelTime&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const Ol=new Set(["opacity","clipPath","filter","transform"]);function Il(t,e,s,{delay:n=0,duration:i=300,repeat:r=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){const c={[e]:s};l&&(c.offset=l);const h=Qr(a,i);return Array.isArray(h)&&(c.easing=h),t.animate(c,{delay:n,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:r+1,direction:"reverse"===o?"alternate":"normal"})}const $l=zn(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));const Dl={anticipate:Io,backInOut:Oo,circInOut:Lo};class Ll extends $a{constructor(t){super(t);const{name:e,motionValue:s,element:n,keyframes:i}=this.options;this.resolver=new Ca(i,(t,e)=>this.onKeyframesResolved(t,e),e,s,n),this.resolver.scheduleResolve()}initPlayback(t,e){let{duration:s=300,times:n,ease:i,type:r,motionValue:o,name:a,startTime:l}=this.options;if(!o.owner||!o.owner.current)return!1;var c;if("string"==typeof i&&Gr()&&i in Dl&&(i=Dl[i]),Wr((c=this.options).type)||"spring"===c.type||!Yr(c.ease)){const{onComplete:e,onUpdate:o,motionValue:a,element:l,...c}=this.options,h=function(t,e){const s=new Rl({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:t[0]};const i=[];let r=0;for(;!n.done&&r<2e4;)n=s.sample(r),i.push(n.value),r+=10;return{times:void 0,keyframes:i,duration:r-10,ease:"linear"}}(t,c);1===(t=h.keyframes).length&&(t[1]=t[0]),s=h.duration,n=h.times,i=h.ease,r="keyframes"}const h=Il(o.owner.current,a,t,{...this.options,duration:s,times:n,ease:i});return h.startTime=null!=l?l:this.calcStartTime(),this.pendingTimeline?(qr(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:s}=this.options;o.set(Ia(t,this.options,e)),s&&s(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:s,times:n,type:r,ease:i,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:e}=t;return Gn(e)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:e}=t;return Gn(e.currentTime||0)}set time(t){const{resolved:e}=this;if(!e)return;const{animation:s}=e;s.currentTime=Hn(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:e}=t;return e.playbackRate}set speed(t){const{resolved:e}=this;if(!e)return;const{animation:s}=e;s.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:e}=t;return e.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:e}=t;return e.startTime}attachTimeline(t){if(this._resolved){const{resolved:e}=this;if(!e)return Wn;const{animation:s}=e;qr(s,t)}else this.pendingTimeline=t;return Wn}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:e}=t;"finished"===e.playState&&this.updateFinishedPromise(),e.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:e}=t;e.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:e,keyframes:s,duration:n,type:i,ease:r,times:o}=t;if("idle"===e.playState||"finished"===e.playState)return;if(this.time){const{motionValue:t,onUpdate:e,onComplete:a,element:l,...c}=this.options,h=new Rl({...c,keyframes:s,duration:n,type:i,ease:r,times:o,isGenerator:!0}),u=Hn(this.time);t.setWithVelocity(h.sample(u-10).value,h.sample(u).value,10)}const{onStop:a}=this.options;a&&a(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:e,name:s,repeatDelay:n,repeatType:i,damping:r,type:o}=t;if(!(e&&e.owner&&e.owner.current instanceof HTMLElement))return!1;const{onUpdate:a,transformTemplate:l}=e.owner.getProps();return $l()&&s&&Ol.has(s)&&!a&&!l&&!n&&"mirror"!==i&&0!==r&&"inertia"!==o}}const Ml={type:"spring",stiffness:500,damping:25,restSpeed:10},Vl={type:"keyframes",duration:.8},Ul={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Bl=(t,{keyframes:e})=>e.length>2?Vl:Fi.has(t)?t.startsWith("scale")?{type:"spring",stiffness:550,damping:0===e[1]?2*Math.sqrt(550):30,restSpeed:10}:Ml:Ul;const Fl=(t,e,s,n={},i,r)=>o=>{const a=Br(n,t)||{},l=a.delay||n.delay||0;let{elapsed:c=0}=n;c-=Hn(l);let h={keyframes:Array.isArray(s)?s:[null,s],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:t=>{e.set(t),a.onUpdate&&a.onUpdate(t)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:r?void 0:i};(function({when:t,delay:e,delayChildren:s,staggerChildren:n,staggerDirection:i,repeat:r,repeatType:o,repeatDelay:a,from:l,elapsed:c,...h}){return!!Object.keys(h).length})(a)||(h={...h,...Bl(t,h)}),h.duration&&(h.duration=Hn(h.duration)),h.repeatDelay&&(h.repeatDelay=Hn(h.repeatDelay)),void 0!==h.from&&(h.keyframes[0]=h.from);let u=!1;if((!1===h.type||0===h.duration&&!h.repeatDelay)&&(h.duration=0,0===h.delay&&(u=!0)),u&&!r&&void 0!==e.get()){const t=Ia(h.keyframes,a);if(void 0!==t)return Zn.update(()=>{h.onUpdate(t),h.onComplete()}),new Ur([])}return!r&&Ll.supports(h)?new Ll(h):new Rl(h)};function Nl({protectedKeys:t,needsAnimating:e},s){const n=t.hasOwnProperty(s)&&!0!==e[s];return e[s]=!1,n}function Wl(t,e,{delay:s=0,transitionOverride:n,type:i}={}){var r;let{transition:o=t.getDefaultTransition(),transitionEnd:a,...l}=e;n&&(o=n);const c=[],h=i&&t.animationState&&t.animationState.getState()[i];for(const u in l){const e=t.getValue(u,null!==(r=t.latestValues[u])&&void 0!==r?r:null),n=l[u];if(void 0===n||h&&Nl(h,u))continue;const i={delay:s,...Br(o||{},u)};let a=!1;if(window.MotionHandoffAnimation){const e=So(t);if(e){const t=window.MotionHandoffAnimation(e,u,Zn);null!==t&&(i.startTime=t,a=!0)}}To(t,u),e.start(Fl(u,e,n,t.shouldReduceMotion&&po.has(u)?{type:!1}:i,t,a));const d=e.animation;d&&c.push(d)}return a&&Promise.all(c).then(()=>{Zn.update(()=>{a&&function(t,e){const s=Lr(t,e);let{transitionEnd:n={},transition:i={},...r}=s||{};r={...r,...n};for(const o in r)xo(t,o,Di(r[o]))}(t,a)})}),c}function ql(t,e,s={}){var n;const i=Lr(t,e,"exit"===s.type?null===(n=t.presenceContext)||void 0===n?void 0:n.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=i||{};s.transitionOverride&&(r=s.transitionOverride);const o=i?()=>Promise.all(Wl(t,i,s)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(n=0)=>{const{delayChildren:i=0,staggerChildren:o,staggerDirection:a}=r;return function(t,e,s=0,n=0,i=1,r){const o=[],a=(t.variantChildren.size-1)*n,l=1===i?(t=0)=>t*n:(t=0)=>a-t*n;return Array.from(t.variantChildren).sort(zl).forEach((t,n)=>{t.notify("AnimationStart",e),o.push(ql(t,e,{...r,delay:s+l(n)}).then(()=>t.notify("AnimationComplete",e)))}),Promise.all(o)}(t,e,i+n,o,a,s)}:()=>Promise.resolve(),{when:l}=r;if(l){const[t,e]="beforeChildren"===l?[o,a]:[a,o];return t().then(()=>e())}return Promise.all([o(),a(s.delay)])}function zl(t,e){return t.sortNodePosition(e)}const Kl=fi.length;function Hl(t){if(!t)return;if(!t.isControllingVariants){const e=t.parent&&Hl(t.parent)||{};return void 0!==t.props.initial&&(e.initial=t.props.initial),e}const e={};for(let s=0;s<Kl;s++){const n=fi[s],i=t.props[n];(ui(i)||!1===i)&&(e[n]=i)}return e}const Gl=[...pi].reverse(),Jl=pi.length;function Yl(t){return e=>Promise.all(e.map(({animation:e,options:s})=>function(t,e,s={}){let n;if(t.notify("AnimationStart",e),Array.isArray(e)){const i=e.map(e=>ql(t,e,s));n=Promise.all(i)}else if("string"==typeof e)n=ql(t,e,s);else{const i="function"==typeof e?Lr(t,e,s.custom):e;n=Promise.all(Wl(t,i,s))}return n.then(()=>{t.notify("AnimationComplete",e)})}(t,e,s)))}function Xl(t){let e=Yl(t),s=tc(),n=!0;const i=e=>(s,n)=>{var i;const r=Lr(t,n,"exit"===e?null===(i=t.presenceContext)||void 0===i?void 0:i.custom:void 0);if(r){const{transition:t,transitionEnd:e,...n}=r;s={...s,...n,...e}}return s};function r(r){const{props:o}=t,a=Hl(t.parent)||{},l=[],c=new Set;let h={},u=1/0;for(let e=0;e<Jl;e++){const d=Gl[e],p=s[d],f=void 0!==o[d]?o[d]:a[d],m=ui(f),g=d===r?p.isActive:null;!1===g&&(u=e);let v=f===a[d]&&f!==o[d]&&m;if(v&&n&&t.manuallyAnimateOnMount&&(v=!1),p.protectedKeys={...h},!p.isActive&&null===g||!f&&!p.prevProp||di(f)||"boolean"==typeof f)continue;const y=Zl(p.prevProp,f);let w=y||d===r&&p.isActive&&!v&&m||e>u&&m,b=!1;const _=Array.isArray(f)?f:[f];let k=_.reduce(i(d),{});!1===g&&(k={});const{prevResolvedValues:x={}}=p,T={...x,...k},S=e=>{w=!0,c.has(e)&&(b=!0,c.delete(e)),p.needsAnimating[e]=!0;const s=t.getValue(e);s&&(s.liveStyle=!1)};for(const t in T){const e=k[t],s=x[t];if(h.hasOwnProperty(t))continue;let n=!1;n=$i(e)&&$i(s)?!Dr(e,s):e!==s,n?null!=e?S(t):c.add(t):void 0!==e&&c.has(t)?S(t):p.protectedKeys[t]=!0}p.prevProp=f,p.prevResolvedValues=k,p.isActive&&(h={...h,...k}),n&&t.blockInitialAnimation&&(w=!1);w&&(!(v&&y)||b)&&l.push(..._.map(t=>({animation:t,options:{type:d}})))}if(c.size){const e={};c.forEach(s=>{const n=t.getBaseTarget(s),i=t.getValue(s);i&&(i.liveStyle=!0),e[s]=null!=n?n:null}),l.push({animation:e})}let d=Boolean(l.length);return!n||!1!==o.initial&&o.initial!==o.animate||t.manuallyAnimateOnMount||(d=!1),n=!1,d?e(l):Promise.resolve()}return{animateChanges:r,setActive:function(e,n){var i;if(s[e].isActive===n)return Promise.resolve();null===(i=t.variantChildren)||void 0===i||i.forEach(t=>{var s;return null===(s=t.animationState)||void 0===s?void 0:s.setActive(e,n)}),s[e].isActive=n;const o=r(e);for(const t in s)s[t].protectedKeys={};return o},setAnimateFunction:function(s){e=s(t)},getState:()=>s,reset:()=>{s=tc(),n=!0}}}function Zl(t,e){return"string"==typeof e?e!==t:!!Array.isArray(e)&&!Dr(e,t)}function Ql(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function tc(){return{animate:Ql(!0),whileInView:Ql(),whileHover:Ql(),whileTap:Ql(),whileDrag:Ql(),whileFocus:Ql(),exit:Ql()}}class ec{constructor(t){this.isMounted=!1,this.node=t}update(){}}let sc=0;const nc={animation:{Feature:class extends ec{constructor(t){super(t),t.animationState||(t.animationState=Xl(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();di(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:e}=this.node.prevProps||{};t!==e&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),null===(t=this.unmountControls)||void 0===t||t.call(this)}}},exit:{Feature:class extends ec{constructor(){super(...arguments),this.id=sc++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:e}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const n=this.node.animationState.setActive("exit",!t);e&&!t&&n.then(()=>e(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}}};function ic(t,e,s,n={passive:!0}){return t.addEventListener(e,s,n),()=>t.removeEventListener(e,s)}function rc(t){return{point:{x:t.pageX,y:t.pageY}}}function oc(t,e,s,n){return ic(t,e,(t=>e=>ro(e)&&t(e,rc(e)))(s),n)}const ac=(t,e)=>Math.abs(t-e);class lc{constructor(t,e,{transformPagePoint:s,contextWindow:n,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const t=uc(this.lastMoveEventInfo,this.history),e=null!==this.startEvent,s=function(t,e){const s=ac(t.x,e.x),n=ac(t.y,e.y);return Math.sqrt(s**2+n**2)}(t.offset,{x:0,y:0})>=3;if(!e&&!s)return;const{point:n}=t,{timestamp:i}=ti;this.history.push({...n,timestamp:i});const{onStart:r,onMove:o}=this.handlers;e||(r&&r(this.lastMoveEvent,t),this.startEvent=this.lastMoveEvent),o&&o(this.lastMoveEvent,t)},this.handlePointerMove=(t,e)=>{this.lastMoveEvent=t,this.lastMoveEventInfo=cc(e,this.transformPagePoint),Zn.update(this.updatePoint,!0)},this.handlePointerUp=(t,e)=>{this.end();const{onEnd:s,onSessionEnd:n,resumeAnimation:i}=this.handlers;if(this.dragSnapToOrigin&&i&&i(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const r=uc("pointercancel"===t.type?this.lastMoveEventInfo:cc(e,this.transformPagePoint),this.history);this.startEvent&&s&&s(t,r),n&&n(t,r)},!ro(t))return;this.dragSnapToOrigin=i,this.handlers=e,this.transformPagePoint=s,this.contextWindow=n||window;const r=cc(rc(t),this.transformPagePoint),{point:o}=r,{timestamp:a}=ti;this.history=[{...o,timestamp:a}];const{onSessionStart:l}=e;l&&l(t,uc(r,this.history)),this.removeListeners=Wa(oc(this.contextWindow,"pointermove",this.handlePointerMove),oc(this.contextWindow,"pointerup",this.handlePointerUp),oc(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Qn(this.updatePoint)}}function cc(t,e){return e?{point:e(t.point)}:t}function hc(t,e){return{x:t.x-e.x,y:t.y-e.y}}function uc({point:t},e){return{point:t,delta:hc(t,pc(e)),offset:hc(t,dc(e)),velocity:fc(e,.1)}}function dc(t){return t[0]}function pc(t){return t[t.length-1]}function fc(t,e){if(t.length<2)return{x:0,y:0};let s=t.length-1,n=null;const i=pc(t);for(;s>=0&&(n=t[s],!(i.timestamp-n.timestamp>Hn(e)));)s--;if(!n)return{x:0,y:0};const r=Gn(i.timestamp-n.timestamp);if(0===r)return{x:0,y:0};const o={x:(i.x-n.x)/r,y:(i.y-n.y)/r};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function mc(t){return t.max-t.min}function gc(t,e,s,n=.5){t.origin=n,t.originPoint=Da(e.min,e.max,t.origin),t.scale=mc(s)/mc(e),t.translate=Da(s.min,s.max,t.origin)-t.originPoint,(t.scale>=.9999&&t.scale<=1.0001||isNaN(t.scale))&&(t.scale=1),(t.translate>=-.01&&t.translate<=.01||isNaN(t.translate))&&(t.translate=0)}function vc(t,e,s,n){gc(t.x,e.x,s.x,n?n.originX:void 0),gc(t.y,e.y,s.y,n?n.originY:void 0)}function yc(t,e,s){t.min=s.min+e.min,t.max=t.min+mc(e)}function wc(t,e,s){t.min=e.min-s.min,t.max=t.min+mc(e)}function bc(t,e,s){wc(t.x,e.x,s.x),wc(t.y,e.y,s.y)}function _c(t,e,s){return{min:void 0!==e?t.min+e:void 0,max:void 0!==s?t.max+s-(t.max-t.min):void 0}}function kc(t,e){let s=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([s,n]=[n,s]),{min:s,max:n}}const xc=.35;function Tc(t,e,s){return{min:Sc(t,e),max:Sc(t,s)}}function Sc(t,e){return"number"==typeof t?t:t[e]||0}const Pc=()=>({x:{min:0,max:0},y:{min:0,max:0}});function Ec(t){return[t("x"),t("y")]}function Ac({top:t,left:e,right:s,bottom:n}){return{x:{min:e,max:s},y:{min:t,max:n}}}function jc(t){return void 0===t||1===t}function Cc({scale:t,scaleX:e,scaleY:s}){return!jc(t)||!jc(e)||!jc(s)}function Rc(t){return Cc(t)||Oc(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function Oc(t){return Ic(t.x)||Ic(t.y)}function Ic(t){return t&&"0%"!==t}function $c(t,e,s){return s+e*(t-s)}function Dc(t,e,s,n,i){return void 0!==i&&(t=$c(t,i,n)),$c(t,s,n)+e}function Lc(t,e=0,s=1,n,i){t.min=Dc(t.min,e,s,n,i),t.max=Dc(t.max,e,s,n,i)}function Mc(t,{x:e,y:s}){Lc(t.x,e.translate,e.scale,e.originPoint),Lc(t.y,s.translate,s.scale,s.originPoint)}const Vc=.999999999999,Uc=1.0000000000001;function Bc(t,e){t.min=t.min+e,t.max=t.max+e}function Fc(t,e,s,n,i=.5){Lc(t,e,s,Da(t.min,t.max,i),n)}function Nc(t,e){Fc(t.x,e.x,e.scaleX,e.scale,e.originX),Fc(t.y,e.y,e.scaleY,e.scale,e.originY)}function Wc(t,e){return Ac(function(t,e){if(!e)return t;const s=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:s.y,left:s.x,bottom:n.y,right:n.x}}(t.getBoundingClientRect(),e))}const qc=({current:t})=>t?t.ownerDocument.defaultView:null,zc=new WeakMap;class Kc{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.visualElement=t}start(t,{snapToCursor:e=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&!1===s.isPresent)return;const{dragSnapToOrigin:n}=this.getProps();this.panSession=new lc(t,{onSessionStart:t=>{const{dragSnapToOrigin:s}=this.getProps();s?this.pauseAnimation():this.stopAnimation(),e&&this.snapToCursor(rc(t).point)},onStart:(t,e)=>{const{drag:s,dragPropagation:n,onDragStart:i}=this.getProps();if(s&&!n&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===(r=s)||"y"===r?to[r]?null:(to[r]=!0,()=>{to[r]=!1}):to.x||to.y?null:(to.x=to.y=!0,()=>{to.x=to.y=!1}),!this.openDragLock))return;var r;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ec(t=>{let e=this.getAxisMotionValue(t).get()||0;if(tr.test(e)){const{projection:s}=this.visualElement;if(s&&s.layout){const n=s.layout.layoutBox[t];if(n){e=mc(n)*(parseFloat(e)/100)}}}this.originPoint[t]=e}),i&&Zn.postRender(()=>i(t,e)),To(this.visualElement,"transform");const{animationState:o}=this.visualElement;o&&o.setActive("whileDrag",!0)},onMove:(t,e)=>{const{dragPropagation:s,dragDirectionLock:n,onDirectionLock:i,onDrag:r}=this.getProps();if(!s&&!this.openDragLock)return;const{offset:o}=e;if(n&&null===this.currentDirection)return this.currentDirection=function(t,e=10){let s=null;Math.abs(t.y)>e?s="y":Math.abs(t.x)>e&&(s="x");return s}(o),void(null!==this.currentDirection&&i&&i(this.currentDirection));this.updateAxis("x",e.point,o),this.updateAxis("y",e.point,o),this.visualElement.render(),r&&r(t,e)},onSessionEnd:(t,e)=>this.stop(t,e),resumeAnimation:()=>Ec(t=>{var e;return"paused"===this.getAnimationState(t)&&(null===(e=this.getAxisMotionValue(t).animation)||void 0===e?void 0:e.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:n,contextWindow:qc(this.visualElement)})}stop(t,e){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:n}=e;this.startAnimation(n);const{onDragEnd:i}=this.getProps();i&&Zn.postRender(()=>i(t,e))}cancel(){this.isDragging=!1;const{projection:t,animationState:e}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),e&&e.setActive("whileDrag",!1)}updateAxis(t,e,s){const{drag:n}=this.getProps();if(!s||!Hc(t,n,this.currentDirection))return;const i=this.getAxisMotionValue(t);let r=this.originPoint[t]+s[t];this.constraints&&this.constraints[t]&&(r=function(t,{min:e,max:s},n){return void 0!==e&&t<e?t=n?Da(e,t,n.min):Math.max(t,e):void 0!==s&&t>s&&(t=n?Da(s,t,n.max):Math.min(t,s)),t}(r,this.constraints[t],this.elastic[t])),i.set(r)}resolveConstraints(){var t;const{dragConstraints:e,dragElastic:s}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(t=this.visualElement.projection)||void 0===t?void 0:t.layout,i=this.constraints;e&&bi(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!e||!n)&&function(t,{top:e,left:s,bottom:n,right:i}){return{x:_c(t.x,s,i),y:_c(t.y,e,n)}}(n.layoutBox,e),this.elastic=function(t=xc){return!1===t?t=0:!0===t&&(t=xc),{x:Tc(t,"left","right"),y:Tc(t,"top","bottom")}}(s),i!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Ec(t=>{!1!==this.constraints&&this.getAxisMotionValue(t)&&(this.constraints[t]=function(t,e){const s={};return void 0!==e.min&&(s.min=e.min-t.min),void 0!==e.max&&(s.max=e.max-t.min),s}(n.layoutBox[t],this.constraints[t]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:e}=this.getProps();if(!t||!bi(t))return!1;const s=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const i=function(t,e,s){const n=Wc(t,s),{scroll:i}=e;return i&&(Bc(n.x,i.offset.x),Bc(n.y,i.offset.y)),n}(s,n.root,this.visualElement.getTransformPagePoint());let r=function(t,e){return{x:kc(t.x,e.x),y:kc(t.y,e.y)}}(n.layout.layoutBox,i);if(e){const t=e(function({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}(r));this.hasMutatedConstraints=!!t,t&&(r=Ac(t))}return r}startAnimation(t){const{drag:e,dragMomentum:s,dragElastic:n,dragTransition:i,dragSnapToOrigin:r,onDragTransitionEnd:o}=this.getProps(),a=this.constraints||{},l=Ec(o=>{if(!Hc(o,e,this.currentDirection))return;let l=a&&a[o]||{};r&&(l={min:0,max:0});const c=n?200:1e6,h=n?40:1e7,u={type:"inertia",velocity:s?t[o]:0,bounceStiffness:c,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10,...i,...l};return this.startAxisValueAnimation(o,u)});return Promise.all(l).then(o)}startAxisValueAnimation(t,e){const s=this.getAxisMotionValue(t);return To(this.visualElement,t),s.start(Fl(t,s,0,e,this.visualElement,!1))}stopAnimation(){Ec(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Ec(t=>{var e;return null===(e=this.getAxisMotionValue(t).animation)||void 0===e?void 0:e.pause()})}getAnimationState(t){var e;return null===(e=this.getAxisMotionValue(t).animation)||void 0===e?void 0:e.state}getAxisMotionValue(t){const e=`_drag${t.toUpperCase()}`,s=this.visualElement.getProps(),n=s[e];return n||this.visualElement.getValue(t,(s.initial?s.initial[t]:void 0)||0)}snapToCursor(t){Ec(e=>{const{drag:s}=this.getProps();if(!Hc(e,s,this.currentDirection))return;const{projection:n}=this.visualElement,i=this.getAxisMotionValue(e);if(n&&n.layout){const{min:s,max:r}=n.layout.layoutBox[e];i.set(t[e]-Da(s,r,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:e}=this.getProps(),{projection:s}=this.visualElement;if(!bi(e)||!s||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};Ec(t=>{const e=this.getAxisMotionValue(t);if(e&&!1!==this.constraints){const s=e.get();n[t]=function(t,e){let s=.5;const n=mc(t),i=mc(e);return i>n?s=Kn(e.min,e.max-n,t.min):n>i&&(s=Kn(t.min,t.max-i,e.min)),Gi(0,1,s)}({min:s,max:s},this.constraints[t])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),Ec(e=>{if(!Hc(e,t,null))return;const s=this.getAxisMotionValue(e),{min:i,max:r}=this.constraints[e];s.set(Da(i,r,n[e]))})}addListeners(){if(!this.visualElement.current)return;zc.set(this.visualElement,this);const t=oc(this.visualElement.current,"pointerdown",t=>{const{drag:e,dragListener:s=!0}=this.getProps();e&&s&&this.start(t)}),e=()=>{const{dragConstraints:t}=this.getProps();bi(t)&&t.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,n=s.addEventListener("measure",e);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Zn.read(e);const i=ic(window,"resize",()=>this.scalePositionWithinConstraints()),r=s.addEventListener("didUpdate",({delta:t,hasLayoutChanged:e})=>{this.isDragging&&e&&(Ec(e=>{const s=this.getAxisMotionValue(e);s&&(this.originPoint[e]+=t[e].translate,s.set(s.get()+t[e].translate))}),this.visualElement.render())});return()=>{i(),t(),n(),r&&r()}}getProps(){const t=this.visualElement.getProps(),{drag:e=!1,dragDirectionLock:s=!1,dragPropagation:n=!1,dragConstraints:i=!1,dragElastic:r=xc,dragMomentum:o=!0}=t;return{...t,drag:e,dragDirectionLock:s,dragPropagation:n,dragConstraints:i,dragElastic:r,dragMomentum:o}}}function Hc(t,e,s){return!(!0!==e&&e!==t||null!==s&&s!==t)}const Gc=t=>(e,s)=>{t&&Zn.postRender(()=>t(e,s))};const Jc={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Yc(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Xc={correct:(t,e)=>{if(!e.target)return t;if("string"==typeof t){if(!er.test(t))return t;t=parseFloat(t)}return`${Yc(t,e.target.x)}% ${Yc(t,e.target.y)}%`}},Zc={correct:(t,{treeScale:e,projectionDelta:s})=>{const n=t,i=na.parse(t);if(i.length>5)return n;const r=na.createTransformer(t),o="number"!=typeof i[0]?1:0,a=s.x.scale*e.x,l=s.y.scale*e.y;i[0+o]/=a,i[1+o]/=l;const c=Da(a,l,.5);return"number"==typeof i[2+o]&&(i[2+o]/=c),"number"==typeof i[3+o]&&(i[3+o]/=c),r(i)}};class Qc extends t.Component{componentDidMount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:s,layoutId:n}=this.props,{projection:i}=t;var r;r=eh,Object.assign(kr,r),i&&(e.group&&e.group.add(i),s&&s.register&&n&&s.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Jc.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:e,visualElement:s,drag:n,isPresent:i}=this.props,r=s.projection;return r?(r.isPresent=i,n||t.layoutDependency!==e||void 0===e?r.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?r.promote():r.relegate()||Zn.postRender(()=>{const t=r.getStack();t&&t.members.length||this.safeToRemove()})),null):null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Ti.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:s}=this.props,{projection:n}=t;n&&(n.scheduleCheckAfterUnmount(),e&&e.group&&e.group.remove(n),s&&s.deregister&&s.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function th(s){const[n,i]=Mn(),r=t.useContext(jn);return e.jsx(Qc,{...s,layoutGroup:r,switchLayoutGroup:t.useContext(Si),isPresent:n,safeToRemove:i})}const eh={borderRadius:{...Xc,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Xc,borderTopRightRadius:Xc,borderBottomLeftRadius:Xc,borderBottomRightRadius:Xc,boxShadow:Zc};const sh=(t,e)=>t.depth-e.depth;class nh{constructor(){this.children=[],this.isDirty=!1}add(t){vo(this.children,t),this.isDirty=!0}remove(t){yo(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(sh),this.isDirty=!1,this.children.forEach(t)}}const ih=["TopLeft","TopRight","BottomLeft","BottomRight"],rh=ih.length,oh=t=>"string"==typeof t?parseFloat(t):t,ah=t=>"number"==typeof t||er.test(t);function lh(t,e){return void 0!==t[e]?t[e]:t.borderRadius}const ch=uh(0,.5,Do),hh=uh(.5,.95,Wn);function uh(t,e,s){return n=>n<t?0:n>e?1:s(Kn(t,e,n))}function dh(t,e){t.min=e.min,t.max=e.max}function ph(t,e){dh(t.x,e.x),dh(t.y,e.y)}function fh(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function mh(t,e,s,n,i){return t=$c(t-=e,1/s,n),void 0!==i&&(t=$c(t,1/i,n)),t}function gh(t,e,[s,n,i],r,o){!function(t,e=0,s=1,n=.5,i,r=t,o=t){tr.test(e)&&(e=parseFloat(e),e=Da(o.min,o.max,e/100)-o.min);if("number"!=typeof e)return;let a=Da(r.min,r.max,n);t===r&&(a-=e),t.min=mh(t.min,e,s,a,i),t.max=mh(t.max,e,s,a,i)}(t,e[s],e[n],e[i],e.scale,r,o)}const vh=["x","scaleX","originX"],yh=["y","scaleY","originY"];function wh(t,e,s,n){gh(t.x,e,vh,s?s.x:void 0,n?n.x:void 0),gh(t.y,e,yh,s?s.y:void 0,n?n.y:void 0)}function bh(t){return 0===t.translate&&1===t.scale}function _h(t){return bh(t.x)&&bh(t.y)}function kh(t,e){return t.min===e.min&&t.max===e.max}function xh(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function Th(t,e){return xh(t.x,e.x)&&xh(t.y,e.y)}function Sh(t){return mc(t.x)/mc(t.y)}function Ph(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class Eh{constructor(){this.members=[]}add(t){vo(this.members,t),t.scheduleRender()}remove(t){if(yo(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(t){const e=this.members.findIndex(e=>t===e);if(0===e)return!1;let s;for(let n=e;n>=0;n--){const t=this.members[n];if(!1!==t.isPresent){s=t;break}}return!!s&&(this.promote(s),!0)}promote(t,e){const s=this.lead;if(t!==s&&(this.prevLead=s,this.lead=t,t.show(),s)){s.instance&&s.scheduleRender(),t.scheduleRender(),t.resumeFrom=s,e&&(t.resumeFrom.preserveOpacity=!0),s.snapshot&&(t.snapshot=s.snapshot,t.snapshot.latestValues=s.animationValues||s.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;!1===n&&s.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:e,resumingFrom:s}=t;e.onExitComplete&&e.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Ah={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},jh="undefined"!=typeof window&&void 0!==window.MotionDebug,Ch=["","X","Y","Z"],Rh={visibility:"hidden"};let Oh=0;function Ih(t,e,s,n){const{latestValues:i}=e;i[t]&&(s[t]=i[t],e.setStaticValue(t,0),n&&(n[t]=0))}function $h(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const s=So(e);if(window.MotionHasOptimisedAnimation(s,"transform")){const{layout:e,layoutId:n}=t.options;window.MotionCancelOptimisedAnimation(s,"transform",Zn,!(e||n))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&$h(n)}function Dh({attachResizeListener:t,defaultParent:e,measureScroll:s,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(t={},s=(null==e?void 0:e())){this.id=Oh++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,jh&&(Ah.totalNodes=Ah.resolvedTargetDeltas=Ah.recalculatedProjection=0),this.nodes.forEach(Vh),this.nodes.forEach(zh),this.nodes.forEach(Kh),this.nodes.forEach(Uh),jh&&window.MotionDebug.record(Ah)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=t,this.root=s?s.root||s:this,this.path=s?[...s.path,s]:[],this.parent=s,this.depth=s?s.depth+1:0;for(let e=0;e<this.path.length;e++)this.path[e].shouldResetTransform=!0;this.root===this&&(this.nodes=new nh)}addEventListener(t,e){return this.eventHandlers.has(t)||this.eventHandlers.set(t,new wo),this.eventHandlers.get(t).add(e)}notifyListeners(t,...e){const s=this.eventHandlers.get(t);s&&s.notify(...e)}hasListeners(t){return this.eventHandlers.has(t)}mount(e,s=this.root.hasTreeAnimated){if(this.instance)return;var n;this.isSVG=(n=e)instanceof SVGElement&&"svg"!==n.tagName,this.instance=e;const{layoutId:i,layout:r,visualElement:o}=this.options;if(o&&!o.current&&o.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),s&&(r||i)&&(this.isLayoutDirty=!0),t){let s;const n=()=>this.root.updateBlockedByResize=!1;t(e,()=>{this.root.updateBlockedByResize=!0,s&&s(),s=function(t,e){const s=go.now(),n=({timestamp:i})=>{const r=i-s;r>=e&&(Qn(n),t(r-e))};return Zn.read(n,!0),()=>Qn(n)}(n,250),Jc.hasAnimatedSinceResize&&(Jc.hasAnimatedSinceResize=!1,this.nodes.forEach(qh))})}i&&this.root.registerSharedNode(i,this),!1!==this.options.animate&&o&&(i||r)&&this.addEventListener("didUpdate",({delta:t,hasLayoutChanged:e,hasRelativeTargetChanged:s,layout:n})=>{if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const i=this.options.transition||o.getDefaultTransition()||Zh,{onLayoutAnimationStart:r,onLayoutAnimationComplete:a}=o.getProps(),l=!this.targetLayout||!Th(this.targetLayout,n)||s,c=!e&&s;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||c||e&&(l||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(t,c);const e={...Br(i,"layout"),onPlay:r,onComplete:a};(o.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e)}else e||qh(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=n})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const t=this.getStack();t&&t.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Qn(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Hh),this.animationId++)}getTransformTemplate(){const{visualElement:t}=this.options;return t&&t.getProps().transformTemplate}willUpdate(t=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&$h(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let i=0;i<this.path.length;i++){const t=this.path[i];t.shouldResetTransform=!0,t.updateScroll("snapshot"),t.options.layoutRoot&&t.willUpdate(!1)}const{layoutId:e,layout:s}=this.options;if(void 0===e&&!s)return;const n=this.getTransformTemplate();this.prevTransformTemplateValue=n?n(this.latestValues,""):void 0,this.updateSnapshot(),t&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(Fh);this.isUpdating||this.nodes.forEach(Nh),this.isUpdating=!1,this.nodes.forEach(Wh),this.nodes.forEach(Lh),this.nodes.forEach(Mh),this.clearAllSnapshots();const t=go.now();ti.delta=Gi(0,1e3/60,t-ti.timestamp),ti.timestamp=t,ti.isProcessing=!0,ei.update.process(ti),ei.preRender.process(ti),ei.render.process(ti),ti.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Ti.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Bh),this.sharedNodes.forEach(Gh)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Zn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Zn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance)return;if(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead()||this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let s=0;s<this.path.length;s++){this.path[s].updateScroll()}const t=this.layout;this.layout=this.measure(!1),this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:e}=this.options;e&&e.notify("LayoutMeasure",this.layout.layoutBox,t?t.layoutBox:void 0)}updateScroll(t="measure"){let e=Boolean(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===t&&(e=!1),e){const e=n(this.instance);this.scroll={animationId:this.root.animationId,phase:t,isRoot:e,offset:s(this.instance),wasRoot:this.scroll?this.scroll.isRoot:e}}}resetTransform(){if(!i)return;const t=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,e=this.projectionDelta&&!_h(this.projectionDelta),s=this.getTransformTemplate(),n=s?s(this.latestValues,""):void 0,r=n!==this.prevTransformTemplateValue;t&&(e||Rc(this.latestValues)||r)&&(i(this.instance,n),this.shouldResetTransform=!1,this.scheduleRender())}measure(t=!0){const e=this.measurePageBox();let s=this.removeElementScroll(e);var n;return t&&(s=this.removeTransform(s)),eu((n=s).x),eu(n.y),{animationId:this.root.animationId,measuredBox:e,layoutBox:s,latestValues:{},source:this.id}}measurePageBox(){var t;const{visualElement:e}=this.options;if(!e)return{x:{min:0,max:0},y:{min:0,max:0}};const s=e.measureViewportBox();if(!((null===(t=this.scroll)||void 0===t?void 0:t.wasRoot)||this.path.some(nu))){const{scroll:t}=this.root;t&&(Bc(s.x,t.offset.x),Bc(s.y,t.offset.y))}return s}removeElementScroll(t){var e;const s={x:{min:0,max:0},y:{min:0,max:0}};if(ph(s,t),null===(e=this.scroll)||void 0===e?void 0:e.wasRoot)return s;for(let n=0;n<this.path.length;n++){const e=this.path[n],{scroll:i,options:r}=e;e!==this.root&&i&&r.layoutScroll&&(i.wasRoot&&ph(s,t),Bc(s.x,i.offset.x),Bc(s.y,i.offset.y))}return s}applyTransform(t,e=!1){const s={x:{min:0,max:0},y:{min:0,max:0}};ph(s,t);for(let n=0;n<this.path.length;n++){const t=this.path[n];!e&&t.options.layoutScroll&&t.scroll&&t!==t.root&&Nc(s,{x:-t.scroll.offset.x,y:-t.scroll.offset.y}),Rc(t.latestValues)&&Nc(s,t.latestValues)}return Rc(this.latestValues)&&Nc(s,this.latestValues),s}removeTransform(t){const e={x:{min:0,max:0},y:{min:0,max:0}};ph(e,t);for(let s=0;s<this.path.length;s++){const t=this.path[s];if(!t.instance)continue;if(!Rc(t.latestValues))continue;Cc(t.latestValues)&&t.updateSnapshot();const n=Pc();ph(n,t.measurePageBox()),wh(e,t.latestValues,t.snapshot?t.snapshot.layoutBox:void 0,n)}return Rc(this.latestValues)&&wh(e,this.latestValues),e}setTargetDelta(t){this.targetDelta=t,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(t){this.options={...this.options,...t,crossfade:void 0===t.crossfade||t.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ti.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(t=!1){var e;const s=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=s.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=s.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=s.isSharedProjectionDirty);const n=Boolean(this.resumingFrom)||this!==s;if(!(t||n&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(e=this.parent)||void 0===e?void 0:e.isProjectionDirty)||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:i,layoutId:r}=this.options;if(this.layout&&(i||r)){if(this.resolvedRelativeTargetAt=ti.timestamp,!this.targetDelta&&!this.relativeTarget){const t=this.getClosestProjectingParent();t&&t.layout&&1!==this.animationProgress?(this.relativeParent=t,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},bc(this.relativeTargetOrigin,this.layout.layoutBox,t.layout.layoutBox),ph(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){var o,a,l;if(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),o=this.target,a=this.relativeTarget,l=this.relativeParent.target,yc(o.x,a.x,l.x),yc(o.y,a.y,l.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):ph(this.target,this.layout.layoutBox),Mc(this.target,this.targetDelta)):ph(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const t=this.getClosestProjectingParent();t&&Boolean(t.resumingFrom)===Boolean(this.resumingFrom)&&!t.options.layoutScroll&&t.target&&1!==this.animationProgress?(this.relativeParent=t,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},bc(this.relativeTargetOrigin,this.target,t.target),ph(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}jh&&Ah.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(this.parent&&!Cc(this.parent.latestValues)&&!Oc(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var t;const e=this.getLead(),s=Boolean(this.resumingFrom)||this!==e;let n=!0;if((this.isProjectionDirty||(null===(t=this.parent)||void 0===t?void 0:t.isProjectionDirty))&&(n=!1),s&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(n=!1),this.resolvedRelativeTargetAt===ti.timestamp&&(n=!1),n)return;const{layout:i,layoutId:r}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!i&&!r)return;ph(this.layoutCorrected,this.layout.layoutBox);const o=this.treeScale.x,a=this.treeScale.y;!function(t,e,s,n=!1){const i=s.length;if(!i)return;let r,o;e.x=e.y=1;for(let a=0;a<i;a++){r=s[a],o=r.projectionDelta;const{visualElement:i}=r.options;i&&i.props.style&&"contents"===i.props.style.display||(n&&r.options.layoutScroll&&r.scroll&&r!==r.root&&Nc(t,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,Mc(t,o)),n&&Rc(r.latestValues)&&Nc(t,r.latestValues))}e.x<Uc&&e.x>Vc&&(e.x=1),e.y<Uc&&e.y>Vc&&(e.y=1)}(this.layoutCorrected,this.treeScale,this.path,s),!e.layout||e.target||1===this.treeScale.x&&1===this.treeScale.y||(e.target=e.layout.layoutBox,e.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}});const{target:l}=e;l?(this.projectionDelta&&this.prevProjectionDelta?(fh(this.prevProjectionDelta.x,this.projectionDelta.x),fh(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),vc(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.treeScale.x===o&&this.treeScale.y===a&&Ph(this.projectionDelta.x,this.prevProjectionDelta.x)&&Ph(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),jh&&Ah.recalculatedProjection++):this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender())}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(t=!0){var e;if(null===(e=this.options.visualElement)||void 0===e||e.scheduleRender(),t){const t=this.getStack();t&&t.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}}setAnimationOrigin(t,e=!1){const s=this.snapshot,n=s?s.latestValues:{},i={...this.latestValues},r={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!e;const o={x:{min:0,max:0},y:{min:0,max:0}},a=(s?s.source:void 0)!==(this.layout?this.layout.source:void 0),l=this.getStack(),c=!l||l.members.length<=1,h=Boolean(a&&!c&&!0===this.options.crossfade&&!this.path.some(Xh));let u;this.animationProgress=0,this.mixTargetDelta=e=>{const s=e/1e3;var l,d,p,f,m,g;Jh(r.x,t.x,s),Jh(r.y,t.y,s),this.setTargetDelta(r),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(bc(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),p=this.relativeTarget,f=this.relativeTargetOrigin,m=o,g=s,Yh(p.x,f.x,m.x,g),Yh(p.y,f.y,m.y,g),u&&(l=this.relativeTarget,d=u,kh(l.x,d.x)&&kh(l.y,d.y))&&(this.isProjectionDirty=!1),u||(u={x:{min:0,max:0},y:{min:0,max:0}}),ph(u,this.relativeTarget)),a&&(this.animationValues=i,function(t,e,s,n,i,r){i?(t.opacity=Da(0,void 0!==s.opacity?s.opacity:1,ch(n)),t.opacityExit=Da(void 0!==e.opacity?e.opacity:1,0,hh(n))):r&&(t.opacity=Da(void 0!==e.opacity?e.opacity:1,void 0!==s.opacity?s.opacity:1,n));for(let o=0;o<rh;o++){const i=`border${ih[o]}Radius`;let r=lh(e,i),a=lh(s,i);void 0===r&&void 0===a||(r||(r=0),a||(a=0),0===r||0===a||ah(r)===ah(a)?(t[i]=Math.max(Da(oh(r),oh(a),n),0),(tr.test(a)||tr.test(r))&&(t[i]+="%")):t[i]=a)}(e.rotate||s.rotate)&&(t.rotate=Da(e.rotate||0,s.rotate||0,n))}(i,n,this.latestValues,s,h,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=s},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(t){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Qn(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Zn.update(()=>{Jc.hasAnimatedSinceResize=!0,this.currentAnimation=function(t,e,s){const n=Li(t)?t:ko(t);return n.start(Fl("",n,e,s)),n.animation}(0,1e3,{...t,onUpdate:e=>{this.mixTargetDelta(e),t.onUpdate&&t.onUpdate(e)},onComplete:()=>{t.onComplete&&t.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const t=this.getStack();t&&t.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const t=this.getLead();let{targetWithTransforms:e,target:s,layout:n,latestValues:i}=t;if(e&&s&&n){if(this!==t&&this.layout&&n&&su(this.options.animationType,this.layout.layoutBox,n.layoutBox)){s=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const e=mc(this.layout.layoutBox.x);s.x.min=t.target.x.min,s.x.max=s.x.min+e;const n=mc(this.layout.layoutBox.y);s.y.min=t.target.y.min,s.y.max=s.y.min+n}ph(e,s),Nc(e,i),vc(this.projectionDeltaWithTransform,this.layoutCorrected,e,i)}}registerSharedNode(t,e){this.sharedNodes.has(t)||this.sharedNodes.set(t,new Eh);this.sharedNodes.get(t).add(e);const s=e.options.initialPromotionConfig;e.promote({transition:s?s.transition:void 0,preserveFollowOpacity:s&&s.shouldPreserveFollowOpacity?s.shouldPreserveFollowOpacity(e):void 0})}isLead(){const t=this.getStack();return!t||t.lead===this}getLead(){var t;const{layoutId:e}=this.options;return e&&(null===(t=this.getStack())||void 0===t?void 0:t.lead)||this}getPrevLead(){var t;const{layoutId:e}=this.options;return e?null===(t=this.getStack())||void 0===t?void 0:t.prevLead:void 0}getStack(){const{layoutId:t}=this.options;if(t)return this.root.sharedNodes.get(t)}promote({needsReset:t,transition:e,preserveFollowOpacity:s}={}){const n=this.getStack();n&&n.promote(this,s),t&&(this.projectionDelta=void 0,this.needsReset=!0),e&&this.setOptions({transition:e})}relegate(){const t=this.getStack();return!!t&&t.relegate(this)}resetSkewAndRotation(){const{visualElement:t}=this.options;if(!t)return;let e=!1;const{latestValues:s}=t;if((s.z||s.rotate||s.rotateX||s.rotateY||s.rotateZ||s.skewX||s.skewY)&&(e=!0),!e)return;const n={};s.z&&Ih("z",t,n,this.animationValues);for(let i=0;i<Ch.length;i++)Ih(`rotate${Ch[i]}`,t,n,this.animationValues),Ih(`skew${Ch[i]}`,t,n,this.animationValues);t.render();for(const i in n)t.setStaticValue(i,n[i]),this.animationValues&&(this.animationValues[i]=n[i]);t.scheduleRender()}getProjectionStyles(t){var e,s;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Rh;const n={visibility:""},i=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,n.opacity="",n.pointerEvents=Mi(null==t?void 0:t.pointerEvents)||"",n.transform=i?i(this.latestValues,""):"none",n;const r=this.getLead();if(!this.projectionDelta||!this.layout||!r.target){const e={};return this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=Mi(null==t?void 0:t.pointerEvents)||""),this.hasProjected&&!Rc(this.latestValues)&&(e.transform=i?i({},""):"none",this.hasProjected=!1),e}const o=r.animationValues||r.latestValues;this.applyTransformsToTarget(),n.transform=function(t,e,s){let n="";const i=t.x.translate/e.x,r=t.y.translate/e.y,o=(null==s?void 0:s.z)||0;if((i||r||o)&&(n=`translate3d(${i}px, ${r}px, ${o}px) `),1===e.x&&1===e.y||(n+=`scale(${1/e.x}, ${1/e.y}) `),s){const{transformPerspective:t,rotate:e,rotateX:i,rotateY:r,skewX:o,skewY:a}=s;t&&(n=`perspective(${t}px) ${n}`),e&&(n+=`rotate(${e}deg) `),i&&(n+=`rotateX(${i}deg) `),r&&(n+=`rotateY(${r}deg) `),o&&(n+=`skewX(${o}deg) `),a&&(n+=`skewY(${a}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return 1===a&&1===l||(n+=`scale(${a}, ${l})`),n||"none"}(this.projectionDeltaWithTransform,this.treeScale,o),i&&(n.transform=i(o,n.transform));const{x:a,y:l}=this.projectionDelta;n.transformOrigin=`${100*a.origin}% ${100*l.origin}% 0`,r.animationValues?n.opacity=r===this?null!==(s=null!==(e=o.opacity)&&void 0!==e?e:this.latestValues.opacity)&&void 0!==s?s:1:this.preserveOpacity?this.latestValues.opacity:o.opacityExit:n.opacity=r===this?void 0!==o.opacity?o.opacity:"":void 0!==o.opacityExit?o.opacityExit:0;for(const c in kr){if(void 0===o[c])continue;const{correct:t,applyTo:e}=kr[c],s="none"===n.transform?o[c]:t(o[c],r);if(e){const t=e.length;for(let i=0;i<t;i++)n[e[i]]=s}else n[c]=s}return this.options.layoutId&&(n.pointerEvents=r===this?Mi(null==t?void 0:t.pointerEvents)||"":"none"),n}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(t=>{var e;return null===(e=t.currentAnimation)||void 0===e?void 0:e.stop()}),this.root.nodes.forEach(Fh),this.root.sharedNodes.clear()}}}function Lh(t){t.updateLayout()}function Mh(t){var e;const s=(null===(e=t.resumeFrom)||void 0===e?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&s&&t.hasListeners("didUpdate")){const{layoutBox:e,measuredBox:n}=t.layout,{animationType:i}=t.options,r=s.source!==t.layout.source;"size"===i?Ec(t=>{const n=r?s.measuredBox[t]:s.layoutBox[t],i=mc(n);n.min=e[t].min,n.max=n.min+i}):su(i,s.layoutBox,e)&&Ec(n=>{const i=r?s.measuredBox[n]:s.layoutBox[n],o=mc(e[n]);i.max=i.min+o,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[n].max=t.relativeTarget[n].min+o)});const o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};vc(o,e,s.layoutBox);const a={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};r?vc(a,t.applyTransform(n,!0),s.measuredBox):vc(a,e,s.layoutBox);const l=!_h(o);let c=!1;if(!t.resumeFrom){const n=t.getClosestProjectingParent();if(n&&!n.resumeFrom){const{snapshot:i,layout:r}=n;if(i&&r){const o={x:{min:0,max:0},y:{min:0,max:0}};bc(o,s.layoutBox,i.layoutBox);const a={x:{min:0,max:0},y:{min:0,max:0}};bc(a,e,r.layoutBox),Th(o,a)||(c=!0),n.options.layoutRoot&&(t.relativeTarget=a,t.relativeTargetOrigin=o,t.relativeParent=n)}}}t.notifyListeners("didUpdate",{layout:e,snapshot:s,delta:a,layoutDelta:o,hasLayoutChanged:l,hasRelativeTargetChanged:c})}else if(t.isLead()){const{onExitComplete:e}=t.options;e&&e()}t.options.transition=void 0}function Vh(t){jh&&Ah.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=Boolean(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Uh(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Bh(t){t.clearSnapshot()}function Fh(t){t.clearMeasurements()}function Nh(t){t.isLayoutDirty=!1}function Wh(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function qh(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function zh(t){t.resolveTargetDelta()}function Kh(t){t.calcProjection()}function Hh(t){t.resetSkewAndRotation()}function Gh(t){t.removeLeadSnapshot()}function Jh(t,e,s){t.translate=Da(e.translate,0,s),t.scale=Da(e.scale,1,s),t.origin=e.origin,t.originPoint=e.originPoint}function Yh(t,e,s,n){t.min=Da(e.min,s.min,n),t.max=Da(e.max,s.max,n)}function Xh(t){return t.animationValues&&void 0!==t.animationValues.opacityExit}const Zh={duration:.45,ease:[.4,0,.1,1]},Qh=t=>"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),tu=Qh("applewebkit/")&&!Qh("chrome/")?Math.round:Wn;function eu(t){t.min=tu(t.min),t.max=tu(t.max)}function su(t,e,s){return"position"===t||"preserve-aspect"===t&&(n=Sh(e),i=Sh(s),r=.2,!(Math.abs(n-i)<=r));var n,i,r}function nu(t){var e;return t!==t.root&&(null===(e=t.scroll)||void 0===e?void 0:e.wasRoot)}const iu=Dh({attachResizeListener:(t,e)=>ic(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),ru={current:void 0},ou=Dh({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!ru.current){const t=new iu({});t.mount(window),t.setOptions({layoutScroll:!0}),ru.current=t}return ru.current},resetTransform:(t,e)=>{t.style.transform=void 0!==e?e:"none"},checkIsScrollRoot:t=>Boolean("fixed"===window.getComputedStyle(t).position)}),au={pan:{Feature:class extends ec{constructor(){super(...arguments),this.removePointerDownListener=Wn}onPointerDown(t){this.session=new lc(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:qc(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:e,onPan:s,onPanEnd:n}=this.node.getProps();return{onSessionStart:Gc(t),onStart:Gc(e),onMove:s,onEnd:(t,e)=>{delete this.session,n&&Zn.postRender(()=>n(t,e))}}}mount(){this.removePointerDownListener=oc(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends ec{constructor(t){super(t),this.removeGroupControls=Wn,this.removeListeners=Wn,this.controls=new Kc(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Wn}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:ou,MeasureLayout:th}};function lu(t,e,s){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover","Start"===s);const i=n["onHover"+s];i&&Zn.postRender(()=>i(e,rc(e)))}function cu(t,e,s){const{props:n}=t;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap","Start"===s);const i=n["onTap"+("End"===s?"":s)];i&&Zn.postRender(()=>i(e,rc(e)))}const hu=new WeakMap,uu=new WeakMap,du=t=>{const e=hu.get(t.target);e&&e(t)},pu=t=>{t.forEach(du)};function fu(t,e,s){const n=function({root:t,...e}){const s=t||document;uu.has(s)||uu.set(s,{});const n=uu.get(s),i=JSON.stringify(e);return n[i]||(n[i]=new IntersectionObserver(pu,{root:t,...e})),n[i]}(e);return hu.set(t,s),n.observe(t),()=>{hu.delete(t),n.unobserve(t)}}const mu={some:0,all:1};const gu={inView:{Feature:class extends ec{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:e,margin:s,amount:n="some",once:i}=t,r={root:e?e.current:void 0,rootMargin:s,threshold:"number"==typeof n?n:mu[n]};return fu(this.node.current,r,t=>{const{isIntersecting:e}=t;if(this.isInView===e)return;if(this.isInView=e,i&&!e&&this.hasEnteredView)return;e&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",e);const{onViewportEnter:s,onViewportLeave:n}=this.node.getProps(),r=e?s:n;r&&r(t)})}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;const{props:t,prevProps:e}=this.node;["amount","margin","root"].some(function({viewport:t={}},{viewport:e={}}={}){return s=>t[s]!==e[s]}(t,e))&&this.startObserver()}unmount(){}}},tap:{Feature:class extends ec{mount(){const{current:t}=this.node;t&&(this.unmount=uo(t,t=>(cu(this.node,t,"Start"),(t,{success:e})=>cu(this.node,t,e?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends ec{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch(e){t=!0}t&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Wa(ic(this.node.current,"focus",()=>this.onFocus()),ic(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends ec{mount(){const{current:t}=this.node;t&&(this.unmount=function(t,e,s={}){const[n,i,r]=so(t,s),o=no(t=>{const{target:s}=t,n=e(t);if("function"!=typeof n||!s)return;const r=no(t=>{n(t),s.removeEventListener("pointerleave",r)});s.addEventListener("pointerleave",r,i)});return n.forEach(t=>{t.addEventListener("pointerenter",o,i)}),r}(t,t=>(lu(this.node,t,"Start"),t=>lu(this.node,t,"End"))))}unmount(){}}}},vu={layout:{ProjectionNode:ou,MeasureLayout:th}},yu={current:null},wu={current:!1};const bu=[...Aa,Go,na],_u=new WeakMap;const ku=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class xu{scrapeMotionValuesFromProps(t,e,s){return{}}constructor({parent:t,props:e,presenceContext:s,reducedMotionConfig:n,blockInitialAnimation:i,visualState:r},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=xa,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const t=go.now();this.renderScheduledAt<t&&(this.renderScheduledAt=t,Zn.render(this.render,!1,!0))};const{latestValues:a,renderState:l,onUpdate:c}=r;this.onUpdate=c,this.latestValues=a,this.baseTarget={...a},this.initialValues=e.initial?{...a}:{},this.renderState=l,this.parent=t,this.props=e,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=o,this.blockInitialAnimation=Boolean(i),this.isControllingVariants=mi(e),this.isVariantNode=gi(e),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const{willChange:h,...u}=this.scrapeMotionValuesFromProps(e,{},this);for(const d in u){const t=u[d];void 0!==a[d]&&Li(t)&&t.set(a[d],!1)}}mount(t){this.current=t,_u.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,e)=>this.bindToMotionValue(e,t)),wu.current||function(){if(wu.current=!0,Bn)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>yu.current=t.matches;t.addListener(e),e()}else yu.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||yu.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){_u.delete(this.current),this.projection&&this.projection.unmount(),Qn(this.notifyUpdate),Qn(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}bindToMotionValue(t,e){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const s=Fi.has(t),n=e.on("change",e=>{this.latestValues[t]=e,this.props.onUpdate&&Zn.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),i=e.on("renderRequest",this.scheduleRender);let r;window.MotionCheckAppearSync&&(r=window.MotionCheckAppearSync(this,t,e)),this.valueSubscriptions.set(t,()=>{n(),i(),r&&r(),e.owner&&e.stop()})}sortNodePosition(t){return this.current&&this.sortInstanceNodePosition&&this.type===t.type?this.sortInstanceNodePosition(this.current,t.current):0}updateFeatures(){let t="animation";for(t in ii){const e=ii[t];if(!e)continue;const{isEnabled:s,Feature:n}=e;if(!this.features[t]&&n&&s(this.props)&&(this.features[t]=new n(this)),this.features[t]){const e=this.features[t];e.isMounted?e.update():(e.mount(),e.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,e){this.latestValues[t]=e}update(t,e){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=e;for(let s=0;s<ku.length;s++){const e=ku[s];this.propEventSubscriptions[e]&&(this.propEventSubscriptions[e](),delete this.propEventSubscriptions[e]);const n=t["on"+e];n&&(this.propEventSubscriptions[e]=this.on(e,n))}this.prevMotionValues=function(t,e,s){for(const n in e){const i=e[n],r=s[n];if(Li(i))t.addValue(n,i);else if(Li(r))t.addValue(n,ko(i,{owner:t}));else if(r!==i)if(t.hasValue(n)){const e=t.getValue(n);!0===e.liveStyle?e.jump(i):e.hasAnimated||e.set(i)}else{const e=t.getStaticValue(n);t.addValue(n,ko(void 0!==e?e:i,{owner:t}))}}for(const n in s)void 0===e[n]&&t.removeValue(n);return e}(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const e=this.getClosestVariantNode();if(e)return e.variantChildren&&e.variantChildren.add(t),()=>e.variantChildren.delete(t)}addValue(t,e){const s=this.values.get(t);e!==s&&(s&&this.removeValue(t),this.bindToMotionValue(t,e),this.values.set(t,e),this.latestValues[t]=e.get())}removeValue(t){this.values.delete(t);const e=this.valueSubscriptions.get(t);e&&(e(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,e){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return void 0===s&&void 0!==e&&(s=ko(null===e?void 0:e,{owner:this}),this.addValue(t,s)),s}readValue(t,e){var s;let n=void 0===this.latestValues[t]&&this.current?null!==(s=this.getBaseTargetFromProps(this.props,t))&&void 0!==s?s:this.readValueFromInstance(this.current,t,this.options):this.latestValues[t];var i;return null!=n&&("string"==typeof n&&(Ta(n)||Mo(n))?n=parseFloat(n):(i=n,!bu.find(Ea(i))&&na.test(e)&&(n=ha(t,e))),this.setBaseTarget(t,Li(n)?n.get():n)),Li(n)?n.get():n}setBaseTarget(t,e){this.baseTarget[t]=e}getBaseTarget(t){var e;const{initial:s}=this.props;let n;if("string"==typeof s||"object"==typeof s){const i=Ii(this.props,s,null===(e=this.presenceContext)||void 0===e?void 0:e.custom);i&&(n=i[t])}if(s&&void 0!==n)return n;const i=this.getBaseTargetFromProps(this.props,t);return void 0===i||Li(i)?void 0!==this.initialValues[t]&&void 0===n?void 0:this.baseTarget[t]:i}on(t,e){return this.events[t]||(this.events[t]=new wo),this.events[t].add(e)}notify(t,...e){this.events[t]&&this.events[t].notify(...e)}}class Tu extends xu{constructor(){super(...arguments),this.KeyframeResolver=Ca}sortInstanceNodePosition(t,e){return 2&t.compareDocumentPosition(e)?1:-1}getBaseTargetFromProps(t,e){return t.style?t.style[e]:void 0}removeValueFromRenderState(t,{vars:e,style:s}){delete e[t],delete s[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Li(t)&&(this.childSubscription=t.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}class Su extends Tu{constructor(){super(...arguments),this.type="html",this.renderInstance=wr}readValueFromInstance(t,e){if(Fi.has(e)){const t=ca(e);return t&&t.default||0}{const n=(s=t,window.getComputedStyle(s)),i=(Wi(e)?n.getPropertyValue(e):n[e])||0;return"string"==typeof i?i.trim():i}var s}measureInstanceViewportBox(t,{transformPagePoint:e}){return Wc(t,e)}build(t,e,s){ur(t,e,s.transformTemplate)}scrapeMotionValuesFromProps(t,e,s){return Tr(t,e,s)}}class Pu extends Tu{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Pc}getBaseTargetFromProps(t,e){return t[e]}readValueFromInstance(t,e){if(Fi.has(e)){const t=ca(e);return t&&t.default||0}return e=br.has(e)?e:ki(e),t.getAttribute(e)}scrapeMotionValuesFromProps(t,e,s){return Sr(t,e,s)}build(t,e,s){mr(t,e,this.isSVGTag,s.transformTemplate)}renderInstance(t,e,s,n){_r(t,e,0,n)}mount(t){this.isSVGTag=yr(t.tagName),super.mount(t)}}const Eu=ci($r({...nc,...gu,...au,...vu},(e,s)=>Ri(e)?new Pu(s):new Su(s,{allowProjection:e!==t.Fragment})));export{u as A,c as _,U as a,M as b,z as c,w as d,f as e,An as f,n as g,Eu as h,m as i,F as j,Nn as k,x as m,b as p,B as r,a as s};
